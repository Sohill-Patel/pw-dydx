LavaPack.loadBundle([[10,{"../../../shared/constants/alarms":4960,"../../../shared/constants/app":4962,"../../../shared/constants/preferences":4982,"../../../shared/constants/time":4988,"../../../shared/modules/mv3.utils":5020,"../../../ui/helpers/utils/build-types":5883,"../metamask-controller":136,"@metamask/controller-utils":1245,"@metamask/obs-store":1782,events:3814,loglevel:4328,uuid:4893},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=g(e("events")),s=e("@metamask/obs-store"),o=e("uuid"),i=g(e("loglevel")),a=e("@metamask/controller-utils"),c=e("../metamask-controller"),l=e("../../../shared/constants/time"),u=e("../../../shared/constants/alarms"),d=e("../../../shared/modules/mv3.utils"),h=e("../../../ui/helpers/utils/build-types"),p=e("../../../shared/constants/app"),m=e("../../../shared/constants/preferences");function g(e){return e&&e.__esModule?e:{default:e}}class f extends n.default{constructor(e={}){const{addUnlockListener:t,isUnlocked:r,initState:n,onInactiveTimeout:o,preferencesStore:i,messenger:a,extension:c}=e;super(),this.extension=c,this.onInactiveTimeout=o||(()=>undefined),this.store=new s.ObservableStore({timeoutMinutes:m.DEFAULT_AUTO_LOCK_TIME_LIMIT,connectedStatusPopoverHasBeenShown:!0,defaultHomeActiveTabName:null,browserEnvironment:{},popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[],recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:(new Date).getTime(),outdatedBrowserWarningLastShown:null,nftsDetectionNoticeDismissed:!1,showTestnetMessageInDropdown:!0,showBetaHeader:(0,h.isBeta)(),showPermissionsTour:!0,showNetworkBanner:!0,showAccountBanner:!0,trezorModel:null,currentPopupId:undefined,onboardingDate:null,newPrivacyPolicyToastClickedOrClosed:null,newPrivacyPolicyToastShownDate:null,hadAdvancedGasFeesSetPriorToMigration92_3:!1,...n,qrHardware:{},nftsDropdownState:{},usedNetworks:{"0x1":!0,"0x5":!0,"0x539":!0},surveyLinkLastClickedOrClosed:null,signatureSecurityAlertResponses:{},switchedNetworkDetails:null,switchedNetworkNeverShowMessage:!1,currentExtensionPopupId:0}),this.timer=null,this.isUnlocked=r,this.waitingForUnlock=[],t(this.handleUnlock.bind(this)),i.subscribe((({preferences:e})=>{this.store.getState().timeoutMinutes!==e.autoLockTimeLimit&&this._setInactiveTimeout(e.autoLockTimeLimit)})),a.subscribe("KeyringController:qrKeyringStateChange",(e=>this.store.updateState({qrHardware:e})));const{preferences:l}=i.getState();this._setInactiveTimeout(l.autoLockTimeLimit),this.messagingSystem=a,this._approvalRequestId=null}getUnlockPromise(e){return new Promise((t=>{this.isUnlocked()?t():this.waitForUnlock(t,e)}))}waitForUnlock(e,t){this.waitingForUnlock.push({resolve:e}),this.emit(c.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE),t&&this._requestApproval()}handleUnlock(){if(this.waitingForUnlock.length>0){for(;this.waitingForUnlock.length>0;)this.waitingForUnlock.shift().resolve();this.emit(c.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}this._acceptApproval()}setDefaultHomeActiveTabName(e){this.store.updateState({defaultHomeActiveTabName:e})}setConnectedStatusPopoverHasBeenShown(){this.store.updateState({connectedStatusPopoverHasBeenShown:!0})}setRecoveryPhraseReminderHasBeenShown(){this.store.updateState({recoveryPhraseReminderHasBeenShown:!0})}setSurveyLinkLastClickedOrClosed(e){this.store.updateState({surveyLinkLastClickedOrClosed:e})}setOnboardingDate(){this.store.updateState({onboardingDate:Date.now()})}setNewPrivacyPolicyToastClickedOrClosed(){this.store.updateState({newPrivacyPolicyToastClickedOrClosed:!0})}setNewPrivacyPolicyToastShownDate(e){this.store.updateState({newPrivacyPolicyToastShownDate:e})}setRecoveryPhraseReminderLastShown(e){this.store.updateState({recoveryPhraseReminderLastShown:e})}setTermsOfUseLastAgreed(e){this.store.updateState({termsOfUseLastAgreed:e})}setSnapsInstallPrivacyWarningShownStatus(e){this.store.updateState({snapsInstallPrivacyWarningShown:e})}setOutdatedBrowserWarningLastShown(e){this.store.updateState({outdatedBrowserWarningLastShown:e})}setLastActiveTime(){this._resetTimer()}_setInactiveTimeout(e){this.store.updateState({timeoutMinutes:e}),this._resetTimer()}_resetTimer(){const{timeoutMinutes:e}=this.store.getState();if(this.timer?clearTimeout(this.timer):d.isManifestV3&&this.extension.alarms.clear(u.AUTO_LOCK_TIMEOUT_ALARM),!e)return;const t=Number(e);d.isManifestV3?(this.extension.alarms.create(u.AUTO_LOCK_TIMEOUT_ALARM,{delayInMinutes:t,periodInMinutes:t}),this.extension.alarms.onAlarm.addListener((e=>{e.name===u.AUTO_LOCK_TIMEOUT_ALARM&&(this.onInactiveTimeout(),this.extension.alarms.clear(u.AUTO_LOCK_TIMEOUT_ALARM))}))):this.timer=setTimeout((()=>this.onInactiveTimeout()),t*l.MINUTE)}setBrowserEnvironment(e,t){this.store.updateState({browserEnvironment:{os:e,browser:t}})}addPollingToken(e,t){if(t!==p.POLLING_TOKEN_ENVIRONMENT_TYPES[p.ENVIRONMENT_TYPE_BACKGROUND]){const r=this.store.getState()[t];this.store.updateState({[t]:[...r,e]})}}removePollingToken(e,t){if(t!==p.POLLING_TOKEN_ENVIRONMENT_TYPES[p.ENVIRONMENT_TYPE_BACKGROUND]){const r=this.store.getState()[t];this.store.updateState({[t]:r.filter((t=>t!==e))})}}clearPollingTokens(){this.store.updateState({popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[]})}setShowTestnetMessageInDropdown(e){this.store.updateState({showTestnetMessageInDropdown:e})}setShowBetaHeader(e){this.store.updateState({showBetaHeader:e})}setShowPermissionsTour(e){this.store.updateState({showPermissionsTour:e})}setShowNetworkBanner(e){this.store.updateState({showNetworkBanner:e})}setShowAccountBanner(e){this.store.updateState({showAccountBanner:e})}setCurrentExtensionPopupId(e){this.store.updateState({currentExtensionPopupId:e})}setSwitchedNetworkDetails(e){this.store.updateState({switchedNetworkDetails:e})}clearSwitchedNetworkDetails(){this.store.updateState({switchedNetworkDetails:null})}setSwitchedNetworkNeverShowMessage(e){this.store.updateState({switchedNetworkDetails:null,switchedNetworkNeverShowMessage:e})}setTrezorModel(e){this.store.updateState({trezorModel:e})}updateNftDropDownState(e){this.store.updateState({nftsDropdownState:e})}setFirstTimeUsedNetwork(e){const t=this.store.getState(),{usedNetworks:r}=t;r[e]=!0,this.store.updateState({usedNetworks:r})}getSignatureSecurityAlertResponse(e){return this.store.getState().signatureSecurityAlertResponses[e]}addSignatureSecurityAlertResponse(e){const t=this.store.getState(),{signatureSecurityAlertResponses:r}=t;this.store.updateState({signatureSecurityAlertResponses:{...r,[e.securityAlertId]:e}})}setCurrentPopupId(e){this.store.updateState({currentPopupId:e})}getCurrentPopupId(){return this.store.getState().currentPopupId}_requestApproval(){this._approvalRequestId||(this._approvalRequestId=(0,o.v4)(),this.messagingSystem.call("ApprovalController:addRequest",{id:this._approvalRequestId,origin:p.ORIGIN_METAMASK,type:a.ApprovalType.Unlock},!0).catch((()=>{this._approvalRequestId=null})))}_acceptApproval(){if(this._approvalRequestId){try{this.messagingSystem.call("ApprovalController:acceptRequest",this._approvalRequestId)}catch(e){i.default.error("Failed to unlock approval request",e)}this._approvalRequestId=null}}}r.default=f}}},{package:"$root$",file:"app/scripts/controllers/app-state.js"}],[100,{"../../../../shared/constants/network":4977,"eth-rpc-errors":3745},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createUnsupportedMethodMiddleware=function(){return async function(e,t,r,o){return s.UNSUPPORTED_RPC_METHODS.has(e.method)?o(n.ethErrors.rpc.methodNotSupported()):r()}};var n=e("eth-rpc-errors"),s=e("../../../../shared/constants/network")}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/createUnsupportedMethodMiddleware.ts"}],[101,{"../../../../../shared/constants/app":4962,"./ethereum-chain-utils":103,"@metamask/controller-utils":1245,"eth-rpc-errors":3745},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("@metamask/controller-utils"),o=e("../../../../../shared/constants/app"),i=e("./ethereum-chain-utils");const a={methodNames:[o.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN],implementation:async function(e,t,r,o,{upsertNetworkConfiguration:a,getCurrentRpcUrl:c,findNetworkConfigurationBy:l,setActiveNetwork:u,requestUserApproval:d,startApprovalFlow:h,endApprovalFlow:p,getCurrentChainIdForDomain:m,getCaveat:g,requestPermittedChainsPermission:f,getChainPermissionsFeatureFlag:y}){let w;try{w=(0,i.validateAddEthereumChainParams)(e.params[0],o)}catch(e){return o(e)}const{chainId:C,chainName:k,firstValidBlockExplorerUrl:v,firstValidRPCUrl:b,ticker:S}=w,{origin:T}=e,_=m(T),E=(0,i.findExistingNetwork)(_,l),A=(0,i.findExistingNetwork)(C,l);if(A&&A.chainId===C&&A.ticker!==S)return o(n.ethErrors.rpc.invalidParams({message:`nativeCurrency.symbol does not match currency symbol for a network the user already has added with the same chainId. Received:\n${S}`}));let M,P,I;if(A&&A.rpcUrl===b){M=A.id??A.type;const e=c();if(_===C&&e===b)return t.result=null,o();P={toNetworkConfiguration:A,fromNetworkConfiguration:E}}else{({id:I}=await h());try{await d({origin:T,type:s.ApprovalType.AddEthereumChain,requestData:{chainId:C,rpcPrefs:{blockExplorerUrl:v},chainName:k,rpcUrl:b,ticker:S}}),M=await a({chainId:C,rpcPrefs:{blockExplorerUrl:v},nickname:k,rpcUrl:b,ticker:S},{source:"dapp",referrer:T})}catch(e){return p({id:I}),o(e)}P={toNetworkConfiguration:{rpcUrl:b,chainId:C,nickname:k,ticker:S,networkClientId:M},fromNetworkConfiguration:E}}return(0,i.switchChain)(t,o,T,C,P,M,I,{getChainPermissionsFeatureFlag:y,setActiveNetwork:u,requestUserApproval:d,getCaveat:g,requestPermittedChainsPermission:f,endApprovalFlow:p})},hookNames:{upsertNetworkConfiguration:!0,getCurrentRpcUrl:!0,findNetworkConfigurationBy:!0,setActiveNetwork:!0,requestUserApproval:!0,startApprovalFlow:!0,endApprovalFlow:!0,getCurrentChainIdForDomain:!0,getCaveat:!0,requestPermittedChainsPermission:!0,getChainPermissionsFeatureFlag:!0}};r.default=a}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/add-ethereum-chain.js"}],[102,{"../../../../../shared/constants/app":4962},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.ETH_ACCOUNTS],implementation:async function(e,t,r,n,{getAccounts:s}){return t.result=await s(),n()},hookNames:{getAccounts:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/eth-accounts.js"}],[103,{"../../../../../shared/constants/app":4962,"../../../../../shared/constants/network":4977,"../../../../../shared/constants/permissions":4981,"../../../../../shared/modules/network.utils":5021,"../../../controllers/permissions":32,"../../util":135,"@metamask/controller-utils":1245,"eth-rpc-errors":3745},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.findExistingNetwork=function(e,t){if(Object.values(o.BUILT_IN_INFURA_NETWORKS).map((({chainId:e})=>e)).includes(e))return{chainId:e,ticker:o.CURRENCY_SYMBOLS.ETH,nickname:o.NETWORK_TO_NAME_MAP[e],rpcUrl:o.CHAIN_ID_TO_RPC_URL_MAP[e],type:o.CHAIN_ID_TO_TYPE_MAP[e]};return t({chainId:e})},r.switchChain=async function(e,t,r,o,i,c,u,{getChainPermissionsFeatureFlag:d,setActiveNetwork:h,endApprovalFlow:p,requestUserApproval:m,getCaveat:g,requestPermittedChainsPermission:f}){try{if(d()){const{value:e}=g({target:l.PermissionNames.permittedChains,caveatType:a.CaveatTypes.restrictNetworkSwitching})??{};e!==undefined&&e.includes(o)||await f([...e??[],o])}else await m({origin:r,type:s.ApprovalType.SwitchEthereumChain,requestData:i});await h(c),e.result=null}catch(r){return r.code===n.errorCodes.provider.userRejectedRequest&&u?(e.result=null,t()):t(r)}finally{u&&p({id:u})}return t()},r.validateAddEthereumChainParams=function(e,t){if(!e||"object"!=typeof e)throw n.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e)}`});const{chainId:r,chainName:s,blockExplorerUrls:o,nativeCurrency:i,rpcUrls:a,...l}=e,h=Object.keys(l).filter((e=>!["iconUrls"].includes(e)));if(h.length>0)throw n.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${h}`});const p=d(r);if(!a||!Array.isArray(a)||0===a.length)throw n.ethErrors.rpc.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:\n${a}`});const m=e=>{const t=(0,u.getValidUrl)(e);return null!==t&&("localhost"===t.hostname||"127.0.0.1"===t.hostname||"https:"===t.protocol)},g=a.find((e=>m(e))),f=Array.isArray(o)?o.find((e=>m(e))):null;if(!g)throw n.ethErrors.rpc.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:\n${a}`});if("string"!=typeof s||!s)throw n.ethErrors.rpc.invalidParams({message:`Expected non-empty string 'chainName'. Received:\n${s}`});const y=s.length>100?s.substring(0,100):s;if(null!==i){if("object"!=typeof i||Array.isArray(i))throw n.ethErrors.rpc.invalidParams({message:`Expected null or object 'nativeCurrency'. Received:\n${i}`});if(18!==i.decimals)throw n.ethErrors.rpc.invalidParams({message:`Expected the number 18 for 'nativeCurrency.decimals' when 'nativeCurrency' is provided. Received: ${i.decimals}`});if(!i.symbol||"string"!=typeof i.symbol)throw n.ethErrors.rpc.invalidParams({message:`Expected a string 'nativeCurrency.symbol'. Received: ${i.symbol}`})}const w=(null==i?void 0:i.symbol)||c.UNKNOWN_TICKER_SYMBOL;if(w!==c.UNKNOWN_TICKER_SYMBOL&&("string"!=typeof w||w.length<1||w.length>6))throw n.ethErrors.rpc.invalidParams({message:`Expected 1-6 character string 'nativeCurrency.symbol'. Received:\n${w}`});return{chainId:p,chainName:y,firstValidBlockExplorerUrl:f,firstValidRPCUrl:g,ticker:w}},r.validateChainId=d,r.validateSwitchEthereumChainParams=function(e,t){var r;if(null===(r=e.params)||void 0===r||!r[0]||"object"!=typeof e.params[0])throw n.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`});const{chainId:s,...o}=e.params[0];if(Object.keys(o).length>0)throw n.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${Object.keys(o)}`});return d(s)};var n=e("eth-rpc-errors"),s=e("@metamask/controller-utils"),o=e("../../../../../shared/constants/network"),i=e("../../../../../shared/modules/network.utils"),a=e("../../../../../shared/constants/permissions"),c=e("../../../../../shared/constants/app"),l=e("../../../controllers/permissions"),u=e("../../util");function d(e){const t="string"==typeof e&&e.toLowerCase();if(!(0,i.isPrefixedFormattedHexString)(t))throw n.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${e}`});if(!(0,i.isSafeChainId)(parseInt(t,16)))throw n.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${t}": numerical value greater than max safe value. Received:\n${e}`});return t}}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/ethereum-chain-utils.js"}],[104,{"../../../../../shared/constants/app":4962},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.GET_PROVIDER_STATE],implementation:async function(e,t,r,n,{getProviderState:s}){return t.result={...await s(e.origin)},n()},hookNames:{getProviderState:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/get-provider-state.js"}],[105,{"./add-ethereum-chain":101,"./eth-accounts":102,"./get-provider-state":104,"./log-web3-shim-usage":106,"./request-accounts":107,"./send-metadata":108,"./switch-ethereum-chain":109,"./watch-asset":110},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.legacyHandlers=r.handlers=void 0;var n=d(e("./add-ethereum-chain")),s=d(e("./eth-accounts")),o=d(e("./get-provider-state")),i=d(e("./log-web3-shim-usage")),a=d(e("./request-accounts")),c=d(e("./send-metadata")),l=d(e("./switch-ethereum-chain")),u=d(e("./watch-asset"));function d(e){return e&&e.__esModule?e:{default:e}}r.handlers=[n.default,o.default,i.default,a.default,c.default,l.default,u.default],r.legacyHandlers=[s.default]}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/index.ts"}],[106,{"../../../../../shared/constants/app":4962},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.LOG_WEB3_SHIM_USAGE],implementation:function(e,t,r,n,{getWeb3ShimUsageState:s,setWeb3ShimUsageRecorded:o}){const{origin:i}=e;s(i)===undefined&&o(i);return t.result=!0,n()},hookNames:{getWeb3ShimUsageState:!0,setWeb3ShimUsageRecorded:!0}};r.default=n}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/log-web3-shim-usage.js"}],[107,{"../../../../../shared/constants/app":4962,"../../../../../shared/constants/metametrics":4973,"../../util":135,"eth-rpc-errors":3745},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("../../../../../shared/constants/app"),o=e("../../../../../shared/constants/metametrics"),i=e("../../util");const a={methodNames:[s.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS],implementation:async function(e,t,r,a,{origin:l,getAccounts:u,getUnlockPromise:d,hasPermission:h,requestAccountsPermission:p,sendMetrics:m,getPermissionsForOrigin:g,metamaskState:f}){if(c.has(l))return t.error=n.ethErrors.rpc.resourceUnavailable(`Already processing ${s.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS}. Please wait.`),a();if(h(s.MESSAGE_TYPE.ETH_ACCOUNTS)){try{c.add(l),await d(!0),t.result=await u(),a()}catch(e){a(e)}finally{c.delete(l)}return undefined}try{await p()}catch(e){return t.error=e,a()}const y=await u();if(y.length>0){t.result=y;const e=g(l).eth_accounts.caveats[0].value.length,r=!Object.keys(f.permissionHistory).includes(l);(0,i.shouldEmitDappViewedEvent)(f.metaMetricsId)&&m({event:o.MetaMetricsEventName.DappViewed,category:o.MetaMetricsEventCategory.InpageProvider,referrer:{url:l},properties:{is_first_visit:r,number_of_accounts:Object.keys(f.accounts).length,number_of_accounts_connected:e}})}else t.error=n.ethErrors.rpc.internal("Accounts unexpectedly unavailable. Please report this bug.");return a()},hookNames:{origin:!0,getAccounts:!0,getUnlockPromise:!0,hasPermission:!0,requestAccountsPermission:!0,sendMetrics:!0,getPermissionsForOrigin:!0,metamaskState:!0}};r.default=a;const c=new Set}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/request-accounts.js"}],[108,{"../../../../../shared/constants/app":4962,"eth-rpc-errors":3745},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors");const s={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.SEND_METADATA],implementation:function(e,t,r,s,{addSubjectMetadata:o,subjectType:i}){const{origin:a,params:c}=e;if(!c||"object"!=typeof c||Array.isArray(c))return s(n.ethErrors.rpc.invalidParams({data:c}));{const{icon:e=null,name:t=null,...r}=c;o({...r,iconUrl:e,name:t,subjectType:i,origin:a})}return t.result=!0,s()},hookNames:{addSubjectMetadata:!0,subjectType:!0}};r.default=s}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/send-metadata.js"}],[109,{"../../../../../shared/constants/app":4962,"./ethereum-chain-utils":103,"eth-rpc-errors":3745},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),s=e("../../../../../shared/constants/app"),o=e("./ethereum-chain-utils");const i={methodNames:[s.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN],implementation:async function(e,t,r,i,{findNetworkConfigurationBy:a,setActiveNetwork:c,requestPermittedChainsPermission:l,getCaveat:u,getCurrentChainIdForDomain:d,requestUserApproval:h,getChainPermissionsFeatureFlag:p}){let m;try{m=(0,o.validateSwitchEthereumChainParams)(e,i)}catch(e){return i(e)}const{origin:g}=e,f=d(g);if(f===m)return t.result=null,i();const y=(0,o.findExistingNetwork)(m,a),w=(null==y?void 0:y.id)??(null==y?void 0:y.type);if(!w)return i(n.ethErrors.provider.custom({code:4902,message:`Unrecognized chain ID "${m}". Try adding the chain using ${s.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN} first.`}));const C={toNetworkConfiguration:y,fromNetworkConfiguration:(0,o.findExistingNetwork)(f,a)};return(0,o.switchChain)(t,i,g,m,C,w,null,{getChainPermissionsFeatureFlag:p,setActiveNetwork:c,requestUserApproval:h,getCaveat:u,requestPermittedChainsPermission:l})},hookNames:{findNetworkConfigurationBy:!0,setActiveNetwork:!0,getCaveat:!0,requestPermittedChainsPermission:!0,getCurrentChainIdForDomain:!0,requestUserApproval:!0,getChainPermissionsFeatureFlag:!0}};r.default=i}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/switch-ethereum-chain.js"}],[11,{"@metamask/snaps-utils":2616},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createSnapPublicKeyRequest=function(){return{snapId:s,origin:"",handler:n.HandlerType.OnRpcRequest,request:{method:"getPublicKey"}}},r.createSnapSignMessageRequest=function(e){return{snapId:s,origin:"",handler:n.HandlerType.OnRpcRequest,request:{method:"signMessage",params:{message:e}}}};var n=e("@metamask/snaps-utils");const s="npm:@metamask/message-signing-snap"}}},{package:"$root$",file:"app/scripts/controllers/authentication/auth-snap-requests.ts"}],[110,{"../../../../../shared/constants/app":4962,"@metamask/controller-utils":1245,"eth-rpc-errors":3745},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/controller-utils"),s=e("eth-rpc-errors"),o=e("../../../../../shared/constants/app");const i={methodNames:[o.MESSAGE_TYPE.WATCH_ASSET,o.MESSAGE_TYPE.WATCH_ASSET_LEGACY],implementation:async function(e,t,r,o,{handleWatchAssetRequest:i}){try{const{params:{options:r,type:a},origin:c,networkClientId:l}=e,{tokenId:u}=r;return[n.ERC721,n.ERC1155].includes(a)&&u!==undefined&&"string"!=typeof u?o(s.ethErrors.rpc.invalidParams({message:`Expected parameter 'tokenId' to be type 'string'. Received type '${typeof u}'`})):(await i({asset:r,type:a,origin:c,networkClientId:l}),t.result=!0,o())}catch(e){return o(e)}},hookNames:{handleWatchAssetRequest:!0}};r.default=i}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/handlers/watch-asset.js"}],[111,{"./createMethodMiddleware":99,"./createUnsupportedMethodMiddleware":100},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./createMethodMiddleware");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}}))}));var s=e("./createUnsupportedMethodMiddleware");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===s[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return s[e]}}))}))}}},{package:"$root$",file:"app/scripts/lib/rpc-method-middleware/index.js"}],[112,{"../util":135,"@segment/loosely-validate-event":2815,buffer:3520,"is-retry-allowed":4145,lodash:4322,"remove-trailing-slash":4743,timers:4835},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t,n){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=l(e("remove-trailing-slash")),o=l(e("@segment/loosely-validate-event")),i=e("lodash"),a=l(e("is-retry-allowed")),c=e("../util");function l(e){return e&&e.__esModule?e:{default:e}}const u=()=>({});r.default=class{constructor(e,t={}){this.writeKey=e,this.host=(0,s.default)(t.host||"https://api.segment.io"),this.flushInterval=t.flushInterval||1e4,this.flushAt=t.flushAt||Math.max(t.flushAt,1)||20,this.queue=[],this.path="/v1/batch",this.maxQueueSize=460800,this.flushed=!1,this.retryCount=3,Object.defineProperty(this,"enable",{configurable:!1,writable:!1,enumerable:!0,value:!0})}_validate(e,t){(0,o.default)(e,t)}_message(e,t,r){return this._validate(t,e),this.enqueue(e,t,r),this}identify(e,t){return this._message("identify",e,t)}track(e,t){return this._message("track",e,t)}page(e,t){return this._message("page",e,t)}enqueue(e,t,r=u){if(!this.enable)return void n(r);const s={...t,type:e};if(s.context={...s.context,library:{name:"analytics-node"}},s.timestamp||(s.timestamp=new Date),s.messageId||(s.messageId=(0,c.generateRandomId)()),s.anonymousId&&!(0,i.isString)(s.anonymousId)&&(s.anonymousId=JSON.stringify(s.anonymousId)),s.userId&&!(0,i.isString)(s.userId)&&(s.userId=JSON.stringify(s.userId)),this.queue.push({message:s,callback:r}),!this.flushed)return this.flushed=!0,void this.flush();const o=this.queue.length>=this.flushAt,a=this.queue.reduce(((e,t)=>e+JSON.stringify(t).length),0)>=this.maxQueueSize;(o||a)&&this.flush(),this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))}flush(e=u){if(!this.enable)return n(e),Promise.resolve();if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.queue.length)return n(e),Promise.resolve();const r=this.queue.splice(0,this.flushAt),s=r.map((e=>e.callback)),o={batch:r.map((e=>e.message)),timestamp:new Date,sentAt:new Date},i={Authorization:`Basic ${t.from(this.writeKey,"utf8").toString("base64")}`};return this._sendRequest(`${this.host}${this.path}`,{method:"POST",body:JSON.stringify(o),headers:i},(t=>{n((()=>{s.forEach((e=>e(t,o))),e(t,o)}))}),0)}_retryRequest(e,t,r,n){const s=100*Math.pow(2,n);setTimeout((()=>{this._sendRequest(e,t,r,n+1)}),s)}async _sendRequest(e,t,r,n){return fetch(e,t).then((async s=>{if(s.ok)r();else if(this._isErrorRetryable({response:s})&&n<=this.retryCount)this._retryRequest(e,t,r,n);else{const e=new Error(s.statusText);r(e)}})).catch((s=>{this._isErrorRetryable(s)&&n<=this.retryCount?this._retryRequest(e,t,r,n):r(s)}))}_isErrorRetryable(e){return!!function(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,a.default)(e)}(e)||!!e.response&&(e.response.status>=500&&e.response.status<=599||429===e.response.status)}}}).call(this)}).call(this,e("buffer").Buffer,e("timers").setImmediate)}}},{package:"$root$",file:"app/scripts/lib/segment/analytics.js"}],[1121,{"./chunk-BYPP7G2N.js":1122,"./chunk-UJIPPGP6.js":1123,"@metamask/base-controller":1130,"@metamask/eth-snap-keyring":1397,"@metamask/keyring-api":1566,"@metamask/keyring-controller":1619,"@metamask/utils":1141},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,o,i,a,c,l,u,d,h,p,m,g,f,y,w,C,k,v,b,S,T,_,E,A,M,P,I,R=e("./chunk-BYPP7G2N.js"),N=e("./chunk-UJIPPGP6.js"),j=e("@metamask/base-controller"),x=e("@metamask/eth-snap-keyring"),O=e("@metamask/keyring-api"),B=e("@metamask/keyring-controller"),U=e("@metamask/utils"),F="AccountsController",D={internalAccounts:{persist:!0,anonymous:!1}},L={internalAccounts:{accounts:{},selectedAccount:""}},H={id:"",address:"",options:{},methods:[],type:O.EthAccountType.Eoa,metadata:{name:"",keyring:{type:""},importTime:0}},$=class extends j.BaseController{constructor({messenger:e,state:t}){super({messenger:e,name:F,metadata:D,state:{...L,...t}}),N.__privateAdd.call(void 0,this,n),N.__privateAdd.call(void 0,this,o),N.__privateAdd.call(void 0,this,a),N.__privateAdd.call(void 0,this,l),N.__privateAdd.call(void 0,this,d),N.__privateAdd.call(void 0,this,p),N.__privateAdd.call(void 0,this,g),N.__privateAdd.call(void 0,this,y),N.__privateAdd.call(void 0,this,C),N.__privateAdd.call(void 0,this,v),N.__privateAdd.call(void 0,this,S),N.__privateAdd.call(void 0,this,_),N.__privateAdd.call(void 0,this,A),N.__privateAdd.call(void 0,this,P),this.messagingSystem.subscribe("SnapController:stateChange",(e=>N.__privateMethod.call(void 0,this,d,h).call(this,e))),this.messagingSystem.subscribe("KeyringController:stateChange",(e=>N.__privateMethod.call(void 0,this,l,u).call(this,e))),N.__privateMethod.call(void 0,this,P,I).call(this)}getAccount(e){return this.state.internalAccounts.accounts[e]}listAccounts(){return Object.values(this.state.internalAccounts.accounts).filter((e=>O.isEvmAccountType.call(void 0,e.type)))}listMultichainAccounts(e){const t=Object.values(this.state.internalAccounts.accounts);if(!e)return t;if(!U.isCaipChainId.call(void 0,e))throw new Error(`Invalid CAIP-2 chain ID: ${String(e)}`);return t.filter((t=>N.__privateMethod.call(void 0,this,y,w).call(this,t,e)))}getAccountExpect(e){const t=this.getAccount(e);if(void 0===t)throw new Error(`Account Id "${e}" not found`);return t}getSelectedAccount(){if(""===this.state.internalAccounts.selectedAccount)return H;const e=this.getAccountExpect(this.state.internalAccounts.selectedAccount);if(O.isEvmAccountType.call(void 0,e.type))return e;const t=this.listAccounts();if(!t.length)throw new Error("No EVM accounts");return N.__privateMethod.call(void 0,this,g,f).call(this,t)}getSelectedMultichainAccount(e){if(""===this.state.internalAccounts.selectedAccount)return H;if(!e)return this.getAccountExpect(this.state.internalAccounts.selectedAccount);if(!U.isCaipChainId.call(void 0,e))throw new Error(`Invalid CAIP-2 chain ID: ${e}`);const t=Object.values(this.state.internalAccounts.accounts).filter((t=>N.__privateMethod.call(void 0,this,y,w).call(this,t,e)));return N.__privateMethod.call(void 0,this,g,f).call(this,t)}getAccountByAddress(e){return this.listMultichainAccounts().find((t=>t.address.toLowerCase()===e.toLowerCase()))}setSelectedAccount(e){const t=this.getAccountExpect(e);this.update((e=>{e.internalAccounts.accounts[t.id].metadata.lastSelected=Date.now(),e.internalAccounts.selectedAccount=t.id})),N.__privateMethod.call(void 0,this,S,T).call(this,t)}setAccountName(e,t){if(this.listMultichainAccounts().find((r=>r.metadata.name===t&&r.id!==e)))throw new Error("Account name already exists");this.updateAccountMetadata(e,{name:t})}updateAccountMetadata(e,t){const r=this.getAccountExpect(e);this.update((n=>{const s={...r,metadata:{...r.metadata,...t}};n.internalAccounts.accounts[e]=s}))}async updateAccounts(){const e=await N.__privateMethod.call(void 0,this,o,i).call(this),t=await N.__privateMethod.call(void 0,this,a,c).call(this),r=new Map,n=this.state.internalAccounts.accounts,s=[...t,...e].reduce(((e,t)=>{const s=R.keyringTypeToName.call(void 0,t.metadata.keyring.type),o=r.get(s)??0;o?r.set(s,o+1):r.set(s,1);const i=n[t.id];return e[t.id]={...t,metadata:{...t.metadata,name:N.__privateMethod.call(void 0,this,A,M).call(this,i?.id,"name")??`${s} ${o+1}`,importTime:N.__privateMethod.call(void 0,this,A,M).call(this,i?.id,"importTime")??Date.now(),lastSelected:N.__privateMethod.call(void 0,this,A,M).call(this,i?.id,"lastSelected")??0}},e}),{});this.update((e=>{if(e.internalAccounts.accounts=s,!e.internalAccounts.accounts[e.internalAccounts.selectedAccount]){const t=N.__privateMethod.call(void 0,this,g,f).call(this,Object.values(s));t?(e.internalAccounts.selectedAccount=t.id,e.internalAccounts.accounts[t.id].metadata.lastSelected=N.__privateMethod.call(void 0,this,C,k).call(this),N.__privateMethod.call(void 0,this,S,T).call(this,t)):e.internalAccounts.selectedAccount=""}}))}loadBackup(e){e.internalAccounts&&this.update((t=>{t.internalAccounts=e.internalAccounts}))}getNextAvailableAccountName(e=B.KeyringTypes.hd,t){const r=R.keyringTypeToName.call(void 0,e),n=N.__privateMethod.call(void 0,this,p,m).call(this,e,t),s=n.reduce(((e,t)=>{const n=new RegExp(`${r} ([0-9]+)$`,"u").exec(t.metadata.name);if(n){const t=parseInt(n[1],10);return Math.max(e,t)}return e}),0),o=Math.max(n.length+1,s+1);return`${r} ${o}`}};n=new WeakSet,s=function(e,t){return{id:R.getUUIDFromAddressOfNormalAccount.call(void 0,e),address:e,options:{},methods:[O.EthMethod.PersonalSign,O.EthMethod.Sign,O.EthMethod.SignTransaction,O.EthMethod.SignTypedDataV1,O.EthMethod.SignTypedDataV3,O.EthMethod.SignTypedDataV4],type:O.EthAccountType.Eoa,metadata:{name:"",importTime:Date.now(),keyring:{type:t}}}},o=new WeakSet,i=async function(){const[e]=this.messagingSystem.call("KeyringController:getKeyringsByType",x.SnapKeyring.type);if(!e)return[];return e.listAccounts()},a=new WeakSet,c=async function(){const e=await this.messagingSystem.call("KeyringController:getAccounts"),t=[];for(const r of e){const e=await this.messagingSystem.call("KeyringController:getKeyringForAccount",r),n=e.type;if(!R.isNormalKeyringType.call(void 0,n))continue;const s=R.getUUIDFromAddressOfNormalAccount.call(void 0,r);t.push({id:s,address:r,options:{},methods:[O.EthMethod.PersonalSign,O.EthMethod.Sign,O.EthMethod.SignTransaction,O.EthMethod.SignTypedDataV1,O.EthMethod.SignTypedDataV3,O.EthMethod.SignTypedDataV4],type:O.EthAccountType.Eoa,metadata:{name:N.__privateMethod.call(void 0,this,A,M).call(this,s,"name")??"",importTime:N.__privateMethod.call(void 0,this,A,M).call(this,s,"importTime")??Date.now(),lastSelected:N.__privateMethod.call(void 0,this,A,M).call(this,s,"lastSelected")??0,keyring:{type:e.type}}})}return t},l=new WeakSet,u=function(e){if(e.isUnlocked&&e.keyrings.length>0){const t=[],r=[];for(const n of e.keyrings)n.type===B.KeyringTypes.snap?r.push(...n.accounts.map((e=>({address:e,type:n.type})))):t.push(...n.accounts.map((e=>({address:e,type:n.type}))));const{previousNormalInternalAccounts:n,previousSnapInternalAccounts:s}=this.listMultichainAccounts().reduce(((e,t)=>(t.metadata.keyring.type===B.KeyringTypes.snap?e.previousSnapInternalAccounts.push(t):e.previousNormalInternalAccounts.push(t),e)),{previousNormalInternalAccounts:[],previousSnapInternalAccounts:[]}),o=[],i=[];for(const e of t)this.state.internalAccounts.accounts[R.getUUIDFromAddressOfNormalAccount.call(void 0,e.address)]||o.push(e);for(const e of r)s.find((t=>t.address.toLowerCase()===e.address.toLowerCase()))||o.push(e);for(const e of n)t.find((({address:t})=>t.toLowerCase()===e.address.toLowerCase()))||i.push(e);for(const e of s)r.find((({address:t})=>t.toLowerCase()===e.address.toLowerCase()))||i.push(e);this.update((e=>{if(i.length>0)for(const t of i)e.internalAccounts.accounts=N.__privateMethod.call(void 0,this,_,E).call(this,e.internalAccounts.accounts,t.id);if(o.length>0)for(const t of o)e.internalAccounts.accounts=N.__privateMethod.call(void 0,this,v,b).call(this,e.internalAccounts.accounts,t);const t=Object.values(e.internalAccounts.accounts);if(!e.internalAccounts.accounts[this.state.internalAccounts.selectedAccount]){const r=N.__privateMethod.call(void 0,this,g,f).call(this,t);r?(e.internalAccounts.selectedAccount=r.id,e.internalAccounts.accounts[r.id].metadata.lastSelected=N.__privateMethod.call(void 0,this,C,k).call(this),N.__privateMethod.call(void 0,this,S,T).call(this,r)):e.internalAccounts.selectedAccount=""}}))}},d=new WeakSet,h=function(e){const{snaps:t}=e,r=this.listMultichainAccounts().filter((e=>e.metadata.snap));this.update((e=>{r.forEach((r=>{const n=e.internalAccounts.accounts[r.id];if(n.metadata.snap){const e=n.metadata.snap.id,r=t[e];r&&(n.metadata.snap.enabled=r.enabled&&!r.blocked)}}))}))},p=new WeakSet,m=function(e,t){return(t??this.listMultichainAccounts()).filter((t=>e===B.KeyringTypes.hd||e===B.KeyringTypes.simple?t.metadata.keyring.type===B.KeyringTypes.hd||t.metadata.keyring.type===B.KeyringTypes.simple:t.metadata.keyring.type===e))},g=new WeakSet,f=function(e){const[t]=e.sort(((e,t)=>(t.metadata.lastSelected??0)-(e.metadata.lastSelected??0)));return t},y=new WeakSet,w=function(e,t){return e.type.startsWith(U.parseCaipChainId.call(void 0,t).namespace)},C=new WeakSet,k=function(){return Date.now()},v=new WeakSet,b=function(e,t){let r;if(t.type!==B.KeyringTypes.snap)r=N.__privateMethod.call(void 0,this,n,s).call(this,t.address,t.type);else{const[n]=this.messagingSystem.call("KeyringController:getKeyringsByType",x.SnapKeyring.type);if(r=n.getAccountByAddress(t.address),!r)return e}const o=0===Object.keys(e).length,i=this.getNextAvailableAccountName(r.metadata.keyring.type,Object.values(e)),a={...r,metadata:{...r.metadata,name:i,importTime:Date.now(),lastSelected:o?N.__privateMethod.call(void 0,this,C,k).call(this):0}};return e[r.id]=a,this.messagingSystem.publish("AccountsController:accountAdded",a),e},S=new WeakSet,T=function(e){O.isEvmAccountType.call(void 0,e.type)&&this.messagingSystem.publish("AccountsController:selectedEvmAccountChange",e),this.messagingSystem.publish("AccountsController:selectedAccountChange",e)},_=new WeakSet,E=function(e,t){return delete e[t],this.messagingSystem.publish("AccountsController:accountRemoved",t),e},A=new WeakSet,M=function(e,t,r){const n=r??this.getAccount(e);return n?n.metadata[t]:void 0},P=new WeakSet,I=function(){this.messagingSystem.registerActionHandler(`${F}:setSelectedAccount`,this.setSelectedAccount.bind(this)),this.messagingSystem.registerActionHandler(`${F}:listAccounts`,this.listAccounts.bind(this)),this.messagingSystem.registerActionHandler(`${F}:listMultichainAccounts`,this.listMultichainAccounts.bind(this)),this.messagingSystem.registerActionHandler(`${F}:setAccountName`,this.setAccountName.bind(this)),this.messagingSystem.registerActionHandler(`${F}:updateAccounts`,this.updateAccounts.bind(this)),this.messagingSystem.registerActionHandler(`${F}:getSelectedAccount`,this.getSelectedAccount.bind(this)),this.messagingSystem.registerActionHandler(`${F}:getSelectedMultichainAccount`,this.getSelectedMultichainAccount.bind(this)),this.messagingSystem.registerActionHandler(`${F}:getAccountByAddress`,this.getAccountByAddress.bind(this)),this.messagingSystem.registerActionHandler(`${F}:getNextAvailableAccountName`,this.getNextAvailableAccountName.bind(this)),this.messagingSystem.registerActionHandler("AccountsController:getAccount",this.getAccount.bind(this)),this.messagingSystem.registerActionHandler("AccountsController:updateAccountMetadata",this.updateAccountMetadata.bind(this))},r.EMPTY_ACCOUNT=H,r.AccountsController=$}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/chunk-5MTWAWAS.js"}],[1122,{"@ethereumjs/util":461,"@metamask/keyring-controller":1619,"ethereum-cryptography/sha256":3766,uuid:4893},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@ethereumjs/util"),s=e("@metamask/keyring-controller"),o=e("ethereum-cryptography/sha256"),i=e("uuid");function a(e){return{random:o.sha256.call(void 0,n.toBuffer.call(void 0,e)).slice(0,16)}}r.keyringTypeToName=function(e){if(s.isCustodyKeyring.call(void 0,e))return"Custody";switch(e){case s.KeyringTypes.simple:case s.KeyringTypes.hd:return"Account";case s.KeyringTypes.trezor:return"Trezor";case s.KeyringTypes.ledger:return"Ledger";case s.KeyringTypes.lattice:return"Lattice";case s.KeyringTypes.qr:return"QR";case s.KeyringTypes.snap:return"Snap Account";default:throw new Error(`Unknown keyring ${e}`)}},r.getUUIDOptionsFromAddressOfNormalAccount=a,r.getUUIDFromAddressOfNormalAccount=function(e){return i.v4.call(void 0,a(e))},r.isNormalKeyringType=function(e){return e!==s.KeyringTypes.snap}}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/chunk-BYPP7G2N.js"}],[1123,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateMethod=(e,t,r)=>(((e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)})(e,t,"access private method"),r)}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/chunk-UJIPPGP6.js"}],[1124,{"./chunk-5MTWAWAS.js":1121,"./chunk-BYPP7G2N.js":1122,"./chunk-UJIPPGP6.js":1123},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-5MTWAWAS.js"),s=e("./chunk-BYPP7G2N.js");e("./chunk-UJIPPGP6.js"),r.AccountsController=n.AccountsController,r.getUUIDFromAddressOfNormalAccount=s.getUUIDFromAddressOfNormalAccount,r.keyringTypeToName=s.keyringTypeToName}}},{package:"@metamask/accounts-controller",file:"node_modules/@metamask/accounts-controller/dist/index.js"}],[1125,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const r=e[t];this.internalConfig[t]=r,this[t]=r}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},s=n;r.BaseControllerV1=n,r.BaseControllerV1_default=s}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/chunk-FTHCJ6HY.js"}],[1126,{"./chunk-UJFCPTF3.js":1128,"./chunk-Z4BLTVTB.js":1129},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,o,i,a=e("./chunk-UJFCPTF3.js"),c=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,o=new WeakMap,i=new WeakMap,r.ControllerMessenger=class{constructor(){c.__privateAdd.call(void 0,this,n,new Map),c.__privateAdd.call(void 0,this,s,new Map),c.__privateAdd.call(void 0,this,o,new Map),c.__privateAdd.call(void 0,this,i,new Map)}registerActionHandler(e,t){if(c.__privateGet.call(void 0,this,n).has(e))throw new Error(`A handler for ${e} has already been registered`);c.__privateGet.call(void 0,this,n).set(e,t)}unregisterActionHandler(e){c.__privateGet.call(void 0,this,n).delete(e)}clearActions(){c.__privateGet.call(void 0,this,n).clear()}call(e,...t){const r=c.__privateGet.call(void 0,this,n).get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){c.__privateGet.call(void 0,this,o).set(e,t)}publish(e,...t){const r=c.__privateGet.call(void 0,this,s).get(e);if(r)for(const[e,n]of r.entries())try{if(n){const r=c.__privateGet.call(void 0,this,i).get(e),s=n(...t);s!==r&&(c.__privateGet.call(void 0,this,i).set(e,s),e(s,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let n=c.__privateGet.call(void 0,this,s).get(e);if(n||(n=new Map,c.__privateGet.call(void 0,this,s).set(e,n)),n.set(t,r),r){const n=c.__privateGet.call(void 0,this,o).get(e);if(n){const e=r(...n());c.__privateGet.call(void 0,this,i).set(t,e)}}}unsubscribe(e,t){const r=c.__privateGet.call(void 0,this,s).get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&c.__privateGet.call(void 0,this,i).delete(t),r.delete(t)}clearEventSubscriptions(e){c.__privateGet.call(void 0,this,s).delete(e)}clearSubscriptions(){c.__privateGet.call(void 0,this,s).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new(0,a.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1127,{"./chunk-Z4BLTVTB.js":1129,immer:4126},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("./chunk-Z4BLTVTB.js"),o=e("immer");o.enablePatches.call(void 0);function i(e,t,r){return Object.keys(e).reduce(((n,s)=>{try{const o=t[s];if(!o)throw new Error(`No metadata found for '${String(s)}'`);const i=o[r],a=e[s];return"function"==typeof i?n[s]=i(a):i&&(n[s]=a),n}catch(e){return setTimeout((()=>{throw e})),n}}),{})}n=new WeakMap,r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:i}){s.__privateAdd.call(void 0,this,n,void 0),this.messagingSystem=e,this.name=r,s.__privateSet.call(void 0,this,n,o.freeze.call(void 0,i,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return s.__privateGet.call(void 0,this,n)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,i]=o.produceWithPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);return s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:i}}applyPatches(e){const t=o.applyPatches.call(void 0,s.__privateGet.call(void 0,this,n),e);s.__privateSet.call(void 0,this,n,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return i(e,t,"anonymous")},r.getPersistentState=function(e,t){return i(e,t,"persist")}}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/chunk-IURK6TKD.js"}],[1128,{"./chunk-Z4BLTVTB.js":1129},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,o,i,a,c,l,u,d,h,p=e("./chunk-Z4BLTVTB.js");n=new WeakMap,s=new WeakMap,o=new WeakMap,i=new WeakMap,a=new WeakSet,c=function(e){const t=p.__privateGet.call(void 0,this,i);return p.__privateMethod.call(void 0,this,d,h).call(this,e)||null!==t&&t.includes(e)},l=new WeakSet,u=function(e){const t=p.__privateGet.call(void 0,this,o);return p.__privateMethod.call(void 0,this,d,h).call(this,e)||null!==t&&t.includes(e)},d=new WeakSet,h=function(e){return e.startsWith(`${p.__privateGet.call(void 0,this,s)}:`)},r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:c}){p.__privateAdd.call(void 0,this,a),p.__privateAdd.call(void 0,this,l),p.__privateAdd.call(void 0,this,d),p.__privateAdd.call(void 0,this,n,void 0),p.__privateAdd.call(void 0,this,s,void 0),p.__privateAdd.call(void 0,this,o,void 0),p.__privateAdd.call(void 0,this,i,void 0),p.__privateSet.call(void 0,this,n,e),p.__privateSet.call(void 0,this,s,t),p.__privateSet.call(void 0,this,o,r),p.__privateSet.call(void 0,this,i,c)}registerActionHandler(e,t){if(!p.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerActionHandler(e,t)}unregisterActionHandler(e){if(!p.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).unregisterActionHandler(e)}call(e,...t){if(!p.__privateMethod.call(void 0,this,l,u).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return p.__privateGet.call(void 0,this,n).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!p.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!p.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).publish(e,...t)}subscribe(e,t,r){if(!p.__privateMethod.call(void 0,this,a,c).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?p.__privateGet.call(void 0,this,n).subscribe(e,t,r):p.__privateGet.call(void 0,this,n).subscribe(e,t)}unsubscribe(e,t){if(!p.__privateMethod.call(void 0,this,a,c).call(this,e))throw new Error(`Event missing from allow list: ${e}`);p.__privateGet.call(void 0,this,n).unsubscribe(e,t)}clearEventSubscriptions(e){if(!p.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${p.__privateGet.call(void 0,this,s)}:'`);p.__privateGet.call(void 0,this,n).clearEventSubscriptions(e)}}}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1129,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,s)=>(n(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(n(e,t,"access private method"),r)}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[113,{"../../../../shared/constants/time":4988,"./analytics":112},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.segment=r.createSegmentMock=void 0;var n,s=e("../../../../shared/constants/time"),o=(n=e("./analytics"))&&n.__esModule?n:{default:n};const i="XdGJ17zKf3NjBPCDQ2UDjJjkx6FYBMGP",a=undefined,c=5*s.SECOND,l=(e=a)=>{const t={queue:[],flush(){t.queue.forEach((([e,t])=>{t()})),t.queue=[]},track(r,n=(()=>undefined)){t.queue.push([r,n]),t.queue.length>=e&&t.flush()},page(){},identify(){}};return t};r.createSegmentMock=l;r.segment=i?new o.default(i,{host:null,flushAt:a,flushInterval:c}):l(a)}}},{package:"$root$",file:"app/scripts/lib/segment/index.js"}],[1130,{"./chunk-FTHCJ6HY.js":1125,"./chunk-G42723LG.js":1126,"./chunk-IURK6TKD.js":1127,"./chunk-UJFCPTF3.js":1128,"./chunk-Z4BLTVTB.js":1129},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-FTHCJ6HY.js"),s=e("./chunk-IURK6TKD.js"),o=e("./chunk-G42723LG.js"),i=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),r.BaseController=s.BaseController,r.BaseControllerV1=n.BaseControllerV1,r.ControllerMessenger=o.ControllerMessenger,r.RestrictedControllerMessenger=i.RestrictedControllerMessenger,r.getAnonymizedState=s.getAnonymizedState,r.getPersistentState=s.getPersistentState}}},{package:"@metamask/accounts-controller>@metamask/base-controller",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1131,{"./errors.cjs":1139,"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.assertExhaustive=r.assertStruct=r.assert=r.AssertionError=void 0;const n=e("@metamask/superstruct"),s=e("./errors.cjs");function o(e,t){return r=e,Boolean("string"==typeof r?.prototype?.constructor?.name)?new e({message:t}):e({message:t});var r}class i extends Error{constructor(e){super(e.message),this.code="ERR_ASSERTION"}}r.AssertionError=i,r.assert=function(e,t="Assertion failed.",r=i){if(!e){if(t instanceof Error)throw t;throw o(r,t)}},r.assertStruct=function(e,t,r="Assertion failed",a=i){try{(0,n.assert)(e,t)}catch(e){throw o(a,`${r}: ${function(e){return(0,s.getErrorMessage)(e).replace(/\.$/u,"")}(e)}.`)}},r.assertExhaustive=function(e){throw new Error("Invalid branch reached. Should be detected during compilation.")}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/assert.cjs"}],[1132,{"./assert.cjs":1131,"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.base64=void 0;const n=e("@metamask/superstruct"),s=e("./assert.cjs");r.base64=(e,t={})=>{const r=t.paddingRequired??!1,o=t.characterSet??"base64";let i,a;return"base64"===o?i=String.raw`[A-Za-z0-9+\/]`:((0,s.assert)("base64url"===o),i=String.raw`[-_A-Za-z0-9]`),a=r?new RegExp(`^(?:${i}{4})*(?:${i}{3}=|${i}{2}==)?$`,"u"):new RegExp(`^(?:${i}{4})*(?:${i}{2,3}|${i}{3}=|${i}{2}==)?$`,"u"),(0,n.pattern)(e,a)}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/base64.cjs"}],[1133,{"./assert.cjs":1131,"./hex.cjs":1140,"@scure/base":2797,buffer:3520},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.createDataView=r.concatBytes=r.valueToBytes=r.base64ToBytes=r.stringToBytes=r.numberToBytes=r.signedBigIntToBytes=r.bigIntToBytes=r.hexToBytes=r.bytesToBase64=r.bytesToString=r.bytesToNumber=r.bytesToSignedBigInt=r.bytesToBigInt=r.bytesToHex=r.assertIsBytes=r.isBytes=void 0;const n=e("@scure/base"),s=e("./assert.cjs"),o=e("./hex.cjs"),i=48,a=58,c=87;const l=function(){const e=[];return()=>{if(0===e.length)for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return e}}();function u(e){return e instanceof Uint8Array}function d(e){(0,s.assert)(u(e),"Value must be a Uint8Array.")}function h(e){if(d(e),0===e.length)return"0x";const t=l(),r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=t[e[n]];return(0,o.add0x)(r.join(""))}function p(e){d(e);const t=h(e);return BigInt(t)}function m(e){if("0x"===e?.toLowerCase?.())return new Uint8Array;(0,o.assertIsHexString)(e);const t=(0,o.remove0x)(e).toLowerCase(),r=t.length%2==0?t:`0${t}`,n=new Uint8Array(r.length/2);for(let e=0;e<n.length;e++){const t=r.charCodeAt(2*e),s=r.charCodeAt(2*e+1),o=t-(t<a?i:c),l=s-(s<a?i:c);n[e]=16*o+l}return n}function g(e){(0,s.assert)("bigint"==typeof e,"Value must be a bigint."),(0,s.assert)(e>=BigInt(0),"Value must be a non-negative bigint.");return m(e.toString(16))}function f(e){(0,s.assert)("number"==typeof e,"Value must be a number."),(0,s.assert)(e>=0,"Value must be a non-negative number."),(0,s.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToBytes` instead.");return m(e.toString(16))}function y(e){return(0,s.assert)("string"==typeof e,"Value must be a string."),(new TextEncoder).encode(e)}function w(e){if("bigint"==typeof e)return g(e);if("number"==typeof e)return f(e);if("string"==typeof e)return e.startsWith("0x")?m(e):y(e);if(u(e))return e;throw new TypeError(`Unsupported value type: "${typeof e}".`)}r.isBytes=u,r.assertIsBytes=d,r.bytesToHex=h,r.bytesToBigInt=p,r.bytesToSignedBigInt=function(e){d(e);let t=BigInt(0);for(const r of e)t=(t<<BigInt(8))+BigInt(r);return BigInt.asIntN(8*e.length,t)},r.bytesToNumber=function(e){d(e);const t=p(e);return(0,s.assert)(t<=BigInt(Number.MAX_SAFE_INTEGER),"Number is not a safe integer. Use `bytesToBigInt` instead."),Number(t)},r.bytesToString=function(e){return d(e),(new TextDecoder).decode(e)},r.bytesToBase64=function(e){return d(e),n.base64.encode(e)},r.hexToBytes=m,r.bigIntToBytes=g,r.signedBigIntToBytes=function(e,t){(0,s.assert)("bigint"==typeof e,"Value must be a bigint."),(0,s.assert)("number"==typeof t,"Byte length must be a number."),(0,s.assert)(t>0,"Byte length must be greater than 0."),(0,s.assert)(function(e,t){(0,s.assert)(t>0);const r=e>>BigInt(31);return!((~e&r)+(e&~r)>>BigInt(8*t-1))}(e,t),"Byte length is too small to represent the given value.");let r=e;const n=new Uint8Array(t);for(let e=0;e<n.length;e++)n[e]=Number(BigInt.asUintN(8,r)),r>>=BigInt(8);return n.reverse()},r.numberToBytes=f,r.stringToBytes=y,r.base64ToBytes=function(e){return(0,s.assert)("string"==typeof e,"Value must be a string."),n.base64.decode(e)},r.valueToBytes=w,r.concatBytes=function(e){const t=new Array(e.length);let r=0;for(let n=0;n<e.length;n++){const s=w(e[n]);t[n]=s,r+=s.length}const n=new Uint8Array(r);for(let e=0,r=0;e<t.length;e++)n.set(t[e],r),r+=t[e].length;return n},r.createDataView=function(e){if(void 0!==t&&e instanceof t){const t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return new DataView(t)}return new DataView(e.buffer,e.byteOffset,e.byteLength)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/bytes.cjs"}],[1134,{"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.toCaipChainId=r.parseCaipAccountId=r.parseCaipChainId=r.isCaipAccountAddress=r.isCaipAccountId=r.isCaipReference=r.isCaipNamespace=r.isCaipChainId=r.KnownCaipNamespace=r.CaipAccountAddressStruct=r.CaipAccountIdStruct=r.CaipReferenceStruct=r.CaipNamespaceStruct=r.CaipChainIdStruct=r.CAIP_ACCOUNT_ADDRESS_REGEX=r.CAIP_ACCOUNT_ID_REGEX=r.CAIP_REFERENCE_REGEX=r.CAIP_NAMESPACE_REGEX=r.CAIP_CHAIN_ID_REGEX=void 0;const n=e("@metamask/superstruct");function s(e){return(0,n.is)(e,r.CaipNamespaceStruct)}function o(e){return(0,n.is)(e,r.CaipReferenceStruct)}r.CAIP_CHAIN_ID_REGEX=/^(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})$/u,r.CAIP_NAMESPACE_REGEX=/^[-a-z0-9]{3,8}$/u,r.CAIP_REFERENCE_REGEX=/^[-_a-zA-Z0-9]{1,32}$/u,r.CAIP_ACCOUNT_ID_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})):(?<accountAddress>[-.%a-zA-Z0-9]{1,128})$/u,r.CAIP_ACCOUNT_ADDRESS_REGEX=/^[-.%a-zA-Z0-9]{1,128}$/u,r.CaipChainIdStruct=(0,n.pattern)((0,n.string)(),r.CAIP_CHAIN_ID_REGEX),r.CaipNamespaceStruct=(0,n.pattern)((0,n.string)(),r.CAIP_NAMESPACE_REGEX),r.CaipReferenceStruct=(0,n.pattern)((0,n.string)(),r.CAIP_REFERENCE_REGEX),r.CaipAccountIdStruct=(0,n.pattern)((0,n.string)(),r.CAIP_ACCOUNT_ID_REGEX),r.CaipAccountAddressStruct=(0,n.pattern)((0,n.string)(),r.CAIP_ACCOUNT_ADDRESS_REGEX),function(e){e.Eip155="eip155",e.Wallet="wallet"}(r.KnownCaipNamespace||(r.KnownCaipNamespace={})),r.isCaipChainId=function(e){return(0,n.is)(e,r.CaipChainIdStruct)},r.isCaipNamespace=s,r.isCaipReference=o,r.isCaipAccountId=function(e){return(0,n.is)(e,r.CaipAccountIdStruct)},r.isCaipAccountAddress=function(e){return(0,n.is)(e,r.CaipAccountAddressStruct)},r.parseCaipChainId=function(e){const t=r.CAIP_CHAIN_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP chain ID.");return{namespace:t.groups.namespace,reference:t.groups.reference}},r.parseCaipAccountId=function(e){const t=r.CAIP_ACCOUNT_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP account ID.");return{address:t.groups.accountAddress,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}},r.toCaipChainId=function(e,t){if(!s(e))throw new Error(`Invalid "namespace", must match: ${r.CAIP_NAMESPACE_REGEX.toString()}`);if(!o(t))throw new Error(`Invalid "reference", must match: ${r.CAIP_REFERENCE_REGEX.toString()}`);return`${e}:${t}`}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/caip-types.cjs"}],[1135,{"./base64.cjs":1132,"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ChecksumStruct=void 0;const n=e("@metamask/superstruct"),s=e("./base64.cjs");r.ChecksumStruct=(0,n.size)((0,s.base64)((0,n.string)(),{paddingRequired:!0}),44,44)}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/checksum.cjs"}],[1136,{"./assert.cjs":1131,"./bytes.cjs":1133,"./hex.cjs":1140,"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createHex=r.createBytes=r.createBigInt=r.createNumber=void 0;const n=e("@metamask/superstruct"),s=e("./assert.cjs"),o=e("./bytes.cjs"),i=e("./hex.cjs"),a=(0,n.union)([(0,n.number)(),(0,n.bigint)(),(0,n.string)(),i.StrictHexStruct]),c=(0,n.coerce)((0,n.number)(),a,Number),l=(0,n.coerce)((0,n.bigint)(),a,BigInt),u=((0,n.union)([i.StrictHexStruct,(0,n.instance)(Uint8Array)]),(0,n.coerce)((0,n.instance)(Uint8Array),(0,n.union)([i.StrictHexStruct]),o.hexToBytes)),d=(0,n.coerce)(i.StrictHexStruct,(0,n.instance)(Uint8Array),o.bytesToHex);r.createNumber=function(e){try{const t=(0,n.create)(e,c);return(0,s.assert)(Number.isFinite(t),`Expected a number-like value, got "${e}".`),t}catch(t){if(t instanceof n.StructError)throw new Error(`Expected a number-like value, got "${e}".`);throw t}},r.createBigInt=function(e){try{return(0,n.create)(e,l)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a number-like value, got "${String(e.value)}".`);throw e}},r.createBytes=function(e){if("string"==typeof e&&"0x"===e.toLowerCase())return new Uint8Array;try{return(0,n.create)(e,u)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}},r.createHex=function(e){if(e instanceof Uint8Array&&0===e.length||"string"==typeof e&&"0x"===e.toLowerCase())return"0x";try{return(0,n.create)(e,d)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/coercers.cjs"}],[1137,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,o=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},i=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.FrozenSet=r.FrozenMap=void 0;class a{get size(){return o(this,n,"f").size}[(n=new WeakMap,Symbol.iterator)](){return o(this,n,"f")[Symbol.iterator]()}constructor(e){n.set(this,void 0),i(this,n,new Map(e),"f"),Object.freeze(this)}entries(){return o(this,n,"f").entries()}forEach(e,t){return o(this,n,"f").forEach(((r,n,s)=>e.call(t,r,n,this)))}get(e){return o(this,n,"f").get(e)}has(e){return o(this,n,"f").has(e)}keys(){return o(this,n,"f").keys()}values(){return o(this,n,"f").values()}toString(){return`FrozenMap(${this.size}) {${this.size>0?` ${[...this.entries()].map((([e,t])=>`${String(e)} => ${String(t)}`)).join(", ")} `:""}}`}}r.FrozenMap=a;class c{get size(){return o(this,s,"f").size}[(s=new WeakMap,Symbol.iterator)](){return o(this,s,"f")[Symbol.iterator]()}constructor(e){s.set(this,void 0),i(this,s,new Set(e),"f"),Object.freeze(this)}entries(){return o(this,s,"f").entries()}forEach(e,t){return o(this,s,"f").forEach(((r,n,s)=>e.call(t,r,n,this)))}has(e){return o(this,s,"f").has(e)}keys(){return o(this,s,"f").keys()}values(){return o(this,s,"f").values()}toString(){return`FrozenSet(${this.size}) {${this.size>0?` ${[...this.values()].map((e=>String(e))).join(", ")} `:""}}`}}r.FrozenSet=c,Object.freeze(a),Object.freeze(a.prototype),Object.freeze(c),Object.freeze(c.prototype)}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/collections.cjs"}],[1138,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/encryption-types.cjs"}],[1139,{"./misc.cjs":1145,"pony-cause":4459},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.wrapError=r.getErrorMessage=r.isErrorWithStack=r.isErrorWithMessage=r.isErrorWithCode=void 0;const n=e("pony-cause"),s=e("./misc.cjs");function o(e){return"object"==typeof e&&null!==e&&"code"in e}function i(e){return"object"==typeof e&&null!==e&&"message"in e}r.isErrorWithCode=o,r.isErrorWithMessage=i,r.isErrorWithStack=function(e){return"object"==typeof e&&null!==e&&"stack"in e},r.getErrorMessage=function(e){return i(e)&&"string"==typeof e.message?e.message:(0,s.isNullOrUndefined)(e)?"":String(e)},r.wrapError=function(e,t){if((r=e)instanceof Error||(0,s.isObject)(r)&&"Error"===r.constructor.name){let r;return r=2===Error.length?new Error(t,{cause:e}):new n.ErrorWithCause(t,{cause:e}),o(e)&&(r.code=e.code),r}var r;return t.length>0?new Error(`${String(e)}: ${t}`):new Error(String(e))}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/errors.cjs"}],[1140,{"./assert.cjs":1131,"./bytes.cjs":1133,"@metamask/superstruct":2618,"@noble/hashes/sha3":2779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.remove0x=r.add0x=r.isValidChecksumAddress=r.getChecksumAddress=r.isValidHexAddress=r.assertIsStrictHexString=r.assertIsHexString=r.isStrictHexString=r.isHexString=r.HexChecksumAddressStruct=r.HexAddressStruct=r.StrictHexStruct=r.HexStruct=void 0;const n=e("@metamask/superstruct"),s=e("@noble/hashes/sha3"),o=e("./assert.cjs"),i=e("./bytes.cjs");function a(e){return(0,n.is)(e,r.HexStruct)}function c(e){return(0,n.is)(e,r.StrictHexStruct)}function l(e){(0,o.assert)((0,n.is)(e,r.HexChecksumAddressStruct),"Invalid hex address.");const t=d(e.toLowerCase()),a=d((0,i.bytesToHex)((0,s.keccak_256)(t)));return`0x${t.split("").map(((e,t)=>{const r=a[t];return(0,o.assert)((0,n.is)(r,(0,n.string)()),"Hash shorter than address."),parseInt(r,16)>7?e.toUpperCase():e})).join("")}`}function u(e){return!!(0,n.is)(e,r.HexChecksumAddressStruct)&&l(e)===e}function d(e){return e.startsWith("0x")||e.startsWith("0X")?e.substring(2):e}r.HexStruct=(0,n.pattern)((0,n.string)(),/^(?:0x)?[0-9a-f]+$/iu),r.StrictHexStruct=(0,n.pattern)((0,n.string)(),/^0x[0-9a-f]+$/iu),r.HexAddressStruct=(0,n.pattern)((0,n.string)(),/^0x[0-9a-f]{40}$/u),r.HexChecksumAddressStruct=(0,n.pattern)((0,n.string)(),/^0x[0-9a-fA-F]{40}$/u),r.isHexString=a,r.isStrictHexString=c,r.assertIsHexString=function(e){(0,o.assert)(a(e),"Value must be a hexadecimal string.")},r.assertIsStrictHexString=function(e){(0,o.assert)(c(e),'Value must be a hexadecimal string, starting with "0x".')},r.isValidHexAddress=function(e){return(0,n.is)(e,r.HexAddressStruct)||u(e)},r.getChecksumAddress=l,r.isValidChecksumAddress=u,r.add0x=function(e){return e.startsWith("0x")?e:e.startsWith("0X")?`0x${e.substring(2)}`:`0x${e}`},r.remove0x=d}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/hex.cjs"}],[1141,{"./assert.cjs":1131,"./base64.cjs":1132,"./bytes.cjs":1133,"./caip-types.cjs":1134,"./checksum.cjs":1135,"./coercers.cjs":1136,"./collections.cjs":1137,"./encryption-types.cjs":1138,"./errors.cjs":1139,"./hex.cjs":1140,"./json.cjs":1142,"./keyring.cjs":1143,"./logging.cjs":1144,"./misc.cjs":1145,"./number.cjs":1146,"./opaque.cjs":1147,"./promise.cjs":1148,"./time.cjs":1149,"./transaction-types.cjs":1150,"./versions.cjs":1151},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./assert.cjs"),r),s(e("./base64.cjs"),r),s(e("./bytes.cjs"),r),s(e("./caip-types.cjs"),r),s(e("./checksum.cjs"),r),s(e("./coercers.cjs"),r),s(e("./collections.cjs"),r),s(e("./encryption-types.cjs"),r),s(e("./errors.cjs"),r),s(e("./hex.cjs"),r),s(e("./json.cjs"),r),s(e("./keyring.cjs"),r),s(e("./logging.cjs"),r),s(e("./misc.cjs"),r),s(e("./number.cjs"),r),s(e("./opaque.cjs"),r),s(e("./promise.cjs"),r),s(e("./time.cjs"),r),s(e("./transaction-types.cjs"),r),s(e("./versions.cjs"),r)}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/index.cjs"}],[1142,{"./assert.cjs":1131,"./misc.cjs":1145,"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getJsonRpcIdValidator=r.assertIsJsonRpcError=r.isJsonRpcError=r.assertIsJsonRpcFailure=r.isJsonRpcFailure=r.assertIsJsonRpcSuccess=r.isJsonRpcSuccess=r.assertIsJsonRpcResponse=r.isJsonRpcResponse=r.assertIsPendingJsonRpcResponse=r.isPendingJsonRpcResponse=r.JsonRpcResponseStruct=r.JsonRpcFailureStruct=r.JsonRpcSuccessStruct=r.PendingJsonRpcResponseStruct=r.assertIsJsonRpcRequest=r.isJsonRpcRequest=r.assertIsJsonRpcNotification=r.isJsonRpcNotification=r.JsonRpcNotificationStruct=r.JsonRpcRequestStruct=r.JsonRpcParamsStruct=r.JsonRpcErrorStruct=r.JsonRpcIdStruct=r.JsonRpcVersionStruct=r.jsonrpc2=r.getJsonSize=r.getSafeJson=r.isValidJson=r.JsonStruct=r.UnsafeJsonStruct=r.exactOptional=r.object=void 0;const n=e("@metamask/superstruct"),s=e("./assert.cjs"),o=e("./misc.cjs");function i({path:e,branch:t}){const r=e[e.length-1];return(0,o.hasProperty)(t[t.length-2],r)}function a(e){return new n.Struct({...e,type:`optional ${e.type}`,validator:(t,r)=>!i(r)||e.validator(t,r),refiner:(t,r)=>!i(r)||e.refiner(t,r)})}r.object=e=>(0,n.object)(e),r.exactOptional=a;function c(e){return(0,n.create)(e,r.JsonStruct)}r.UnsafeJsonStruct=(0,n.union)([(0,n.literal)(null),(0,n.boolean)(),(0,n.define)("finite number",(e=>(0,n.is)(e,(0,n.number)())&&Number.isFinite(e))),(0,n.string)(),(0,n.array)((0,n.lazy)((()=>r.UnsafeJsonStruct))),(0,n.record)((0,n.string)(),(0,n.lazy)((()=>r.UnsafeJsonStruct)))]),r.JsonStruct=(0,n.coerce)(r.UnsafeJsonStruct,(0,n.any)(),(e=>((0,s.assertStruct)(e,r.UnsafeJsonStruct),JSON.parse(JSON.stringify(e,((e,t)=>"__proto__"===e||"constructor"===e?undefined:t)))))),r.isValidJson=function(e){try{return c(e),!0}catch{return!1}},r.getSafeJson=c,r.getJsonSize=function(e){(0,s.assertStruct)(e,r.JsonStruct,"Invalid JSON value");const t=JSON.stringify(e);return(new TextEncoder).encode(t).byteLength},r.jsonrpc2="2.0",r.JsonRpcVersionStruct=(0,n.literal)(r.jsonrpc2),r.JsonRpcIdStruct=(0,n.nullable)((0,n.union)([(0,n.number)(),(0,n.string)()])),r.JsonRpcErrorStruct=(0,r.object)({code:(0,n.integer)(),message:(0,n.string)(),data:a(r.JsonStruct),stack:a((0,n.string)())}),r.JsonRpcParamsStruct=(0,n.union)([(0,n.record)((0,n.string)(),r.JsonStruct),(0,n.array)(r.JsonStruct)]),r.JsonRpcRequestStruct=(0,r.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,method:(0,n.string)(),params:a(r.JsonRpcParamsStruct)}),r.JsonRpcNotificationStruct=(0,r.object)({jsonrpc:r.JsonRpcVersionStruct,method:(0,n.string)(),params:a(r.JsonRpcParamsStruct)}),r.isJsonRpcNotification=function(e){return(0,n.is)(e,r.JsonRpcNotificationStruct)},r.assertIsJsonRpcNotification=function(e,t){(0,s.assertStruct)(e,r.JsonRpcNotificationStruct,"Invalid JSON-RPC notification",t)},r.isJsonRpcRequest=function(e){return(0,n.is)(e,r.JsonRpcRequestStruct)},r.assertIsJsonRpcRequest=function(e,t){(0,s.assertStruct)(e,r.JsonRpcRequestStruct,"Invalid JSON-RPC request",t)},r.PendingJsonRpcResponseStruct=(0,n.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,result:(0,n.optional)((0,n.unknown)()),error:(0,n.optional)(r.JsonRpcErrorStruct)}),r.JsonRpcSuccessStruct=(0,r.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,result:r.JsonStruct}),r.JsonRpcFailureStruct=(0,r.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,error:r.JsonRpcErrorStruct}),r.JsonRpcResponseStruct=(0,n.union)([r.JsonRpcSuccessStruct,r.JsonRpcFailureStruct]),r.isPendingJsonRpcResponse=function(e){return(0,n.is)(e,r.PendingJsonRpcResponseStruct)},r.assertIsPendingJsonRpcResponse=function(e,t){(0,s.assertStruct)(e,r.PendingJsonRpcResponseStruct,"Invalid pending JSON-RPC response",t)},r.isJsonRpcResponse=function(e){return(0,n.is)(e,r.JsonRpcResponseStruct)},r.assertIsJsonRpcResponse=function(e,t){(0,s.assertStruct)(e,r.JsonRpcResponseStruct,"Invalid JSON-RPC response",t)},r.isJsonRpcSuccess=function(e){return(0,n.is)(e,r.JsonRpcSuccessStruct)},r.assertIsJsonRpcSuccess=function(e,t){(0,s.assertStruct)(e,r.JsonRpcSuccessStruct,"Invalid JSON-RPC success response",t)},r.isJsonRpcFailure=function(e){return(0,n.is)(e,r.JsonRpcFailureStruct)},r.assertIsJsonRpcFailure=function(e,t){(0,s.assertStruct)(e,r.JsonRpcFailureStruct,"Invalid JSON-RPC failure response",t)},r.isJsonRpcError=function(e){return(0,n.is)(e,r.JsonRpcErrorStruct)},r.assertIsJsonRpcError=function(e,t){(0,s.assertStruct)(e,r.JsonRpcErrorStruct,"Invalid JSON-RPC error",t)},r.getJsonRpcIdValidator=function(e){const{permitEmptyString:t,permitFractions:r,permitNull:n}={permitEmptyString:!0,permitFractions:!1,permitNull:!0,...e};return e=>Boolean("number"==typeof e&&(r||Number.isInteger(e))||"string"==typeof e&&(t||e.length>0)||n&&null===e)}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/json.cjs"}],[1143,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/keyring.cjs"}],[1144,{debug:3665},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.createProjectLogger=void 0;const s=(0,n(e("debug")).default)("metamask");r.createProjectLogger=function(e){return s.extend(e)},r.createModuleLogger=function(e,t){return e.extend(t)}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/logging.cjs"}],[1145,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.calculateNumberSize=r.calculateStringSize=r.isASCII=r.isPlainObject=r.ESCAPE_CHARACTERS_REGEXP=r.JsonSize=r.getKnownPropertyNames=r.hasProperty=r.isObject=r.isNullOrUndefined=r.isNonEmptyArray=void 0,r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isNullOrUndefined=function(e){return null===e||e===undefined},r.isObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)};function n(e){return e.charCodeAt(0)<=127}r.hasProperty=(e,t)=>Object.hasOwnProperty.call(e,t),r.getKnownPropertyNames=function(e){return Object.getOwnPropertyNames(e)},function(e){e[e.Null=4]="Null",e[e.Comma=1]="Comma",e[e.Wrapper=1]="Wrapper",e[e.True=4]="True",e[e.False=5]="False",e[e.Quote=1]="Quote",e[e.Colon=1]="Colon",e[e.Date=24]="Date"}(r.JsonSize||(r.JsonSize={})),r.ESCAPE_CHARACTERS_REGEXP=/"|\\|\n|\r|\t/gu,r.isPlainObject=function(e){if("object"!=typeof e||null===e)return!1;try{let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}catch(e){return!1}},r.isASCII=n,r.calculateStringSize=function(e){return e.split("").reduce(((e,t)=>n(t)?e+1:e+2),0)+(e.match(r.ESCAPE_CHARACTERS_REGEXP)??[]).length},r.calculateNumberSize=function(e){return e.toString().length}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/misc.cjs"}],[1146,{"./assert.cjs":1131,"./hex.cjs":1140},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.hexToBigInt=r.hexToNumber=r.bigIntToHex=r.numberToHex=void 0;const n=e("./assert.cjs"),s=e("./hex.cjs");r.numberToHex=e=>((0,n.assert)("number"==typeof e,"Value must be a number."),(0,n.assert)(e>=0,"Value must be a non-negative number."),(0,n.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToHex` instead."),(0,s.add0x)(e.toString(16)));r.bigIntToHex=e=>((0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)(e>=0,"Value must be a non-negative bigint."),(0,s.add0x)(e.toString(16)));r.hexToNumber=e=>{(0,s.assertIsHexString)(e);const t=parseInt(e,16);return(0,n.assert)(Number.isSafeInteger(t),"Value is not a safe integer. Use `hexToBigInt` instead."),t};r.hexToBigInt=e=>((0,s.assertIsHexString)(e),BigInt((0,s.add0x)(e)))}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/number.cjs"}],[1147,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/opaque.cjs"}],[1148,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createDeferredPromise=void 0,r.createDeferredPromise=function({suppressUnhandledRejection:e=!1}={}){let t,r;const n=new Promise(((e,n)=>{t=e,r=n}));return e&&n.catch((e=>{})),{promise:n,resolve:t,reject:r}}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/promise.cjs"}],[1149,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.timeSince=r.inMilliseconds=r.Duration=void 0,function(e){e[e.Millisecond=1]="Millisecond",e[e.Second=1e3]="Second",e[e.Minute=6e4]="Minute",e[e.Hour=36e5]="Hour",e[e.Day=864e5]="Day",e[e.Week=6048e5]="Week",e[e.Year=31536e6]="Year"}(r.Duration||(r.Duration={}));const n=(e,t)=>{if(!(e=>Number.isInteger(e)&&e>=0)(e))throw new Error(`"${t}" must be a non-negative integer. Received: "${e}".`)};r.inMilliseconds=function(e,t){return n(e,"count"),e*t},r.timeSince=function(e){return n(e,"timestamp"),Date.now()-e}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/time.cjs"}],[1150,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/transaction-types.cjs"}],[1151,{"./assert.cjs":1131,"@metamask/superstruct":2618,semver:4785},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.satisfiesVersionRange=r.gtRange=r.gtVersion=r.assertIsSemVerRange=r.assertIsSemVerVersion=r.isValidSemVerRange=r.isValidSemVerVersion=r.VersionRangeStruct=r.VersionStruct=void 0;const n=e("@metamask/superstruct"),s=e("semver"),o=e("./assert.cjs");r.VersionStruct=(0,n.refine)((0,n.string)(),"Version",(e=>null!==(0,s.valid)(e)||`Expected SemVer version, got "${e}"`)),r.VersionRangeStruct=(0,n.refine)((0,n.string)(),"Version range",(e=>null!==(0,s.validRange)(e)||`Expected SemVer range, got "${e}"`)),r.isValidSemVerVersion=function(e){return(0,n.is)(e,r.VersionStruct)},r.isValidSemVerRange=function(e){return(0,n.is)(e,r.VersionRangeStruct)},r.assertIsSemVerVersion=function(e){(0,o.assertStruct)(e,r.VersionStruct)},r.assertIsSemVerRange=function(e){(0,o.assertStruct)(e,r.VersionRangeStruct)},r.gtVersion=function(e,t){return(0,s.gt)(e,t)},r.gtRange=function(e,t){return(0,s.gtr)(e,t)},r.satisfiesVersionRange=function(e,t){return(0,s.satisfies)(e,t,{includePrerelease:!0})}}}},{package:"@metamask/accounts-controller>@metamask/utils",file:"node_modules/@metamask/accounts-controller/node_modules/@metamask/utils/dist/versions.cjs"}],[1152,{"@metamask/base-controller":1235,"@metamask/controller-utils":1159},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@metamask/base-controller"),s=e("@metamask/controller-utils"),o=(e=>(e.externallyOwnedAccounts="EXTERNALLY_OWNED_ACCOUNTS",e.contractAccounts="CONTRACT_ACCOUNTS",e.nonAccounts="NON_ACCOUNTS",e))(o||{}),i=class extends n.BaseControllerV1{constructor(e,t){super(e,t),this.name="AddressBookController",this.defaultState={addressBook:{}},this.initialize()}clear(){this.update({addressBook:{}})}delete(e,t){if(t=s.toChecksumHexAddress.call(void 0,t),!s.isValidHexAddress.call(void 0,t)||!this.state.addressBook[e]||!this.state.addressBook[e][t])return!1;const r=Object.assign({},this.state.addressBook);return delete r[e][t],0===Object.keys(r[e]).length&&delete r[e],this.update({addressBook:r}),!0}set(e,t,r=s.toHex.call(void 0,1),n="",o){if(e=s.toChecksumHexAddress.call(void 0,e),!s.isValidHexAddress.call(void 0,e))return!1;const i={address:e,chainId:r,isEns:!1,memo:n,name:t,addressType:o},a=s.normalizeEnsName.call(void 0,t);return a&&(i.name=a,i.isEns=!0),this.update({addressBook:{...this.state.addressBook,[r]:{...this.state.addressBook[r],[e]:i}}}),!0}},a=i;r.AddressType=o,r.AddressBookController=i,r.AddressBookController_default=a}}},{package:"@metamask/address-book-controller",file:"node_modules/@metamask/address-book-controller/dist/chunk-ISKA7MA7.js"}],[1153,{"./chunk-ISKA7MA7.js":1152},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-ISKA7MA7.js");r.AddressBookController=n.AddressBookController,r.AddressType=n.AddressType}}},{package:"@metamask/address-book-controller",file:"node_modules/@metamask/address-book-controller/dist/index.js"}],[1154,{"@metamask/utils":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@metamask/utils"),s=n.createProjectLogger.call(void 0,"controller-utils");r.createModuleLogger=n.createModuleLogger,r.projectLogger=s}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[1155,{"./chunk-X4PYR7CK.js":1158,"@ethereumjs/util":461,"@metamask/ethjs-unit":1440,"@metamask/utils":2739,"bn.js":3472,buffer:3520,"eth-ens-namehash":3712,"fast-deep-equal":3842},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=e("./chunk-X4PYR7CK.js"),o=e("@ethereumjs/util"),i=e("@metamask/ethjs-unit"),a=e("@metamask/utils"),c=n(e("bn.js")),l=n(e("eth-ens-namehash")),u=n(e("fast-deep-equal")),d=new Error("timeout"),h=["__proto__","constructor","prototype"];function p(e){return e?new(0,c.default)(a.remove0x.call(void 0,e),16):new(0,c.default)(0)}async function m(e,t){const r=await fetch(e,t);if(!r.ok)throw new Error(`Fetch failed with status '${r.status}' for request '${String(e)}'`);return r}async function g(e,t){const r=await m(e,t);return await r.json()}r.PROTOTYPE_POLLUTION_BLOCKLIST=h,r.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},r.isSafeChainId=function(e){if(!a.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,a.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=s.MAX_SAFE_CHAIN_ID},r.BNToHex=function(e){return a.add0x.call(void 0,e.toString(16))},r.fractionBN=function(e,t,r){const n=new(0,c.default)(t),s=new(0,c.default)(r);return e.mul(n).div(s)},r.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,c.default)(0);const t=e.toString().split("."),r=t[0]||"0";let n=t[1]||"";if(!n)return i.toWei.call(void 0,r,"gwei");if(n.length<=9)return i.toWei.call(void 0,`${r}.${n}`,"gwei");const s=n.slice(9)[0];n=n.slice(0,9);let o=i.toWei.call(void 0,`${r}.${n}`,"gwei");return Number(s)>=5&&(o=o.add(new(0,c.default)(1))),o},r.weiHexToGweiDec=function(e){const t=new(0,c.default)(a.remove0x.call(void 0,e),16);return i.fromWei.call(void 0,t,"gwei")},r.getBuyURL=function(e="1",t,r=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${r}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},r.hexToBN=p,r.hexToText=function(e){try{const r=a.remove0x.call(void 0,e);return t.from(r,"hex").toString("utf8")}catch(t){return e}},r.fromHex=function(e){return c.default.isBN(e)?e:new(0,c.default)(p(e).toString(10))},r.toHex=function(e){return"string"==typeof e&&a.isStrictHexString.call(void 0,e)?e:`0x${c.default.isBN(e)?e.toString(16):new(0,c.default)(e.toString(),10).toString(16)}`},r.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},r.safelyExecuteWithTimeout=async function(e,t=!1,r=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))])}catch(e){return void(t&&console.error(e))}},r.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=a.add0x.call(void 0,e);return a.isHexString.call(void 0,t)?o.toChecksumAddress.call(void 0,t):t},r.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const r=t?a.add0x.call(void 0,e):e;return!!a.isStrictHexString.call(void 0,r)&&o.isValidAddress.call(void 0,r)},r.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},r.successfulFetch=m,r.handleFetch=g,r.fetchWithErrorHandling=async function({url:e,options:t,timeout:r,errorCodesToCatch:n}){let s;try{s=r?Promise.race([await g(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))]):await g(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==d)throw e;console.error(e)}(e,n)}return s},r.timeoutFetch=async function(e,t,r=500){return Promise.race([m(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))])},r.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=l.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},r.query=function(e,t,r=[]){return new Promise(((n,s)=>{const o=(e,t)=>{e?s(e):n(t)};t in e&&"function"==typeof e[t]?e[t](...r,o):e.sendAsync({method:t,params:r},o)}))},r.convertHexToDecimal=(e="0x0")=>a.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,r.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isValidJson=function(e){try{return u.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/chunk-EDY72VWL.js"}],[1156,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},s={...n,rpc:"rpc"};var o=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(o||{}),i={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},a=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(a||{});r.InfuraNetworkType=n,r.NetworkType=s,r.isNetworkType=function(e){return Object.values(s).includes(e)},r.isInfuraNetworkType=function(e){return Object.keys(n).includes(e)},r.BuiltInNetworkName=o,r.ChainId=i,r.NetworksTicker=a}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[1157,{"./chunk-DBJSLKNR.js":1154,"@metamask/utils":2739,"@spruceid/siwe-parser":3010,buffer:3520},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-DBJSLKNR.js"),s=e("@metamask/utils"),o=e("@spruceid/siwe-parser"),i=n.createModuleLogger.call(void 0,n.projectLogger,"detect-siwe");function a(e){try{const n="string"!=typeof(r=e)?r:s.remove0x.call(void 0,r),o=t.from(n,"hex");return 32===o.length?e:o.toString("utf8")}catch(t){return i(t),e}var r}var c={"http:":"80","https:":"443"},l=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);r.parseDomainParts=l,r.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:r}=e;if(!t||!r?.parsedMessage?.domain)return!1;const n=new URL(t),s=l(r.parsedMessage.domain,n.protocol);return 0===s.hostname.localeCompare(n.hostname,void 0,{sensitivity:"accent"})&&(""!==s.port&&s.port!==n.port?""===n.port&&s.port===c[n.protocol]:""===s.username||s.username===n.username)}catch(e){return i(e),!1}},r.detectSIWE=e=>{try{const{data:t}=e,r=a(t);return{isSIWEMessage:!0,parsedMessage:new(0,o.ParsedMessage)(r)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[1158,{"./chunk-LGGBBU6G.js":1156},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-LGGBBU6G.js"),s={[n.NetworkType.goerli]:{chainId:n.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.goerli}.etherscan.io`}},[n.NetworkType.sepolia]:{chainId:n.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.sepolia}.etherscan.io`}},[n.NetworkType.mainnet]:{chainId:n.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[n.NetworkType["linea-goerli"]]:{chainId:n.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[n.NetworkType["linea-sepolia"]]:{chainId:n.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[n.NetworkType["linea-mainnet"]]:{chainId:n.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[n.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},o=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSign="eth_sign",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(o||{}),i={[n.ChainId.goerli]:"goerli",[n.ChainId.sepolia]:"sepolia",[n.ChainId.mainnet]:"mainnet",[n.ChainId["linea-goerli"]]:"linea-goerli",[n.ChainId["linea-sepolia"]]:"linea-sepolia",[n.ChainId["linea-mainnet"]]:"linea-mainnet",[n.ChainId.aurora]:"aurora"};r.RPC="rpc",r.FALL_BACK_VS_CURRENCY="ETH",r.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",r.GANACHE_CHAIN_ID="0x539",r.MAX_SAFE_CHAIN_ID=0xfffffffffffec,r.ERC721="ERC721",r.ERC1155="ERC1155",r.ERC20="ERC20",r.ERC721_INTERFACE_ID="0x80ac58cd",r.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",r.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",r.ERC1155_INTERFACE_ID="0xd9b67a26",r.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",r.GWEI="gwei",r.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},r.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},r.BUILT_IN_NETWORKS=s,r.OPENSEA_PROXY_URL="https://proxy.metafi.codefi.network/opensea/v1/api/v2",r.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",r.ORIGIN_METAMASK="metamask",r.ApprovalType=o,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=i}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/chunk-X4PYR7CK.js"}],[1159,{"./chunk-DBJSLKNR.js":1154,"./chunk-EDY72VWL.js":1155,"./chunk-LGGBBU6G.js":1156,"./chunk-M6G3ISXG.js":1157,"./chunk-X4PYR7CK.js":1158},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var s=e("./chunk-EDY72VWL.js"),o=e("./chunk-X4PYR7CK.js"),i=e("./chunk-LGGBBU6G.js");r.ASSET_TYPES=o.ASSET_TYPES,r.ApprovalType=o.ApprovalType,r.BNToHex=s.BNToHex,r.BUILT_IN_NETWORKS=o.BUILT_IN_NETWORKS,r.BuiltInNetworkName=i.BuiltInNetworkName,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=o.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,r.ChainId=i.ChainId,r.ERC1155=o.ERC1155,r.ERC1155_INTERFACE_ID=o.ERC1155_INTERFACE_ID,r.ERC1155_METADATA_URI_INTERFACE_ID=o.ERC1155_METADATA_URI_INTERFACE_ID,r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=o.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,r.ERC20=o.ERC20,r.ERC721=o.ERC721,r.ERC721_ENUMERABLE_INTERFACE_ID=o.ERC721_ENUMERABLE_INTERFACE_ID,r.ERC721_INTERFACE_ID=o.ERC721_INTERFACE_ID,r.ERC721_METADATA_INTERFACE_ID=o.ERC721_METADATA_INTERFACE_ID,r.FALL_BACK_VS_CURRENCY=o.FALL_BACK_VS_CURRENCY,r.GANACHE_CHAIN_ID=o.GANACHE_CHAIN_ID,r.GWEI=o.GWEI,r.IPFS_DEFAULT_GATEWAY_URL=o.IPFS_DEFAULT_GATEWAY_URL,r.InfuraNetworkType=i.InfuraNetworkType,r.MAX_SAFE_CHAIN_ID=o.MAX_SAFE_CHAIN_ID,r.NFT_API_BASE_URL=o.NFT_API_BASE_URL,r.NetworkType=i.NetworkType,r.NetworksTicker=i.NetworksTicker,r.OPENSEA_PROXY_URL=o.OPENSEA_PROXY_URL,r.ORIGIN_METAMASK=o.ORIGIN_METAMASK,r.RPC=o.RPC,r.TESTNET_TICKER_SYMBOLS=o.TESTNET_TICKER_SYMBOLS,r.convertHexToDecimal=s.convertHexToDecimal,r.detectSIWE=n.detectSIWE,r.fetchWithErrorHandling=s.fetchWithErrorHandling,r.fractionBN=s.fractionBN,r.fromHex=s.fromHex,r.getBuyURL=s.getBuyURL,r.gweiDecToWEIBN=s.gweiDecToWEIBN,r.handleFetch=s.handleFetch,r.hexToBN=s.hexToBN,r.hexToText=s.hexToText,r.isInfuraNetworkType=i.isInfuraNetworkType,r.isNetworkType=i.isNetworkType,r.isNonEmptyArray=s.isNonEmptyArray,r.isPlainObject=s.isPlainObject,r.isSafeChainId=s.isSafeChainId,r.isSafeDynamicKey=s.isSafeDynamicKey,r.isSmartContractCode=s.isSmartContractCode,r.isValidHexAddress=s.isValidHexAddress,r.isValidJson=s.isValidJson,r.isValidSIWEOrigin=n.isValidSIWEOrigin,r.normalizeEnsName=s.normalizeEnsName,r.parseDomainParts=n.parseDomainParts,r.query=s.query,r.safelyExecute=s.safelyExecute,r.safelyExecuteWithTimeout=s.safelyExecuteWithTimeout,r.successfulFetch=s.successfulFetch,r.timeoutFetch=s.timeoutFetch,r.toChecksumHexAddress=s.toChecksumHexAddress,r.toHex=s.toHex,r.weiHexToGweiDec=s.weiHexToGweiDec}}},{package:"@metamask/address-book-controller>@metamask/controller-utils",file:"node_modules/@metamask/address-book-controller/node_modules/@metamask/controller-utils/dist/index.js"}],[1160,{"@metamask/base-controller":1235},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,o=(e,t,r)=>(((e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)})(e,t,"access private method"),r),i=e("@metamask/base-controller"),a={announcements:{}},c={announcements:{persist:!0,anonymous:!0}},l=class extends i.BaseController{constructor({messenger:e,state:t,allAnnouncements:r}){const i={...a,...t};super({messenger:e,metadata:c,name:"AnnouncementController",state:i}),((e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)})(this,n),o(this,n,s).call(this,r)}resetViewed(){this.update((({announcements:e})=>{for(const t of Object.values(e))t.isShown=!1}))}updateViewed(e){this.update((({announcements:t})=>{for(const r of Object.keys(e).map(Number))t[r].isShown=e[r]}))}};n=new WeakSet,s=function(e){this.update((t=>{Object.values(e).forEach((e=>{t.announcements[e.id]=t.announcements[e.id]??{...e,isShown:!1}}))}))},r.AnnouncementController=l}}},{package:"@metamask/announcement-controller",file:"node_modules/@metamask/announcement-controller/dist/chunk-ZGM3XNIO.js"}],[1161,{"./chunk-ZGM3XNIO.js":1160},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-ZGM3XNIO.js");r.AnnouncementController=n.AnnouncementController}}},{package:"@metamask/announcement-controller",file:"node_modules/@metamask/announcement-controller/dist/index.js"}],[118,{"./snap-keyring":121},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getAccountsBySnapId",{enumerable:!0,get:function(){return n.getAccountsBySnapId}}),Object.defineProperty(r,"snapKeyringBuilder",{enumerable:!0,get:function(){return n.snapKeyringBuilder}});var n=e("./snap-keyring")}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/index.ts"}],[119,{"@metamask/keyring-api":1566,"@metamask/permission-controller":1796},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isProtocolAllowed=u,r.keyringSnapPermissionsBuilder=function(e,t){return()=>{if("metamask"===t)return i;if(o.includes(t))return c;const r=e.getSubjectMetadata(t);return(null==r?void 0:r.subjectType)===n.SubjectType.Website&&u(t)?a:[]}};var n=e("@metamask/permission-controller"),s=e("@metamask/keyring-api");const o=["https://portfolio.metamask.io"],i=[s.KeyringRpcMethod.ListAccounts,s.KeyringRpcMethod.GetAccount,s.KeyringRpcMethod.FilterAccountChains,s.KeyringRpcMethod.DeleteAccount,s.KeyringRpcMethod.ListRequests,s.KeyringRpcMethod.GetRequest,s.KeyringRpcMethod.SubmitRequest,s.KeyringRpcMethod.RejectRequest],a=[s.KeyringRpcMethod.ListAccounts,s.KeyringRpcMethod.GetAccount,s.KeyringRpcMethod.CreateAccount,s.KeyringRpcMethod.FilterAccountChains,s.KeyringRpcMethod.UpdateAccount,s.KeyringRpcMethod.DeleteAccount,s.KeyringRpcMethod.ExportAccount,s.KeyringRpcMethod.ListRequests,s.KeyringRpcMethod.GetRequest,s.KeyringRpcMethod.ApproveRequest,s.KeyringRpcMethod.RejectRequest],c=[s.KeyringRpcMethod.ListAccounts,s.KeyringRpcMethod.GetAccount,s.KeyringRpcMethod.GetAccountBalances,s.KeyringRpcMethod.SubmitRequest],l=["https:"];function u(e){try{const t=new URL(e);return l.includes(t.protocol)}catch(e){return!1}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/keyring-snaps-permissions.ts"}],[12,{"./auth-snap-requests":11,"./services":13,"@metamask/base-controller":1235},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/base-controller"),s=e("./auth-snap-requests"),o=e("./services");function i(e,t){c(e,t),t.add(e)}function a(e,t,r){c(e,t),t.set(e,r)}function c(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function u(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,h(e,t,"get"))}function d(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,h(e,t,"set"),r),r}function h(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}const p=18e5,m="AuthenticationController",g={isSignedIn:!1},f={isSignedIn:{persist:!0,anonymous:!0},sessionData:{persist:!0,anonymous:!1}};var y=new WeakMap,w=new WeakMap,C=new WeakMap,k=new WeakSet,v=new WeakSet,b=new WeakSet,S=new WeakSet,T=new WeakMap,_=new WeakSet,E=new WeakMap,A=new WeakSet;class M extends n.BaseController{constructor({messenger:e,state:t,metametrics:r}){super({messenger:e,metadata:f,name:m,state:{...g,...t}}),i(this,A),i(this,_),i(this,S),i(this,b),i(this,v),i(this,k),a(this,y,{writable:!0,value:void 0}),a(this,w,{writable:!0,value:!1}),a(this,C,{writable:!0,value:{setupLockedStateSubscriptions:()=>{const{isUnlocked:e}=this.messagingSystem.call("KeyringController:getState");d(this,w,e),this.messagingSystem.subscribe("KeyringController:unlock",(()=>{d(this,w,!0)})),this.messagingSystem.subscribe("KeyringController:lock",(()=>{d(this,w,!1)}))}}}),a(this,T,{writable:!0,value:void 0}),a(this,E,{writable:!0,value:{}}),d(this,y,r),u(this,C).setupLockedStateSubscriptions(),l(this,k,P).call(this)}async performSignIn(){const{accessToken:e}=await l(this,b,R).call(this);return e}performSignOut(){l(this,v,I).call(this),this.update((e=>{e.isSignedIn=!1,e.sessionData=undefined}))}async getBearerToken(){if(l(this,v,I).call(this),l(this,S,N).call(this,this.state.sessionData))return this.state.sessionData.accessToken;const{accessToken:e}=await l(this,b,R).call(this);return e}async getSessionProfile(){if(l(this,v,I).call(this),l(this,S,N).call(this,this.state.sessionData))return this.state.sessionData.profile;const{profile:e}=await l(this,b,R).call(this);return e}isSignedIn(){return this.state.isSignedIn}}function P(){this.messagingSystem.registerActionHandler("AuthenticationController:getBearerToken",this.getBearerToken.bind(this)),this.messagingSystem.registerActionHandler("AuthenticationController:getSessionProfile",this.getSessionProfile.bind(this)),this.messagingSystem.registerActionHandler("AuthenticationController:isSignedIn",this.isSignedIn.bind(this)),this.messagingSystem.registerActionHandler("AuthenticationController:performSignIn",this.performSignIn.bind(this)),this.messagingSystem.registerActionHandler("AuthenticationController:performSignOut",this.performSignOut.bind(this))}function I(){if(!this.state.isSignedIn)throw new Error(`${m}: Unable to call method, user is not authenticated`)}async function R(){try{const e=await l(this,_,j).call(this),t=await(0,o.getNonce)(e);if(!t)throw new Error("Unable to get nonce");const r=(0,o.createLoginRawMessage)(t,e),n=await l(this,A,x).call(this,r),s=await(0,o.login)(r,n,u(this,y).getMetaMetricsId());if(null==s||!s.token)throw new Error("Unable to login");const i={identifierId:s.profile.identifier_id,profileId:s.profile.profile_id},a=await(0,o.getAccessToken)(s.token);if(!a)throw new Error("Unable to get Access Token");return this.update((e=>{e.isSignedIn=!0;const t=new Date;t.setTime(t.getTime()+p),e.sessionData={profile:i,accessToken:a,expiresIn:t.toString()}})),{profile:i,accessToken:a}}catch(e){console.error("Failed to authenticate",e);const t=e instanceof Error?e.message:JSON.stringify(e??"");throw new Error(`${m}: Failed to authenticate - ${t}`)}}function N(e){if(!e)return!1;const t=Date.parse(e.expiresIn);if(isNaN(t))return!1;const r=new Date,n=Math.abs(r.getTime()-t);return p>n}async function j(){if(u(this,T))return u(this,T);if(!u(this,w))throw new Error("#snapGetPublicKey - unable to call snap, wallet is locked");const e=await this.messagingSystem.call("SnapController:handleRequest",(0,s.createSnapPublicKeyRequest)());return d(this,T,e),e}async function x(e){if(u(this,E)[e])return u(this,E)[e];if(!u(this,w))throw new Error("#snapSignMessage - unable to call snap, wallet is locked");const t=await this.messagingSystem.call("SnapController:handleRequest",(0,s.createSnapSignMessageRequest)(e));return u(this,E)[e]=t,t}r.default=M}}},{package:"$root$",file:"app/scripts/controllers/authentication/authentication-controller.ts"}],[120,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getSnapAndHardwareInfoForMetrics=async function(e,t,r){var n,s,o;if(!r)return{};const i=r.call("AccountsController:getSelectedAccount"),a=i.address,{keyring:c}=i.metadata;let l;var u;null!==(n=i.metadata.snap)&&void 0!==n&&n.id&&(l=r.call("SnapController:get",null===(u=i.metadata.snap)||void 0===u?void 0:u.id));return{account_type:await e(a),device_model:await t(a),account_hardware_type:await async function(){var e;return null!=c&&null!==(e=c.type)&&void 0!==e&&e.includes("Hardware")?c.type:undefined}(),account_snap_type:null===(s=l)||void 0===s?void 0:s.id,account_snap_version:null===(o=l)||void 0===o?void 0:o.version}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/metrics.ts"}],[121,{"../../../../shared/constants/app":4962,"../../../../shared/constants/metametrics":4973,"../../../../ui/components/component-library/icon":5439,"../../translate":278,"./utils/isBlockedUrl":122,"./utils/showResult":123,"@metamask/eth-snap-keyring":1397,"webextension-polyfill":4941},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.snapKeyringBuilder=r.getAccountsBySnapId=void 0;var n,s=e("@metamask/eth-snap-keyring"),o=(n=e("webextension-polyfill"))&&n.__esModule?n:{default:n},i=e("../../../../shared/constants/metametrics"),a=e("../../../../shared/constants/app"),c=e("../../translate"),l=e("../../../../ui/components/component-library/icon"),u=e("./utils/isBlockedUrl"),d=e("./utils/showResult");r.getAccountsBySnapId=async(e,t)=>{const r=await e.getSnapKeyring();return await r.getAccountsBySnapId(t)};r.snapKeyringBuilder=(e,t,r,n,h,p,m,g)=>{const f=()=>new s.SnapKeyring(t(),{addressExists:async t=>(await e.call("KeyringController:getAccounts")).includes(t.toLowerCase()),redirectUser:async(t,r,n)=>{if(r.length>0||n.length>0){const s=await(0,u.isBlockedUrl)(r,(async()=>await e.call("PhishingController:maybeUpdateState")),(t=>e.call("PhishingController:testOrigin",t))),i=await e.call("ApprovalController:addRequest",{origin:t,requestData:{url:r,message:n,isBlockedUrl:s},type:a.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.showSnapAccountRedirect},!0);Boolean(i)&&r.length>0?o.default.tabs.create({url:r}):console.log("User refused snap account redirection to:",r)}else console.log("Error occurred when redirecting snap account. url or message must be defined")},saveState:async()=>{await r()},addAccount:async(t,s,o,u,h=!1)=>{const f=m(s),y=e=>{p({event:e,category:i.MetaMetricsEventCategory.Accounts,properties:{account_type:i.MetaMetricsEventAccountType.Snap,snap_id:s,snap_name:f}})},w="https://support.metamask.io/managing-my-wallet/accounts-and-addresses/how-to-add-accounts-in-your-wallet/",C=g(s)&&!h;let k=C,v="";try{if(!C){const{id:t}=e.call("ApprovalController:startFlow");v=t,k=Boolean(await e.call("ApprovalController:addRequest",{origin:s,type:a.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountCreation},!0))}if(!k)throw await o(k),new Error("User denied account creation");try{await o(k),await r(),n(t);const a=e.call("AccountsController:getAccountByAddress",t);if(!a)throw new Error(`Internal account not found for address: ${t}`);e.call("AccountsController:setSelectedAccount",a.id),y(i.MetaMetricsEventName.AddSnapAccountSuccessViewed),C||await(0,d.showSuccess)(e,s,{icon:l.IconName.UserCircleAdd,title:(0,c.t)("snapAccountCreated")},{message:(0,c.t)("snapAccountCreatedDescription"),address:t,learnMoreLink:w}),y(i.MetaMetricsEventName.AddSnapAccountSuccessClicked)}catch(t){const r=t.message;throw await(0,d.showError)(e,s,{icon:l.IconName.UserCircleAdd,title:(0,c.t)("snapAccountCreationFailed")},{message:(0,c.t)("snapAccountCreationFailedDescription",f),learnMoreLink:w,error:r}),y(i.MetaMetricsEventName.AccountAddFailed),new Error(`Error occurred while creating snap account: ${r}`)}}finally{k&&y(i.MetaMetricsEventName.AccountAdded),C||e.call("ApprovalController:endFlow",{id:v})}},removeAccount:async(t,n,s)=>{const o=m(n),{id:u}=e.call("ApprovalController:startFlow"),g="https://support.metamask.io/managing-my-wallet/accounts-and-addresses/how-to-remove-an-account-from-your-metamask-wallet/",f=e=>{p({event:e,category:i.MetaMetricsEventCategory.Accounts,properties:{account_type:i.MetaMetricsEventAccountType.Snap,snap_id:n,snap_name:o}})};let y=!1;try{if(y=Boolean(await e.call("ApprovalController:addRequest",{origin:n,type:a.SNAP_MANAGE_ACCOUNTS_CONFIRMATION_TYPES.confirmAccountRemoval,requestData:{publicAddress:t}},!0)),!y)throw await s(y),new Error("User denied account removal");try{await h(t),await s(y),await r(),f(i.MetaMetricsEventName.RemoveSnapAccountSuccessViewed),await(0,d.showError)(e,n,{icon:l.IconName.UserCircleRemove,title:(0,c.t)("snapAccountRemoved")},{message:(0,c.t)("snapAccountRemovedDescription"),learnMoreLink:g}),f(i.MetaMetricsEventName.RemoveSnapAccountSuccessClicked)}catch(t){const r=t.message;throw await(0,d.showError)(e,n,{icon:l.IconName.UserCircleRemove,title:(0,c.t)("snapAccountRemovalFailed")},{message:(0,c.t)("snapAccountRemovalFailedDescription",o),learnMoreLink:g,error:r}),f(i.MetaMetricsEventName.AccountRemoveFailed),new Error(`Error occurred while removing snap account: ${r}`)}}finally{y&&f(i.MetaMetricsEventName.AccountRemoved),e.call("ApprovalController:endFlow",{id:u})}}});return f.type=s.SnapKeyring.type,f}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/snap-keyring.ts"}],[122,{"../keyring-snaps-permissions":119},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isBlockedUrl=void 0;var n=e("../keyring-snaps-permissions");r.isBlockedUrl=async(e,t,r)=>{try{return!(0,n.isProtocolAllowed)(e)||(await t(),r(e).result)}catch(e){return console.error("Invalid URL passed into snap-keyring:",e),!1}}}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/utils/isBlockedUrl.ts"}],[123,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.showSuccess=r.showError=void 0;const n=e=>({name:"SnapAuthorshipHeader",key:"snapHeader",properties:{snapId:e}});r.showError=(e,t,r,s)=>e.call("ApprovalController:showError",{header:[n(t)],title:r.title,icon:r.icon,error:{key:"snapAccountErrorMessage",name:"SnapAccountErrorMessage",properties:s}});r.showSuccess=(e,t,r,s)=>e.call("ApprovalController:showSuccess",{header:[n(t)],title:r.title,icon:r.icon,message:{key:"snapAccountSuccessMessage",name:"SnapAccountSuccessMessage",properties:s}})}}},{package:"$root$",file:"app/scripts/lib/snap-keyring/utils/showResult.ts"}],[125,{"../../../../../shared/lib/four-byte":4995,"@ethersproject/abi":483,"@metamask/utils":2739,"ethereumjs-util":3776},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.decodeTransactionDataWithFourByte=async function(e){const t=e.slice(0,10),r=await(0,i.getMethodFrom4Byte)(t);if(!r)return undefined;const o=r.split("(")[0],d=function(e){let t=e.slice(e.indexOf("(")+1,-1);const r=[];for(;t.includes("(");){const e=u(t);if(!e)break;r.push(e.value),t=`${t.slice(0,e.start)}${r.length-1}#${t.slice(e.end+1)}`}return l(t,r)}(r);a("Generated inputs",d);const h=(0,n.addHexPrefix)(e.slice(10)),p=s.Interface.getAbiCoder().decode(d,h),m=d.map(((e,t)=>c(e,t,p)));return{name:o,params:m}};var n=e("ethereumjs-util"),s=e("@ethersproject/abi"),o=e("@metamask/utils"),i=e("../../../../../shared/lib/four-byte");const a=(0,o.createProjectLogger)("four-byte");function c(e,t,r){var n;const s=r[t],{type:o,name:i}=e;let a=null===(n=e.components)||void 0===n?void 0:n.map(((e,t)=>c(e,t,s)));if(o.endsWith("[]")){const t=o.slice(0,-2);a=s.map(((r,n)=>{const o=`Item ${n+1}`;return c({...e,name:o,type:t},n,s)}))}return{name:i,type:o,value:s,children:a}}function l(e,t){return e.split(",").map((e=>{const r=e.split("#"),n=r.length>1?parseInt(r[0],10):undefined;return{type:n===undefined?e:`tuple${r[1]??""}`,components:n===undefined?undefined:l(t[n],t)}}))}function u(e){let t=-1;for(let r=0;r<e.length;r++)if("("===e[r])t=r;else if(")"===e[r]&&-1!==t)return{start:t,end:r,value:e.slice(t+1,r)};return undefined}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/four-byte.ts"}],[126,{"@metamask/controller-utils":1245,"ethereumjs-util":3776},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getContractProxyAddress=async function(e,t){const r=(await Promise.all(o.map((r=>(0,n.query)(t,"eth_getStorageAt",[e,r,"latest"]))))).find((e=>(0,s.stripHexPrefix)(e)!==i));return r&&(0,s.addHexPrefix)(r.slice(26))};var n=e("@metamask/controller-utils"),s=e("ethereumjs-util");const o=["0x7050c9e0f4ca769c69bd3a8ef740bc37934f8e2c036e5a723fd8ee048ed3f8c3","0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc"],i="0".padEnd(64,"0")}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/proxy.ts"}],[1268,{"@ethersproject/providers":544,"@metamask/base-controller":1235,"@metamask/controller-utils":1275,"@metamask/utils":2739,"punycode/":4527},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,s,o,i=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},a=(e,t,r)=>(i(e,t,"read from private field"),r?r.call(e):t.get(e)),c=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},l=(e,t,r,n)=>(i(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),u=e("@ethersproject/providers"),d=e("@metamask/base-controller"),h=e("@metamask/controller-utils"),p=e("@metamask/utils"),m=e("punycode/"),g=p.createProjectLogger.call(void 0,"ens-controller"),f={1:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",3:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",4:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",5:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",17e3:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",11155111:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},y={ensEntries:{persist:!0,anonymous:!1},ensResolutionsByAddress:{persist:!0,anonymous:!1}},w={ensEntries:{},ensResolutionsByAddress:{}},C=class extends d.BaseController{constructor({registriesByChainId:e=f,messenger:t,state:r={},provider:a,onNetworkDidChange:d}){super({name:"EnsController",metadata:y,messenger:t,state:{...w,ensEntries:Object.fromEntries(Object.entries(e).map((([e,t])=>[h.toHex.call(void 0,e),{".":{address:t,chainId:h.toHex.call(void 0,e),ensName:"."}}]))),...r}}),c(this,s),c(this,n,null),a&&d&&d((t=>{this.resetState();const r=t.providerConfig.chainId;var c,d,p;(c=this,d=s,p=o,i(c,d,"access private method"),p).call(this,r)?l(this,n,new(0,u.Web3Provider)(a,{chainId:h.convertHexToDecimal.call(void 0,r),name:h.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP[r],ensAddress:e[parseInt(r,16)]})):l(this,n,null)}))}resetState(){this.update((e=>{e.ensResolutionsByAddress={}}))}clear(){this.update((e=>{e.ensEntries={}}))}delete(e,t){const r=h.normalizeEnsName.call(void 0,t);return!!(r&&this.state.ensEntries[e]&&this.state.ensEntries[e][r])&&(this.update((t=>{delete t.ensEntries[e][r],0===Object.keys(t.ensEntries[e]).length&&delete t.ensEntries[e]})),!0)}get(e,t){const r=h.normalizeEnsName.call(void 0,t);return r&&this.state.ensEntries[e]&&this.state.ensEntries[e][r]||null}set(e,t,r){if(!Number.isInteger(Number.parseInt(e,10))||!t||"string"!=typeof t||r&&!h.isValidHexAddress.call(void 0,r))throw new Error(`Invalid ENS entry: { chainId:${e}, ensName:${t}, address:${r}}`);const n=h.normalizeEnsName.call(void 0,t);if(!n)throw new Error(`Invalid ENS name: ${t}`);const s=r?h.toChecksumHexAddress.call(void 0,r):null,o=this.state.ensEntries[e];return(!o?.[n]||o[n].address!==s)&&(this.update((t=>{t.ensEntries={...this.state.ensEntries,[e]:{...this.state.ensEntries[e],[n]:{address:s,chainId:e,ensName:n}}}})),!0)}async reverseResolveAddress(e){if(!a(this,n))return;const t=h.toChecksumHexAddress.call(void 0,e);if(this.state.ensResolutionsByAddress[t])return this.state.ensResolutionsByAddress[t];let r,s;try{r=await a(this,n).lookupAddress(t)}catch(e){return void g(e)}if(r){try{s=await a(this,n).resolveName(r)}catch(e){return void g(e)}return s&&"0x0000000000000000000000000000000000000000"!==s&&"0x"!==s&&h.toChecksumHexAddress.call(void 0,s)===t?(this.update((e=>{e.ensResolutionsByAddress[t]=m.toASCII.call(void 0,r)})),r):void 0}}};n=new WeakMap,s=new WeakSet,o=function(e){return Boolean(this.state.ensEntries[e])};var k=C;r.DEFAULT_ENS_NETWORK_MAP=f,r.EnsController=C,r.EnsController_default=k}}},{package:"@metamask/ens-controller",file:"node_modules/@metamask/ens-controller/dist/chunk-S7KH3XXU.js"}],[1269,{"./chunk-S7KH3XXU.js":1268},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-S7KH3XXU.js");r.DEFAULT_ENS_NETWORK_MAP=n.DEFAULT_ENS_NETWORK_MAP,r.EnsController=n.EnsController}}},{package:"@metamask/ens-controller",file:"node_modules/@metamask/ens-controller/dist/index.js"}],[127,{"@ethersproject/abi":483,"@metamask/utils":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.decodeTransactionDataWithSourcify=async function(e,t,r){var a,c;const l=await async function(e,t){var r;const n=await async function(e,t){const r=parseInt(t,16),n=await fetch(`https://sourcify.dev/server/files/any/${r}/${e}`);if(!n.ok)throw new Error("Failed to fetch Sourcify files");return n.json()}(e,t),s=null===(r=n.files)||void 0===r?void 0:r.find((e=>e.name.includes("metadata.json")));if(!s)throw new Error("Metadata not found");return JSON.parse(s.content)}(t,r);s("Retrieved Sourcify metadata",{contractAddress:t,chainId:r,metadata:l});const{abi:u}=l.output,d=new n.Interface(u),h=e.slice(0,10);let p;try{p=d.getFunction(h)}catch(e){}if(!p)return s("Failed to find function in ABI",h,u),undefined;const{name:m,inputs:g}=p,f=i(m,g),y=null===(a=l.output.userdoc)||void 0===a?void 0:a.methods[f],w=null===(c=l.output.devdoc)||void 0===c?void 0:c.methods[f],C=(null==y?void 0:y.notice)??(null==w?void 0:w.details);s("Extracted NatSpec",{signature:f,userDoc:y,devDoc:w});const k=d.decodeFunctionData(h,e),v=g.map(((e,t)=>o(e,t,k,y,w)));return{name:m,description:C,params:v}};var n=e("@ethersproject/abi");const s=(0,e("@metamask/utils").createProjectLogger)("sourcify");function o(e,t,r,n,s){var i,a;const{name:c,type:l,components:u}=e,d=(null==n||null===(i=n.params)||void 0===i?void 0:i[c])??(null==s||null===(a=s.params)||void 0===a?void 0:a[c]),h=r[t];let p=null==u?void 0:u.map(((e,t)=>o(e,t,h,{},{})));if(l.endsWith("[]")){const t=l.slice(0,-2);p=h.map(((r,n)=>{const s=`Item ${n+1}`;return o({...e,name:s,type:t},n,h,{},{})}))}return{name:c,description:d,type:l,value:h,children:p}}function i(e,t){return`${e??""}(${t.map((e=>{var t;return null!==(t=e.components)&&void 0!==t&&t.length?`${i(undefined,e.components)}${e.type.endsWith("[]")?"[]":""}`:e.type})).join(",")})`}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/sourcify.ts"}],[1270,{"@metamask/utils":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@metamask/utils"),s=n.createProjectLogger.call(void 0,"controller-utils");r.createModuleLogger=n.createModuleLogger,r.projectLogger=s}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[1271,{"./chunk-X4PYR7CK.js":1274,"@ethereumjs/util":461,"@metamask/ethjs-unit":1440,"@metamask/utils":2739,"bn.js":3472,buffer:3520,"eth-ens-namehash":3712,"fast-deep-equal":3842},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=e("./chunk-X4PYR7CK.js"),o=e("@ethereumjs/util"),i=e("@metamask/ethjs-unit"),a=e("@metamask/utils"),c=n(e("bn.js")),l=n(e("eth-ens-namehash")),u=n(e("fast-deep-equal")),d=new Error("timeout"),h=["__proto__","constructor","prototype"];function p(e){return e?new(0,c.default)(a.remove0x.call(void 0,e),16):new(0,c.default)(0)}async function m(e,t){const r=await fetch(e,t);if(!r.ok)throw new Error(`Fetch failed with status '${r.status}' for request '${String(e)}'`);return r}async function g(e,t){const r=await m(e,t);return await r.json()}r.PROTOTYPE_POLLUTION_BLOCKLIST=h,r.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},r.isSafeChainId=function(e){if(!a.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,a.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=s.MAX_SAFE_CHAIN_ID},r.BNToHex=function(e){return a.add0x.call(void 0,e.toString(16))},r.fractionBN=function(e,t,r){const n=new(0,c.default)(t),s=new(0,c.default)(r);return e.mul(n).div(s)},r.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,c.default)(0);const t=e.toString().split("."),r=t[0]||"0";let n=t[1]||"";if(!n)return i.toWei.call(void 0,r,"gwei");if(n.length<=9)return i.toWei.call(void 0,`${r}.${n}`,"gwei");const s=n.slice(9)[0];n=n.slice(0,9);let o=i.toWei.call(void 0,`${r}.${n}`,"gwei");return Number(s)>=5&&(o=o.add(new(0,c.default)(1))),o},r.weiHexToGweiDec=function(e){const t=new(0,c.default)(a.remove0x.call(void 0,e),16);return i.fromWei.call(void 0,t,"gwei")},r.getBuyURL=function(e="1",t,r=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${r}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},r.hexToBN=p,r.hexToText=function(e){try{const r=a.remove0x.call(void 0,e);return t.from(r,"hex").toString("utf8")}catch(t){return e}},r.fromHex=function(e){return c.default.isBN(e)?e:new(0,c.default)(p(e).toString(10))},r.toHex=function(e){return"string"==typeof e&&a.isStrictHexString.call(void 0,e)?e:`0x${c.default.isBN(e)?e.toString(16):new(0,c.default)(e.toString(),10).toString(16)}`},r.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},r.safelyExecuteWithTimeout=async function(e,t=!1,r=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))])}catch(e){return void(t&&console.error(e))}},r.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=a.add0x.call(void 0,e);return a.isHexString.call(void 0,t)?o.toChecksumAddress.call(void 0,t):t},r.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const r=t?a.add0x.call(void 0,e):e;return!!a.isStrictHexString.call(void 0,r)&&o.isValidAddress.call(void 0,r)},r.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},r.successfulFetch=m,r.handleFetch=g,r.fetchWithErrorHandling=async function({url:e,options:t,timeout:r,errorCodesToCatch:n}){let s;try{s=r?Promise.race([await g(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))]):await g(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==d)throw e;console.error(e)}(e,n)}return s},r.timeoutFetch=async function(e,t,r=500){return Promise.race([m(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))])},r.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=l.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},r.query=function(e,t,r=[]){return new Promise(((n,s)=>{const o=(e,t)=>{e?s(e):n(t)};t in e&&"function"==typeof e[t]?e[t](...r,o):e.sendAsync({method:t,params:r},o)}))},r.convertHexToDecimal=(e="0x0")=>a.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,r.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isValidJson=function(e){try{return u.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/chunk-EDY72VWL.js"}],[1272,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},s={...n,rpc:"rpc"};var o=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(o||{}),i={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},a=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(a||{});r.InfuraNetworkType=n,r.NetworkType=s,r.isNetworkType=function(e){return Object.values(s).includes(e)},r.isInfuraNetworkType=function(e){return Object.keys(n).includes(e)},r.BuiltInNetworkName=o,r.ChainId=i,r.NetworksTicker=a}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[1273,{"./chunk-DBJSLKNR.js":1270,"@metamask/utils":2739,"@spruceid/siwe-parser":3010,buffer:3520},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-DBJSLKNR.js"),s=e("@metamask/utils"),o=e("@spruceid/siwe-parser"),i=n.createModuleLogger.call(void 0,n.projectLogger,"detect-siwe");function a(e){try{const n="string"!=typeof(r=e)?r:s.remove0x.call(void 0,r),o=t.from(n,"hex");return 32===o.length?e:o.toString("utf8")}catch(t){return i(t),e}var r}var c={"http:":"80","https:":"443"},l=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);r.parseDomainParts=l,r.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:r}=e;if(!t||!r?.parsedMessage?.domain)return!1;const n=new URL(t),s=l(r.parsedMessage.domain,n.protocol);return 0===s.hostname.localeCompare(n.hostname,void 0,{sensitivity:"accent"})&&(""!==s.port&&s.port!==n.port?""===n.port&&s.port===c[n.protocol]:""===s.username||s.username===n.username)}catch(e){return i(e),!1}},r.detectSIWE=e=>{try{const{data:t}=e,r=a(t);return{isSIWEMessage:!0,parsedMessage:new(0,o.ParsedMessage)(r)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[1274,{"./chunk-LGGBBU6G.js":1272},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-LGGBBU6G.js"),s={[n.NetworkType.goerli]:{chainId:n.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.goerli}.etherscan.io`}},[n.NetworkType.sepolia]:{chainId:n.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.sepolia}.etherscan.io`}},[n.NetworkType.mainnet]:{chainId:n.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[n.NetworkType["linea-goerli"]]:{chainId:n.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[n.NetworkType["linea-sepolia"]]:{chainId:n.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[n.NetworkType["linea-mainnet"]]:{chainId:n.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[n.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},o=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSign="eth_sign",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(o||{}),i={[n.ChainId.goerli]:"goerli",[n.ChainId.sepolia]:"sepolia",[n.ChainId.mainnet]:"mainnet",[n.ChainId["linea-goerli"]]:"linea-goerli",[n.ChainId["linea-sepolia"]]:"linea-sepolia",[n.ChainId["linea-mainnet"]]:"linea-mainnet",[n.ChainId.aurora]:"aurora"};r.RPC="rpc",r.FALL_BACK_VS_CURRENCY="ETH",r.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",r.GANACHE_CHAIN_ID="0x539",r.MAX_SAFE_CHAIN_ID=0xfffffffffffec,r.ERC721="ERC721",r.ERC1155="ERC1155",r.ERC20="ERC20",r.ERC721_INTERFACE_ID="0x80ac58cd",r.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",r.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",r.ERC1155_INTERFACE_ID="0xd9b67a26",r.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",r.GWEI="gwei",r.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},r.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},r.BUILT_IN_NETWORKS=s,r.OPENSEA_PROXY_URL="https://proxy.metafi.codefi.network/opensea/v1/api/v2",r.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",r.ORIGIN_METAMASK="metamask",r.ApprovalType=o,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=i}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/chunk-X4PYR7CK.js"}],[1275,{"./chunk-DBJSLKNR.js":1270,"./chunk-EDY72VWL.js":1271,"./chunk-LGGBBU6G.js":1272,"./chunk-M6G3ISXG.js":1273,"./chunk-X4PYR7CK.js":1274},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var s=e("./chunk-EDY72VWL.js"),o=e("./chunk-X4PYR7CK.js"),i=e("./chunk-LGGBBU6G.js");r.ASSET_TYPES=o.ASSET_TYPES,r.ApprovalType=o.ApprovalType,r.BNToHex=s.BNToHex,r.BUILT_IN_NETWORKS=o.BUILT_IN_NETWORKS,r.BuiltInNetworkName=i.BuiltInNetworkName,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=o.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,r.ChainId=i.ChainId,r.ERC1155=o.ERC1155,r.ERC1155_INTERFACE_ID=o.ERC1155_INTERFACE_ID,r.ERC1155_METADATA_URI_INTERFACE_ID=o.ERC1155_METADATA_URI_INTERFACE_ID,r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=o.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,r.ERC20=o.ERC20,r.ERC721=o.ERC721,r.ERC721_ENUMERABLE_INTERFACE_ID=o.ERC721_ENUMERABLE_INTERFACE_ID,r.ERC721_INTERFACE_ID=o.ERC721_INTERFACE_ID,r.ERC721_METADATA_INTERFACE_ID=o.ERC721_METADATA_INTERFACE_ID,r.FALL_BACK_VS_CURRENCY=o.FALL_BACK_VS_CURRENCY,r.GANACHE_CHAIN_ID=o.GANACHE_CHAIN_ID,r.GWEI=o.GWEI,r.IPFS_DEFAULT_GATEWAY_URL=o.IPFS_DEFAULT_GATEWAY_URL,r.InfuraNetworkType=i.InfuraNetworkType,r.MAX_SAFE_CHAIN_ID=o.MAX_SAFE_CHAIN_ID,r.NFT_API_BASE_URL=o.NFT_API_BASE_URL,r.NetworkType=i.NetworkType,r.NetworksTicker=i.NetworksTicker,r.OPENSEA_PROXY_URL=o.OPENSEA_PROXY_URL,r.ORIGIN_METAMASK=o.ORIGIN_METAMASK,r.RPC=o.RPC,r.TESTNET_TICKER_SYMBOLS=o.TESTNET_TICKER_SYMBOLS,r.convertHexToDecimal=s.convertHexToDecimal,r.detectSIWE=n.detectSIWE,r.fetchWithErrorHandling=s.fetchWithErrorHandling,r.fractionBN=s.fractionBN,r.fromHex=s.fromHex,r.getBuyURL=s.getBuyURL,r.gweiDecToWEIBN=s.gweiDecToWEIBN,r.handleFetch=s.handleFetch,r.hexToBN=s.hexToBN,r.hexToText=s.hexToText,r.isInfuraNetworkType=i.isInfuraNetworkType,r.isNetworkType=i.isNetworkType,r.isNonEmptyArray=s.isNonEmptyArray,r.isPlainObject=s.isPlainObject,r.isSafeChainId=s.isSafeChainId,r.isSafeDynamicKey=s.isSafeDynamicKey,r.isSmartContractCode=s.isSmartContractCode,r.isValidHexAddress=s.isValidHexAddress,r.isValidJson=s.isValidJson,r.isValidSIWEOrigin=n.isValidSIWEOrigin,r.normalizeEnsName=s.normalizeEnsName,r.parseDomainParts=n.parseDomainParts,r.query=s.query,r.safelyExecute=s.safelyExecute,r.safelyExecuteWithTimeout=s.safelyExecuteWithTimeout,r.successfulFetch=s.successfulFetch,r.timeoutFetch=s.timeoutFetch,r.toChecksumHexAddress=s.toChecksumHexAddress,r.toHex=s.toHex,r.weiHexToGweiDec=s.weiHexToGweiDec}}},{package:"@metamask/ens-controller>@metamask/controller-utils",file:"node_modules/@metamask/ens-controller/node_modules/@metamask/controller-utils/dist/index.js"}],[128,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.UNISWAP_ROUTER_COMMANDS=void 0;r.UNISWAP_ROUTER_COMMANDS={0:{name:"V3_SWAP_EXACT_IN",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of input tokens for the trade",name:"amountIn"},{type:"uint256",description:"The minimum amount of output tokens the user wants",name:"amountOutMin"},{type:"bytes",description:"The UniswapV3 encoded path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},1:{name:"V3_SWAP_EXACT_OUT",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of output tokens to receive",name:"amountOut"},{type:"uint256",description:"The maximum number of input tokens that should be spent",name:"amountInMax"},{type:"bytes",description:"The UniswapV3 encoded path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},2:{name:"PERMIT2_TRANSFER_FROM",params:[{type:"address",description:"The token to fetch from Permit2",name:"token"},{type:"address",description:"The recipient of the tokens fetched",name:"recipient"},{type:"uint256",description:"The amount of token to fetch",name:"amount"}]},3:{name:"PERMIT2_PERMIT_BATCH",params:[{type:"bytes",description:"A PermitBatch struct outlining all of the Permit2 permits to execute.",name:"batch"},{type:"bytes",description:"The signature to provide to Permit2",name:"data"}]},4:{name:"SWEEP",params:[{type:"address",description:"The ERC20 token to sweep (or Constants.ETH for ETH)",name:"token"},{type:"address",description:"The recipient of the sweep",name:"recipient"},{type:"uint256",description:"The minimum required tokens to receive from the sweep",name:"amountMin"}]},5:{name:"TRANSFER",params:[{type:"address",description:"The ERC20 token to transfer (or Constants.ETH for ETH)",name:"token"},{type:"address",description:"The recipient of the transfer",name:"recipient"},{type:"uint256",description:"The amount to transfer",name:"value"}]},6:{name:"PAY_PORTION",params:[{type:"address",description:"The ERC20 token to transfer (or Constants.ETH for ETH)",name:"token"},{type:"address",description:"The recipient of the transfer",name:"recipient"},{type:"uint256",description:"In basis points, the percentage of the contract’s balance to transfer",name:"bips"}]},8:{name:"V2_SWAP_EXACT_IN",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of input tokens for the trade",name:"amountIn"},{type:"uint256",description:"The minimum amount of output tokens the user wants",name:"amountOutMin"},{type:"address[]",description:"The UniswapV2 token path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},9:{name:"V2_SWAP_EXACT_OUT",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of output tokens to receive",name:"amountOut"},{type:"uint256",description:"The maximum number of input tokens that should be spent",name:"amountInMax"},{type:"address[]",description:"The UniswapV2 token path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},10:{name:"PERMIT2_PERMIT",params:[{type:"bytes",description:"A PermitSingle struct outlining the Permit2 permit to execute",name:"permitSingle"},{type:"bytes",description:"The signature to provide to Permit2",name:"signature"}]},11:{name:"WRAP_ETH",params:[{type:"address",description:"The recipient of the WETH",name:"recipient"},{type:"uint256",description:"The amount of ETH to wrap",name:"amountMin"}]},12:{name:"UNWRAP_WETH",params:[{type:"address",description:"The recipient of the ETH",name:"recipient"},{type:"uint256",description:"The minimum required ETH to receive from the unwrapping",name:"amountMin"}]},13:{name:"PERMIT2_TRANSFER_FROM_BATCH",params:[{type:"bytes",description:"An array of AllowanceTransferDetails structs that each describe a Permit2 transfer to perform",name:"batchDetails"}]},16:{name:"SEAPORT",params:[{type:"uint256",description:"The ETH value to forward to the Seaport contract",name:"value"},{type:"bytes",description:"The calldata to use to call the Seaport contract",name:"data"}]},17:{name:"LOOKS_RARE_721",params:[{type:"uint256",description:"The ETH value to forward to the LooksRare contract",name:"value"},{type:"bytes",description:"The calldata to use to call the LooksRare contract",name:"data"},{type:"address",description:"The recipient of the ERC721",name:"recipient"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},18:{name:"NFTX",params:[{type:"uint256",description:"The ETH value to forward to the NFTX contract",name:"value"},{type:"bytes",description:"The calldata to use to call the NFTX contract",name:"data"}]},19:{name:"CRYPTOPUNKS",params:[{type:"uint256",description:"The PunkID to purchase",name:"punkId"},{type:"address",description:"The recipient for the cryptopunk",name:"recipient"},{type:"uint256",description:"The ETH value to forward to the Cryptopunks contract",name:"value"}]},20:{name:"LOOKS_RARE_1155",params:[{type:"uint256",description:"The ETH value to forward to the LooksRare contract",name:"value"},{type:"bytes",description:"The calldata to use to call the LooksRare contract",name:"data"},{type:"address",description:"The recipient of the ERC1155",name:"recipient"},{type:"address",description:"The ERC1155 token address",name:"token"},{type:"uint256",description:"The ID of the ERC1155",name:"id"},{type:"uint256",description:"The amount of the ERC1155 to transfer",name:"amount"}]},21:{name:"OWNER_CHECK_721",params:[{type:"address",description:"The required owner of the ERC721",name:"owner"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},22:{name:"OWNER_CHECK_1155",params:[{type:"address",description:"The required owner of the ERC1155",name:"owner"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC1155",name:"id"},{type:"uint256",description:"The minimum required amount of the ERC1155",name:"minBalance"}]},23:{name:"SWEEP_ERC721",params:[{type:"address",description:"The ERC721 token address to transfer",name:"token"},{type:"address",description:"The recipient of the transfer",name:"recipient"},{type:"uint256",description:"The token ID to transfer",name:"id"}]},24:{name:"X2Y2_721",params:[{type:"uint256",description:"The ETH value to forward to the X2Y2 contract",name:"value"},{type:"bytes",description:"The calldata to use to call the X2Y2 contract",name:"data"},{type:"address",description:"The recipient of the ERC721",name:"recipient"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},25:{name:"SUDOSWAP",params:[{type:"uint256",description:"The ETH value to forward to the Sudoswap contract",name:"value"},{type:"bytes",description:"The calldata to use to call the Sudoswap contract",name:"data"}]},26:{name:"NFT20",params:[{type:"uint256",description:"The ETH value to forward to the NFT20 contract",name:"value"},{type:"bytes",description:"The calldata to use to call the NFT20 contract",name:"data"}]},27:{name:"X2Y2_1155",params:[{type:"uint256",description:"The ETH value to forward to the X2Y2 contract",name:"value"},{type:"bytes",description:"The calldata to use to call the X2Y2 contract",name:"data"},{type:"address",description:"The recipient of the ERC1155",name:"recipient"},{type:"address",description:"The ERC1155 token address",name:"token"},{type:"uint256",description:"The ID of the ERC1155",name:"id"},{type:"uint256",description:"The amount of the ERC1155 to transfer",name:"amount"}]},28:{name:"FOUNDATION",params:[{type:"uint256",description:"The ETH value to forward to the Foundation contract",name:"value"},{type:"bytes",description:"The calldata to use to call the Foundation contract",name:"data"},{type:"address",description:"The recipient of the ERC721",name:"recipient"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},29:{name:"SWEEP_ERC1155",params:[{type:"address",description:"The ERC1155 token address to sweep",name:"token"},{type:"address",description:"The recipient of the sweep",name:"recipient"},{type:"uint256",description:"The token ID to sweep",name:"id"},{type:"uint256",description:"The minimum required tokens to receive from the sweep",name:"amount"}]}}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/uniswap-commands.ts"}],[1282,{"./base-filter":1283},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("./base-filter");t.exports=class extends n{constructor(){super(),this.allResults=[]}async update(){throw new Error("BaseFilterWithHistory - no update method specified")}addResults(e){this.allResults=this.allResults.concat(e),super.addResults(e)}addInitialResults(e){this.allResults=this.allResults.concat(e),super.addInitialResults(e)}getAllResults(){return this.allResults}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/base-filter-history.js"}],[1283,{"@metamask/safe-event-emitter":1906},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("@metamask/safe-event-emitter").default;t.exports=class extends n{constructor(){super(),this.updates=[]}async initialize(){}async update(){throw new Error("BaseFilter - no update method specified")}addResults(e){this.updates=this.updates.concat(e),e.forEach((e=>this.emit("update",e)))}addInitialResults(e){}getChangesAndClear(){const e=this.updates;return this.updates=[],e}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/base-filter.js"}],[1284,{"./base-filter":1283,"./getBlocksForRange":1285,"./hexUtils":1286},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("./base-filter"),s=e("./getBlocksForRange"),{incrementHexInt:o}=e("./hexUtils");t.exports=class extends n{constructor({provider:e,params:t}){super(),this.type="block",this.provider=e}async update({oldBlock:e,newBlock:t}){const r=t,n=o(e),i=(await s({provider:this.provider,fromBlock:n,toBlock:r})).map((e=>e.hash));this.addResults(i)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/block-filter.js"}],[1285,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){return e===undefined||null===e?e:Number.parseInt(e,16)}function s(e){if(e===undefined||null===e)return e;return"0x"+e.toString(16)}function o(e,t){return new Promise(((r,n)=>{e.sendAsync(t,((e,t)=>{e?n(e):t.error?n(t.error):t.result?r(t.result):n(new Error("Result was empty"))}))}))}t.exports=async function({provider:e,fromBlock:t,toBlock:r}){t||(t=r);const i=n(t),a=n(r),c=Array(a-i+1).fill().map(((e,t)=>i+t)).map(s);let l=await Promise.all(c.map((t=>async function(e,t,r){for(let n=0;n<3;n++)try{return await o(e,{id:1,jsonrpc:"2.0",method:t,params:r})}catch(e){console.error(`provider.sendAsync failed: ${e.stack||e.message||e}`)}return null}(e,"eth_getBlockByNumber",[t,!1]))));return l=l.filter((e=>null!==e)),l}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/getBlocksForRange.js"}],[1286,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){return e.sort(((e,t)=>"latest"===e||"earliest"===t?1:"latest"===t||"earliest"===e?-1:s(e)-s(t)))}function s(e){return e===undefined||null===e?e:Number.parseInt(e,16)}function o(e){if(e===undefined||null===e)return e;let t=e.toString(16);return t.length%2&&(t="0"+t),"0x"+t}function i(){return Math.floor(16*Math.random()).toString(16)}t.exports={minBlockRef:function(...e){return n(e)[0]},maxBlockRef:function(...e){const t=n(e);return t[t.length-1]},sortBlockRefs:n,bnToHex:function(e){return"0x"+e.toString(16)},blockRefIsNumber:function(e){return e&&!["earliest","latest","pending"].includes(e)},hexToInt:s,incrementHexInt:function(e){if(e===undefined||null===e)return e;return o(s(e)+1)},intToHex:o,unsafeRandomBytes:function(e){let t="0x";for(let r=0;r<e;r++)t+=i(),t+=i();return t}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/hexUtils.js"}],[1287,{"./block-filter.js":1284,"./hexUtils":1286,"./log-filter.js":1288,"./tx-filter.js":1302,"@metamask/json-rpc-engine":1295,"async-mutex":1299},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("async-mutex").Mutex,{createAsyncMiddleware:s,createScaffoldMiddleware:o}=e("@metamask/json-rpc-engine"),i=e("./log-filter.js"),a=e("./block-filter.js"),c=e("./tx-filter.js"),{intToHex:l,hexToInt:u}=e("./hexUtils");function d(e){return h((async(...t)=>{const r=await e(...t);return l(r.id)}))}function h(e){return s((async(t,r)=>{const n=await e.apply(null,t.params);r.result=n}))}function p(e,t){const r=[];for(let t in e)r.push(e[t]);return r}t.exports=function({blockTracker:e,provider:t}){let r=0,s={};const m=new n,g=function({mutex:e}){return t=>async(r,n,s,o)=>{(await e.acquire())(),t(r,n,s,o)}}({mutex:m}),f=o({eth_newFilter:g(d(w)),eth_newBlockFilter:g(d(C)),eth_newPendingTransactionFilter:g(d(k)),eth_uninstallFilter:g(h(S)),eth_getFilterChanges:g(h(v)),eth_getFilterLogs:g(h(b))}),y=async({oldBlock:e,newBlock:t})=>{if(0===s.length)return;const r=await m.acquire();try{await Promise.all(p(s).map((async r=>{try{await r.update({oldBlock:e,newBlock:t})}catch(e){console.error(e)}})))}catch(e){console.error(e)}r()};return f.newLogFilter=w,f.newBlockFilter=C,f.newPendingTransactionFilter=k,f.uninstallFilter=S,f.getFilterChanges=v,f.getFilterLogs=b,f.destroy=()=>{!async function(){const e=p(s).length;s={},_({prevFilterCount:e,newFilterCount:0})}()},f;async function w(e){const r=new i({provider:t,params:e});await T(r);return r}async function C(){const e=new a({provider:t});await T(e);return e}async function k(){const e=new c({provider:t});await T(e);return e}async function v(e){const t=u(e),r=s[t];if(!r)throw new Error(`No filter for index "${t}"`);return r.getChangesAndClear()}async function b(e){const t=u(e),r=s[t];if(!r)throw new Error(`No filter for index "${t}"`);let n=[];return"log"===r.type&&(n=r.getAllResults()),n}async function S(e){const t=u(e),r=s[t],n=Boolean(r);return n&&await async function(e){const t=p(s).length;delete s[e];const r=p(s).length;_({prevFilterCount:t,newFilterCount:r})}(t),n}async function T(t){const n=p(s).length,o=await e.getLatestBlock();await t.initialize({currentBlock:o}),r++,s[r]=t,t.id=r,t.idHex=l(r);return _({prevFilterCount:n,newFilterCount:p(s).length}),r}function _({prevFilterCount:t,newFilterCount:r}){0===t&&r>0?e.on("sync",y):t>0&&0===r&&e.removeListener("sync",y)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/index.js"}],[1288,{"./base-filter-history":1282,"./hexUtils":1286,"@metamask/eth-query":1289,pify:4458},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("@metamask/eth-query"),s=e("pify"),o=e("./base-filter-history"),{bnToHex:i,hexToInt:a,incrementHexInt:c,minBlockRef:l,blockRefIsNumber:u}=e("./hexUtils");t.exports=class extends o{constructor({provider:e,params:t}){super(),this.type="log",this.ethQuery=new n(e),this.params=Object.assign({fromBlock:"latest",toBlock:"latest",address:undefined,topics:[]},t),this.params.address&&(Array.isArray(this.params.address)||(this.params.address=[this.params.address]),this.params.address=this.params.address.map((e=>e.toLowerCase())))}async initialize({currentBlock:e}){let t=this.params.fromBlock;["latest","pending"].includes(t)&&(t=e),"earliest"===t&&(t="0x0"),this.params.fromBlock=t;const r=l(this.params.toBlock,e),n=Object.assign({},this.params,{toBlock:r}),s=await this._fetchLogs(n);this.addInitialResults(s)}async update({oldBlock:e,newBlock:t}){const r=t;let n;n=e?c(e):t;const s=Object.assign({},this.params,{fromBlock:n,toBlock:r}),o=(await this._fetchLogs(s)).filter((e=>this.matchLog(e)));this.addResults(o)}async _fetchLogs(e){return await s((t=>this.ethQuery.getLogs(e,t)))()}matchLog(e){if(a(this.params.fromBlock)>=a(e.blockNumber))return!1;if(u(this.params.toBlock)&&a(this.params.toBlock)<=a(e.blockNumber))return!1;const t=e.address&&e.address.toLowerCase();if(this.params.address&&t&&!this.params.address.includes(t))return!1;return this.params.topics.every(((t,r)=>{let n=e.topics[r];if(!n)return!1;n=n.toLowerCase();let s=Array.isArray(t)?t:[t];if(s.includes(null))return!0;s=s.map((e=>e.toLowerCase()));return s.includes(n)}))}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/log-filter.js"}],[1289,{"json-rpc-random-id":4172,xtend:4947},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("json-rpc-random-id")(),s=e("xtend");function o(e){this.currentProvider=e}function i(e){return function(...t){const r=t.pop();this.sendAsync({method:e,params:t},r)}}function a(e,t){return function(...r){const n=r.pop();r.length<e&&r.push("latest"),this.sendAsync({method:t,params:r},n)}}t.exports=o,o.prototype.getBalance=a(2,"eth_getBalance"),o.prototype.getCode=a(2,"eth_getCode"),o.prototype.getTransactionCount=a(2,"eth_getTransactionCount"),o.prototype.getStorageAt=a(3,"eth_getStorageAt"),o.prototype.call=a(2,"eth_call"),o.prototype.protocolVersion=i("eth_protocolVersion"),o.prototype.syncing=i("eth_syncing"),o.prototype.coinbase=i("eth_coinbase"),o.prototype.mining=i("eth_mining"),o.prototype.hashrate=i("eth_hashrate"),o.prototype.gasPrice=i("eth_gasPrice"),o.prototype.accounts=i("eth_accounts"),o.prototype.blockNumber=i("eth_blockNumber"),o.prototype.getBlockTransactionCountByHash=i("eth_getBlockTransactionCountByHash"),o.prototype.getBlockTransactionCountByNumber=i("eth_getBlockTransactionCountByNumber"),o.prototype.getUncleCountByBlockHash=i("eth_getUncleCountByBlockHash"),o.prototype.getUncleCountByBlockNumber=i("eth_getUncleCountByBlockNumber"),o.prototype.sign=i("eth_sign"),o.prototype.sendTransaction=i("eth_sendTransaction"),o.prototype.sendRawTransaction=i("eth_sendRawTransaction"),o.prototype.estimateGas=i("eth_estimateGas"),o.prototype.getBlockByHash=i("eth_getBlockByHash"),o.prototype.getBlockByNumber=i("eth_getBlockByNumber"),o.prototype.getTransactionByHash=i("eth_getTransactionByHash"),o.prototype.getTransactionByBlockHashAndIndex=i("eth_getTransactionByBlockHashAndIndex"),o.prototype.getTransactionByBlockNumberAndIndex=i("eth_getTransactionByBlockNumberAndIndex"),o.prototype.getTransactionReceipt=i("eth_getTransactionReceipt"),o.prototype.getUncleByBlockHashAndIndex=i("eth_getUncleByBlockHashAndIndex"),o.prototype.getUncleByBlockNumberAndIndex=i("eth_getUncleByBlockNumberAndIndex"),o.prototype.getCompilers=i("eth_getCompilers"),o.prototype.compileLLL=i("eth_compileLLL"),o.prototype.compileSolidity=i("eth_compileSolidity"),o.prototype.compileSerpent=i("eth_compileSerpent"),o.prototype.newFilter=i("eth_newFilter"),o.prototype.newBlockFilter=i("eth_newBlockFilter"),o.prototype.newPendingTransactionFilter=i("eth_newPendingTransactionFilter"),o.prototype.uninstallFilter=i("eth_uninstallFilter"),o.prototype.getFilterChanges=i("eth_getFilterChanges"),o.prototype.getFilterLogs=i("eth_getFilterLogs"),o.prototype.getLogs=i("eth_getLogs"),o.prototype.getWork=i("eth_getWork"),o.prototype.submitWork=i("eth_submitWork"),o.prototype.submitHashrate=i("eth_submitHashrate"),o.prototype.sendAsync=function(e,t){var r;this.currentProvider.sendAsync((r=e,s({id:n(),jsonrpc:"2.0",params:[]},r)),(function(e,r){let n=e;return!e&&r.error&&(n=new Error(`EthQuery - RPC Error - ${r.error.message}`)),n?t(n):t(null,r.result)}))}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/eth-query",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/eth-query/index.js"}],[129,{"../../../../../shared/constants/network":4977,"./uniswap-commands":128,"@ethersproject/abi":483,"ethereumjs-util":3776},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.UNISWAP_UNIVERSAL_ROUTER_ADDRESSES=void 0,r.decodeUniswapRouterTransactionData=function({transactionData:e,contractAddress:t,chainId:r}){const o=l[r];if(null==o||!o.map((e=>e.toLowerCase())).includes(t.toLowerCase()))return undefined;const d=new n.Interface(u);let h;try{h=d.parseTransaction({data:e})}catch(e){return undefined}const p=h.args.commands,m=h.args.inputs;return p.slice(2).match(/.{1,2}/gu).map(((e,t)=>function(e,t){const r=parseInt(e,16),o=31&r,l=i.UNISWAP_ROUTER_COMMANDS[String(o)];if(!l)return undefined;const u=l.params.map((e=>e.type)),d=n.Interface.getAbiCoder().decode(u,t),{name:h}=l,p=l.params.map(((e,t)=>{const{name:r,type:n,description:o}=e,i=d[t];return{name:r,type:n,value:"path"===r?function(e){const t=[];let r=(0,s.stripHexPrefix)(e),n={},o=!0;for(;r.length;){if(o){const e=(0,s.addHexPrefix)(r.slice(0,a));n.firstAddress?(n.secondAddress=e,t.push(n),n={firstAddress:e}):n.firstAddress=e,r=r.slice(a)}else n.tickSpacing=parseInt(r.slice(0,c),16),r=r.slice(c);o=!o}return t}(i):i,description:o}}));return{name:h,params:p}}(e,m[t]))).filter((e=>e!==undefined))};var n=e("@ethersproject/abi"),s=e("ethereumjs-util"),o=e("../../../../../shared/constants/network"),i=e("./uniswap-commands");const a=40,c=6,l=r.UNISWAP_UNIVERSAL_ROUTER_ADDRESSES={[o.CHAIN_IDS.ARBITRUM]:["0x4C60051384bd2d3C01bfc845Cf5F4b44bcbE9de5","0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0x5E325eDA8064b456f4781070C0738d849c824258"],[o.CHAIN_IDS.AVALANCHE]:["0x82635AF6146972cD6601161c4472ffe97237D292","0x4Dae2f939ACf50408e13d58534Ff8c2776d45265"],[o.CHAIN_IDS.BASE]:["0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD"],[o.CHAIN_IDS.BSC]:["0x5Dc88340E1c5c6366864Ee415d6034cadd1A9897","0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0x4Dae2f939ACf50408e13d58534Ff8c2776d45265"],[o.CHAIN_IDS.MAINNET]:["0xEf1c6E67703c7BD7107eed8303Fbe6EC2554BF6B","0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD"],[o.CHAIN_IDS.OPTIMISM]:["0xb555edF5dcF85f42cEeF1f3630a52A108E55A654","0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0xCb1355ff08Ab38bBCE60111F1bb2B784bE25D7e8"],[o.CHAIN_IDS.POLYGON]:["0x4C60051384bd2d3C01bfc845Cf5F4b44bcbE9de5","0x643770E279d5D0733F21d6DC03A8efbABf3255B4","0xec7BE89e9d109e7e3Fec59c222CF297125FEFda2"],[o.CHAIN_IDS.SEPOLIA]:["0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD"]},u=[{constant:!0,inputs:[{name:"commands",type:"bytes"},{name:"inputs",type:"bytes[]"},{name:"deadline",type:"uint256"}],name:"execute",type:"function"},{constant:!0,inputs:[{name:"commands",type:"bytes"},{name:"inputs",type:"bytes[]"}],name:"execute",type:"function"}]}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/uniswap.ts"}],[1290,{"@metamask/rpc-errors":1884,"@metamask/safe-event-emitter":1906,"@metamask/utils":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,o,i,a,c,l,u,d,h,p,m,g,f=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,o){function i(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}c((n=n.apply(e,t||[])).next())}))},y=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},w=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},C=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.JsonRpcEngine=void 0;const k=e("@metamask/rpc-errors"),v=C(e("@metamask/safe-event-emitter")),b=e("@metamask/utils");class S extends v.default{constructor({notificationHandler:e}={}){super(),n.add(this),o.set(this,!1),i.set(this,void 0),a.set(this,void 0),y(this,i,[],"f"),y(this,a,e,"f")}destroy(){w(this,i,"f").forEach((e=>{"destroy"in e&&"function"==typeof e.destroy&&e.destroy()})),y(this,i,[],"f"),y(this,o,!0,"f")}push(e){w(this,n,"m",c).call(this),w(this,i,"f").push(e)}handle(e,t){if(w(this,n,"m",c).call(this),t&&"function"!=typeof t)throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?w(this,n,"m",l).call(this,e,t):w(this,n,"m",l).call(this,e):t?w(this,n,"m",u).call(this,e,t):this._promiseHandle(e)}asMiddleware(){return w(this,n,"m",c).call(this),(e,t,r,n)=>f(this,void 0,void 0,(function*(){try{const[o,a,c]=yield w(S,s,"m",h).call(S,e,t,w(this,i,"f"));return a?(yield w(S,s,"m",m).call(S,c),n(o)):r((e=>f(this,void 0,void 0,(function*(){try{yield w(S,s,"m",m).call(S,c)}catch(t){return e(t)}return e()}))))}catch(e){return n(e)}}))}_promiseHandle(e){return f(this,void 0,void 0,(function*(){return new Promise(((t,r)=>{w(this,n,"m",u).call(this,e,((e,n)=>{e&&n===undefined?r(e):t(n)})).catch(r)}))}))}}function T(e){return JSON.stringify(e,null,2)}r.JsonRpcEngine=S,s=S,o=new WeakMap,i=new WeakMap,a=new WeakMap,n=new WeakSet,c=function(){if(w(this,o,"f"))throw new Error("This engine is destroyed and can no longer be used.")},l=function(e,t){return f(this,void 0,void 0,(function*(){try{if(0===e.length){const e=[{id:null,jsonrpc:"2.0",error:new k.JsonRpcError(k.errorCodes.rpc.invalidRequest,"Request batch must contain plain objects. Received an empty array")}];return t?t(null,e):e}const r=(yield Promise.all(e.map(this._promiseHandle.bind(this)))).filter((e=>e!==undefined));return t?t(null,r):r}catch(e){if(t)return t(e);throw e}}))},u=function(e,t){var r;return f(this,void 0,void 0,(function*(){if(!e||Array.isArray(e)||"object"!=typeof e){const r=new k.JsonRpcError(k.errorCodes.rpc.invalidRequest,"Requests must be plain objects. Received: "+typeof e,{request:e});return t(r,{id:null,jsonrpc:"2.0",error:r})}if("string"!=typeof e.method){const n=new k.JsonRpcError(k.errorCodes.rpc.invalidRequest,"Must specify a string method. Received: "+typeof e.method,{request:e});return w(this,a,"f")&&!(0,b.isJsonRpcRequest)(e)?t(null):t(n,{id:null!==(r=e.id)&&void 0!==r?r:null,jsonrpc:"2.0",error:n})}if(w(this,a,"f")&&!(0,b.isJsonRpcRequest)(e)){try{yield w(this,a,"f").call(this,e)}catch(n){return t(n)}return t(null)}let n=null;const o=Object.assign({},e),c={id:o.id,jsonrpc:o.jsonrpc};try{yield w(S,s,"m",d).call(S,o,c,w(this,i,"f"))}catch(e){n=e}return n&&(delete c.result,c.error||(c.error=(0,k.serializeError)(n))),t(n,c)}))},d=function(e,t,r){return f(this,void 0,void 0,(function*(){const[n,o,i]=yield w(S,s,"m",h).call(S,e,t,r);if(w(S,s,"m",g).call(S,e,t,o),yield w(S,s,"m",m).call(S,i),n)throw n}))},h=function(e,t,r){return f(this,void 0,void 0,(function*(){const n=[];let o=null,i=!1;for(const a of r)if([o,i]=yield w(S,s,"m",p).call(S,e,t,a,n),i)break;return[o,i,n.reverse()]}))},p=function(e,t,r,n){return f(this,void 0,void 0,(function*(){return new Promise((s=>{const o=e=>{const r=e||t.error;r&&(t.error=(0,k.serializeError)(r)),s([r,!0])},i=r=>{t.error?o(t.error):(r&&("function"!=typeof r&&o(new k.JsonRpcError(k.errorCodes.rpc.internal,`JsonRpcEngine: "next" return handlers must be functions. Received "${typeof r}" for request:\n${T(e)}`,{request:e})),n.push(r)),s([null,!1]))};try{r(e,t,i,o)}catch(e){o(e)}}))}))},m=function(e){return f(this,void 0,void 0,(function*(){for(const t of e)yield new Promise(((e,r)=>{t((t=>t?r(t):e()))}))}))},g=function(e,t,r){if(!(0,b.hasProperty)(t,"result")&&!(0,b.hasProperty)(t,"error"))throw new k.JsonRpcError(k.errorCodes.rpc.internal,`JsonRpcEngine: Response has no error or result for request:\n${T(e)}`,{request:e});if(!r)throw new k.JsonRpcError(k.errorCodes.rpc.internal,`JsonRpcEngine: Nothing ended request:\n${T(e)}`,{request:e})}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/JsonRpcEngine.js"}],[1291,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,o){function i(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.createAsyncMiddleware=void 0,r.createAsyncMiddleware=function(e){return(t,r,s,o)=>n(this,void 0,void 0,(function*(){let i;const a=new Promise((e=>{i=e}));let c=null,l=!1;const u=()=>n(this,void 0,void 0,(function*(){return l=!0,s((e=>{c=e,i()})),a}));try{yield e(t,r,u),l?(yield a,c(null)):o(null)}catch(e){c?c(e):o(e)}}))}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/createAsyncMiddleware.js"}],[1292,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createScaffoldMiddleware=void 0,r.createScaffoldMiddleware=function(e){return(t,r,n,s)=>{const o=e[t.method];return o===undefined?n():"function"==typeof o?o(t,r,n,s):(r.result=o,s())}}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/createScaffoldMiddleware.js"}],[1293,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getUniqueId=void 0;const n=4294967295;let s=Math.floor(Math.random()*n);r.getUniqueId=function(){return s=(s+1)%n,s}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/getUniqueId.js"}],[1294,{"./getUniqueId":1293},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createIdRemapMiddleware=void 0;const n=e("./getUniqueId");r.createIdRemapMiddleware=function(){return(e,t,r,s)=>{const o=e.id,i=(0,n.getUniqueId)();e.id=i,t.id=i,r((r=>{e.id=o,t.id=o,r()}))}}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/idRemapMiddleware.js"}],[1295,{"./JsonRpcEngine":1290,"./createAsyncMiddleware":1291,"./createScaffoldMiddleware":1292,"./getUniqueId":1293,"./idRemapMiddleware":1294,"./mergeMiddleware":1296},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./createAsyncMiddleware"),r),s(e("./createScaffoldMiddleware"),r),s(e("./getUniqueId"),r),s(e("./idRemapMiddleware"),r),s(e("./JsonRpcEngine"),r),s(e("./mergeMiddleware"),r)}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/index.js"}],[1296,{"./JsonRpcEngine":1290},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.mergeMiddleware=void 0;const n=e("./JsonRpcEngine");r.mergeMiddleware=function(e){const t=new n.JsonRpcEngine;return e.forEach((e=>t.push(e))),t.asMiddleware()}}}},{package:"@metamask/eth-json-rpc-filters>@metamask/json-rpc-engine",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/@metamask/json-rpc-engine/dist/mergeMiddleware.js"}],[1297,{"./Semaphore":1298,tslib:4848},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("tslib"),s=e("./Semaphore"),o=function(){function e(){this._semaphore=new s.default(1)}return e.prototype.acquire=function(){return n.__awaiter(this,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,this._semaphore.acquire()];case 1:return e=t.sent(),[2,e[1]]}}))}))},e.prototype.runExclusive=function(e){return this._semaphore.runExclusive((function(){return e()}))},e.prototype.isLocked=function(){return this._semaphore.isLocked()},e.prototype.release=function(){this._semaphore.release()},e}();r.default=o}}},{package:"@metamask/eth-json-rpc-filters>async-mutex",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/async-mutex/lib/Mutex.js"}],[1298,{tslib:4848},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("tslib"),s=function(){function e(e){if(this._maxConcurrency=e,this._queue=[],e<=0)throw new Error("semaphore must be initialized to a positive value");this._value=e}return e.prototype.acquire=function(){var e=this,t=this.isLocked(),r=new Promise((function(t){return e._queue.push(t)}));return t||this._dispatch(),r},e.prototype.runExclusive=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r,s;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.acquire()];case 1:t=n.sent(),r=t[0],s=t[1],n.label=2;case 2:return n.trys.push([2,,4,5]),[4,e(r)];case 3:return[2,n.sent()];case 4:return s(),[7];case 5:return[2]}}))}))},e.prototype.isLocked=function(){return this._value<=0},e.prototype.release=function(){if(this._maxConcurrency>1)throw new Error("this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){var e=this._currentReleaser;this._currentReleaser=undefined,e()}},e.prototype._dispatch=function(){var e=this,t=this._queue.shift();if(t){var r=!1;this._currentReleaser=function(){r||(r=!0,e._value++,e._dispatch())},t([this._value--,this._currentReleaser])}},e}();r.default=s}}},{package:"@metamask/eth-json-rpc-filters>async-mutex",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/async-mutex/lib/Semaphore.js"}],[1299,{"./Mutex":1297,"./Semaphore":1298,"./withTimeout":1300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.withTimeout=r.Semaphore=r.Mutex=void 0;var n=e("./Mutex");Object.defineProperty(r,"Mutex",{enumerable:!0,get:function(){return n.default}});var s=e("./Semaphore");Object.defineProperty(r,"Semaphore",{enumerable:!0,get:function(){return s.default}});var o=e("./withTimeout");Object.defineProperty(r,"withTimeout",{enumerable:!0,get:function(){return o.withTimeout}})}}},{package:"@metamask/eth-json-rpc-filters>async-mutex",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/async-mutex/lib/index.js"}],[13,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.OIDC_TOKENS_ENDPOINT=r.AUTH_NONCE_ENDPOINT=r.AUTH_LOGIN_ENDPOINT=void 0,r.createLoginRawMessage=function(e,t){return`metamask:${e}:${t}`},r.getAccessToken=async function(e){const t=new Headers({"Content-Type":"application/x-www-form-urlencoded"}),r=new URLSearchParams;r.append("grant_type",c),r.append("client_id",a),r.append("assertion",e);try{const e=await fetch(i,{method:"POST",headers:t,body:r.toString()});if(!e.ok)return null;const n=await e.json();return(null==n?void 0:n.access_token)??null}catch(e){return console.error("authentication-controller/services: unable to get access token",e),null}},r.getNonce=async function(e){const t=new URL(s);t.searchParams.set("identifier",e);try{const e=await fetch(t.toString());if(!e.ok)return null;const r=await e.json();return(null==r?void 0:r.nonce)??null}catch(e){return console.error("authentication-controller/services: unable to get nonce",e),null}},r.login=async function(e,t,r){try{const n=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({signature:t,raw_message:e,metametrics:{metametrics_id:r,agent:"extension"}})});if(!n.ok)return null;return await n.json()??null}catch(e){return console.error("authentication-controller/services: unable to login",e),null}};const n="https://authentication.api.cx.metamask.io",s=r.AUTH_NONCE_ENDPOINT=`${n}/api/v2/nonce`,o=r.AUTH_LOGIN_ENDPOINT=`${n}/api/v2/srp/login`,i=r.OIDC_TOKENS_ENDPOINT="https://oidc.api.cx.metamask.io/oauth2/token",a="1132f10a-b4e5-4390-a5f2-d9c6022db564",c="urn:ietf:params:oauth:grant-type:jwt-bearer"}}},{package:"$root$",file:"app/scripts/controllers/authentication/services.ts"}],[130,{"../../../../../shared/types/transaction-decode":5035,"./four-byte":125,"./proxy":126,"./sourcify":127,"./uniswap":129,"@metamask/utils":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.decodeTransactionData=async function({transactionData:e,contractAddress:t,chainId:r,ethQuery:n}){l("Decoding transaction data",{transactionData:e,contractAddress:t,chainId:r});const d=(0,o.decodeUniswapRouterTransactionData)({transactionData:e,contractAddress:t,chainId:r});if(d)return l("Decoded with Uniswap commands",d),{data:u(d),source:s.DecodedTransactionDataSource.Uniswap};const h=await(0,a.getContractProxyAddress)(t,n);h&&l("Retrieved proxy implementation address",h);const p=h??t,m=(0,i.decodeTransactionDataWithSourcify)(e,p,r),g=(0,c.decodeTransactionDataWithFourByte)(e),[f,y]=await Promise.allSettled([m,g]);if("fulfilled"===f.status&&f.value)return l("Decoded data with Sourcify",f.value),{data:u([f.value]),source:s.DecodedTransactionDataSource.Sourcify};if(l("Failed to decode data with Sourcify",f),"fulfilled"===y.status&&y.value)return l("Decoded data with 4Byte",y.value),{data:u([y.value]),source:s.DecodedTransactionDataSource.FourByte};return l("Failed to decode data with 4Byte",y),undefined};var n=e("@metamask/utils"),s=e("../../../../../shared/types/transaction-decode"),o=e("./uniswap"),i=e("./sourcify"),a=e("./proxy"),c=e("./four-byte");const l=(0,n.createProjectLogger)("transaction-decode");function u(e){return e.map((e=>function(e){return{...e,params:e.params.map((e=>d(e)))}}(e)))}function d(e){var t;return{...e,value:h(e.value),children:null===(t=e.children)||void 0===t?void 0:t.map((e=>d(e)))}}function h(e){const t=e._hex;return t?parseInt(t,16):e}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/util.ts"}],[1300,{tslib:4848},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.withTimeout=void 0;var n=e("tslib");r.withTimeout=function(e,t,r){var s=this;return void 0===r&&(r=new Error("timeout")),{acquire:function(){return new Promise((function(o,i){return n.__awaiter(s,void 0,void 0,(function(){var s,a;return n.__generator(this,(function(n){switch(n.label){case 0:return s=!1,setTimeout((function(){s=!0,i(r)}),t),[4,e.acquire()];case 1:return a=n.sent(),s?(Array.isArray(a)?a[1]:a)():o(a),[2]}}))}))}))},runExclusive:function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(n){switch(n.label){case 0:t=function(){return undefined},n.label=1;case 1:return n.trys.push([1,,7,8]),[4,this.acquire()];case 2:return r=n.sent(),Array.isArray(r)?(t=r[1],[4,e(r[0])]):[3,4];case 3:return[2,n.sent()];case 4:return t=r,[4,e()];case 5:return[2,n.sent()];case 6:return[3,8];case 7:return t(),[7];case 8:return[2]}}))}))},release:function(){e.release()},isLocked:function(){return e.isLocked()}}}}}},{package:"@metamask/eth-json-rpc-filters>async-mutex",file:"node_modules/@metamask/eth-json-rpc-filters/node_modules/async-mutex/lib/withTimeout.js"}],[1301,{"./getBlocksForRange.js":1285,"./hexUtils.js":1286,"./index.js":1287,"@metamask/json-rpc-engine":1295,"@metamask/safe-event-emitter":1906},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("@metamask/safe-event-emitter").default,{createAsyncMiddleware:s,createScaffoldMiddleware:o}=e("@metamask/json-rpc-engine"),i=e("./index.js"),{unsafeRandomBytes:a,incrementHexInt:c}=e("./hexUtils.js"),l=e("./getBlocksForRange.js");function u(e){return null===e||e===undefined?null:{hash:e.hash,parentHash:e.parentHash,sha3Uncles:e.sha3Uncles,miner:e.miner,stateRoot:e.stateRoot,transactionsRoot:e.transactionsRoot,receiptsRoot:e.receiptsRoot,logsBloom:e.logsBloom,difficulty:e.difficulty,number:e.number,gasLimit:e.gasLimit,gasUsed:e.gasUsed,nonce:e.nonce,mixHash:e.mixHash,timestamp:e.timestamp,extraData:e.extraData}}t.exports=function({blockTracker:e,provider:t}){const r={},d=i({blockTracker:e,provider:t});let h=!1;const p=new n,m=o({eth_subscribe:s((async function(n,s){if(h)throw new Error("SubscriptionManager - attempting to use after destroying");const o=n.params[0],i=a(16);let p;switch(o){case"newHeads":p=m({subId:i});break;case"logs":const e=n.params[1];p=f({subId:i,filter:await d.newLogFilter(e)});break;default:throw new Error(`SubscriptionManager - unsupported subscription type "${o}"`)}return r[i]=p,void(s.result=i);function m({subId:r}){const n={type:o,destroy:async()=>{e.removeListener("sync",n.update)},update:async({oldBlock:e,newBlock:n})=>{const s=n,o=c(e);(await l({provider:t,fromBlock:o,toBlock:s})).map(u).filter((e=>null!==e)).forEach((e=>{g(r,e)}))}};return e.on("sync",n.update),n}function f({subId:e,filter:t}){t.on("update",(t=>g(e,t)));return{type:o,destroy:async()=>await d.uninstallFilter(t.idHex)}}})),eth_unsubscribe:s((async function(e,t){if(h)throw new Error("SubscriptionManager - attempting to use after destroying");const n=e.params[0],s=r[n];if(!s)return void(t.result=!1);delete r[n],await s.destroy(),t.result=!0}))});return m.destroy=function(){p.removeAllListeners();for(const e in r)r[e].destroy(),delete r[e];h=!0},{events:p,middleware:m};function g(e,t){p.emit("notification",{jsonrpc:"2.0",method:"eth_subscription",params:{subscription:e,result:t}})}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/subscriptionManager.js"}],[1302,{"./base-filter":1283,"./getBlocksForRange":1285,"./hexUtils":1286},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){const n=e("./base-filter"),s=e("./getBlocksForRange"),{incrementHexInt:o}=e("./hexUtils");t.exports=class extends n{constructor({provider:e}){super(),this.type="tx",this.provider=e}async update({oldBlock:e}){const t=e,r=o(e),n=await s({provider:this.provider,fromBlock:r,toBlock:t}),i=[];for(const e of n)i.push(...e.transactions);this.addResults(i)}}}}},{package:"@metamask/eth-json-rpc-filters",file:"node_modules/@metamask/eth-json-rpc-filters/tx-filter.js"}],[131,{"../../../../shared/constants/app":4962,"../../../../shared/constants/gas":4968,"../../../../shared/constants/metametrics":4973,"../../../../shared/constants/transaction":4990,"../../../../shared/lib/transactions-controller-utils":5003,"../../../../shared/modules/conversion.utils":5010,"../../../../shared/modules/metametrics":5019,"../../../../shared/modules/transaction.utils":5032,"../../../../ui/helpers/utils/metrics":5894,"../../../../ui/pages/confirmations/utils":6274,"../snap-keyring/metrics":120,"@metamask/eth-query":1363,"@metamask/transaction-controller":2660,"bignumber.js":3425,"ethereumjs-util":3776},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.handleTransactionSubmitted=r.handleTransactionRejected=r.handleTransactionFailed=r.handleTransactionDropped=r.handleTransactionConfirmed=r.handleTransactionApproved=r.handleTransactionAdded=r.handlePostTransactionBalanceUpdate=r.createTransactionEventFragmentWithTxId=r.METRICS_STATUS_FAILED=void 0;var n,s=e("ethereumjs-util"),o=(n=e("@metamask/eth-query"))&&n.__esModule?n:{default:n},i=e("bignumber.js"),a=e("@metamask/transaction-controller"),c=e("../../../../shared/constants/app"),l=e("../../../../shared/modules/transaction.utils"),u=e("../../../../shared/modules/conversion.utils"),d=e("../../../../shared/constants/transaction"),h=e("../../../../shared/constants/metametrics"),p=e("../../../../shared/constants/gas"),m=e("../../../../shared/lib/transactions-controller-utils"),g=e("../../../../ui/helpers/utils/metrics"),f=e("../../../../shared/modules/metametrics"),y=e("../snap-keyring/metrics"),w=e("../../../../ui/pages/confirmations/utils");const C=r.METRICS_STATUS_FAILED="failed on-chain";r.handleTransactionAdded=async(e,t)=>{if(!t.transactionMeta)return;const{properties:r,sensitiveProperties:n}=await S({transactionEventPayload:t,transactionMetricsRequest:e});k({eventName:d.TransactionMetaMetricsEvent.added,transactionEventPayload:t,transactionMetricsRequest:e,payload:{properties:r,sensitiveProperties:n}})};r.handleTransactionApproved=async(e,t)=>{t.transactionMeta&&await v({eventName:d.TransactionMetaMetricsEvent.approved,transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionFailed=async(e,t)=>{if(!t.transactionMeta)return;const r={};t.error&&(r.error=t.error),await v({eventName:d.TransactionMetaMetricsEvent.finalized,extraParams:r,transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionConfirmed=async(e,t)=>{if(0===Object.keys(t).length)return;const r={},n={...t},{txReceipt:s}=n;r.gas_used=null==s?void 0:s.gasUsed;const{submittedTime:o}=n;o&&(r.completion_time=function(e){return Math.round((Date.now()-e)/1e3).toString()}(o)),"0x0"===(null==s?void 0:s.status)&&(r.status=C),await v({eventName:d.TransactionMetaMetricsEvent.finalized,extraParams:r,transactionEventPayload:{actionId:n.actionId,transactionMeta:n},transactionMetricsRequest:e})};r.handleTransactionDropped=async(e,t)=>{if(!t.transactionMeta)return;await v({eventName:d.TransactionMetaMetricsEvent.finalized,extraParams:{dropped:!0},transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionRejected=async(e,t)=>{t.transactionMeta&&await v({eventName:d.TransactionMetaMetricsEvent.rejected,transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionSubmitted=async(e,t)=>{if(!t.transactionMeta)return;const{properties:r,sensitiveProperties:n}=await S({transactionEventPayload:t,transactionMetricsRequest:e});k({eventName:d.TransactionMetaMetricsEvent.submitted,transactionEventPayload:t,transactionMetricsRequest:e,payload:{properties:r,sensitiveProperties:n}})};r.createTransactionEventFragmentWithTxId=async(e,{transactionId:t,actionId:r})=>{const n={...e.getTransaction(t),actionId:r},{properties:s,sensitiveProperties:o}=await S({transactionEventPayload:{transactionMeta:n},transactionMetricsRequest:e});k({eventName:d.TransactionMetaMetricsEvent.approved,transactionEventPayload:{actionId:n.actionId,transactionMeta:n},transactionMetricsRequest:e,payload:{properties:s,sensitiveProperties:o}})};function k({eventName:e,transactionEventPayload:{transactionMeta:t,actionId:r},transactionMetricsRequest:n,payload:s}){if(function(e,t,r){const n=b(t,r.id);return void 0!==e(n)}(n.getEventFragmentById,e,t))return;const o=b(e,t.id);switch(e){case d.TransactionMetaMetricsEvent.added:n.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,initialEvent:d.TransactionMetaMetricsEvent.added,successEvent:d.TransactionMetaMetricsEvent.approved,failureEvent:d.TransactionMetaMetricsEvent.rejected,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:o,persist:!0});break;case d.TransactionMetaMetricsEvent.approved:case d.TransactionMetaMetricsEvent.rejected:n.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,successEvent:d.TransactionMetaMetricsEvent.approved,failureEvent:d.TransactionMetaMetricsEvent.rejected,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:o,persist:!0});break;case d.TransactionMetaMetricsEvent.submitted:n.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,initialEvent:d.TransactionMetaMetricsEvent.submitted,successEvent:d.TransactionMetaMetricsEvent.finalized,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:o,persist:!0});break;case d.TransactionMetaMetricsEvent.finalized:n.createEventFragment({category:h.MetaMetricsEventCategory.Transactions,successEvent:d.TransactionMetaMetricsEvent.finalized,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:o,persist:!0})}}async function v({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r,extraParams:n={}}){const{properties:s,sensitiveProperties:o}=await S({transactionEventPayload:t,transactionMetricsRequest:r,extraParams:n});k({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r,payload:{properties:s,sensitiveProperties:o}}),function({eventName:e,transactionEventPayload:{transactionMeta:t},transactionMetricsRequest:r,payload:n}){const s=b(e,t.id);switch(e){case d.TransactionMetaMetricsEvent.approved:case d.TransactionMetaMetricsEvent.rejected:case d.TransactionMetaMetricsEvent.finalized:r.updateEventFragment(s,{properties:n.properties,sensitiveProperties:n.sensitiveProperties})}}({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r,payload:{properties:s,sensitiveProperties:o}}),function({eventName:e,transactionMetricsRequest:t,transactionEventPayload:{transactionMeta:r}}){const n=b(e,r.id);switch(e){case d.TransactionMetaMetricsEvent.approved:t.finalizeEventFragment(n);break;case d.TransactionMetaMetricsEvent.rejected:t.finalizeEventFragment(n,{abandoned:!0});break;case d.TransactionMetaMetricsEvent.finalized:t.finalizeEventFragment(n)}}({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r})}function b(e,t){return`transaction-${e===d.TransactionMetaMetricsEvent.finalized||e===d.TransactionMetaMetricsEvent.submitted?"submitted":"added"}-${t}`}async function S({transactionEventPayload:{transactionMeta:e},transactionMetricsRequest:t,extraParams:r={}}){var n;const{type:C,time:k,status:v,chainId:b,origin:S,txParams:{gasPrice:T,gas:_,maxFeePerGas:E,maxPriorityFeePerGas:A,estimateSuggested:M,estimateUsed:P},defaultGasEstimates:I,originalType:R,replacedById:N,customTokenAmount:j,dappProposedTokenAmount:x,currentTokenBalance:O,originalApprovalAmount:B,finalApprovalAmount:U,contractMethodName:F,securityProviderResponse:D,simulationFails:L}=e,H=new o.default(t.provider),$=S===c.ORIGIN_METAMASK?"user":"dapp",{assetType:q,tokenStandard:K}=await(0,l.determineTransactionAssetType)(e,H,t.getTokenStandardAndDetails),G={};if((0,l.isEIP1559Transaction)(e)?(G.max_fee_per_gas=E,G.max_priority_fee_per_gas=A):G.gas_price=T,I){var W,V;const{estimateType:r}=I;if(r){var J,z;G.default_estimate=r;let n=null===(J=e.defaultGasEstimates)||void 0===J?void 0:J.maxFeePerGas,s=null===(z=e.defaultGasEstimates)||void 0===z?void 0:z.maxPriorityFeePerGas;if([p.GasRecommendations.low,p.GasRecommendations.medium,p.GasRecommendations.high].includes(r)){var Y,X;const{gasFeeEstimates:e}=await t.getEIP1559GasFeeEstimates();var Q,Z;if(null!=e&&null!==(Y=e[r])&&void 0!==Y&&Y.suggestedMaxFeePerGas)n=null===(Q=e[r])||void 0===Q?void 0:Q.suggestedMaxFeePerGas,G.default_max_fee_per_gas=n;if(null!=e&&null!==(X=e[r])&&void 0!==X&&X.suggestedMaxPriorityFeePerGas)s=null===(Z=e[r])||void 0===Z?void 0:Z.suggestedMaxPriorityFeePerGas,G.default_max_priority_fee_per_gas=s}}null!==(W=e.defaultGasEstimates)&&void 0!==W&&W.gas&&(G.default_gas=e.defaultGasEstimates.gas),null!==(V=e.defaultGasEstimates)&&void 0!==V&&V.gasPrice&&(G.default_gas_price=e.defaultGasEstimates.gasPrice)}M&&(G.estimate_suggested=M),P&&(G.estimate_used=P),null!=r&&r.gas_used&&(G.gas_used=r.gas_used);const ee=function(e){const t={};for(const r in e)(0,s.isHexString)(e[r])?t[r]=(0,u.hexWEIToDecGWEI)(e[r]):t[r]=e[r];return t}(G);let te="0";e.txParams.maxFeePerGas&&(te="2");const re=C&&[a.TransactionType.contractInteraction,a.TransactionType.tokenMethodApprove,a.TransactionType.tokenMethodIncreaseAllowance,a.TransactionType.tokenMethodSafeTransferFrom,a.TransactionType.tokenMethodSetApprovalForAll,a.TransactionType.tokenMethodTransfer,a.TransactionType.tokenMethodTransferFrom,a.TransactionType.swap,a.TransactionType.swapAndSend,a.TransactionType.swapApproval].includes(C),ne="Approve";let se,oe,ie,ae,ce=a.TransactionType.simpleSend;C===a.TransactionType.swapAndSend?ce=a.TransactionType.swapAndSend:C===a.TransactionType.cancel?ce=a.TransactionType.cancel:C===a.TransactionType.retry&&R?ce=R:C===a.TransactionType.deployContract?ce=a.TransactionType.deployContract:re&&(ce=a.TransactionType.contractInteraction,oe=F,oe===ne&&K===d.TokenStandard.ERC20&&("0"===x||"0"===j?se=d.TransactionApprovalAmountType.revoke:j&&j!==x?se=d.TransactionApprovalAmountType.custom:x&&(se=d.TransactionApprovalAmountType.dappProposed),ie=function(e,t,r){if(e===d.TransactionApprovalAmountType.custom&&t&&r)return`${new i.BigNumber(t,10).div(r,10).times(100).round(2)}`;return null}(se,B,U),ae=function(e,t,r){if((e===d.TransactionApprovalAmountType.custom||e===d.TransactionApprovalAmountType.dappProposed)&&t&&r)return`${new i.BigNumber(t,16).div(r,10).times(100).round(2)}`;return null}(se,x,O)));const le=t.getTransaction(N),ue={RETRY:a.TransactionType.retry,CANCEL:a.TransactionType.cancel,SAME_NONCE:"other"};let de;null!=r&&r.dropped&&(de=ue.SAME_NONCE,(null==le?void 0:le.type)===a.TransactionType.cancel?de=ue.CANCEL:(null==le?void 0:le.type)===a.TransactionType.retry&&(de=ue.RETRY));const he=[];1===(null==D?void 0:D.flagAsDangerous)?he.push(h.MetaMetricsEventUiCustomization.FlaggedAsMalicious):2===(null==D?void 0:D.flagAsDangerous)&&he.push(h.MetaMetricsEventUiCustomization.FlaggedAsSafetyUnknown);const pe=(0,g.getBlockaidMetricsProps)(e);(null==pe||null===(n=pe.ui_customizations)||void 0===n?void 0:n.length)>0&&he.push(...pe.ui_customizations),L&&he.push(h.MetaMetricsEventUiCustomization.GasEstimationFailed);const me=t.getIsRedesignedConfirmationsDeveloperEnabled()||"",ge=t.getRedesignedConfirmationsEnabled();(me||ge)&&w.REDESIGN_TRANSACTION_TYPES.includes(e.type)&&he.push(h.MetaMetricsEventUiCustomization.RedesignedConfirmation);const fe=(0,f.getSmartTransactionMetricsProperties)(t,e),ye=(0,g.getSwapAndSendMetricsProps)(e);let we={chain_id:b,referrer:S,source:$,status:v,network:`${parseInt(b,16)}`,eip_1559_version:te,gas_edit_type:"none",gas_edit_attempted:"none",gas_estimation_failed:Boolean(L),account_type:await t.getAccountType(t.getSelectedAddress()),device_model:await t.getDeviceModel(t.getSelectedAddress()),asset_type:q,token_standard:K,transaction_type:ce,transaction_speed_up:C===a.TransactionType.retry,...pe,ui_customizations:he.length>0?he:null,...fe,...ye};const Ce=await(0,y.getSnapAndHardwareInfoForMetrics)(t.getAccountType,t.getDeviceModel,t.snapAndHardwareMessenger);Object.assign(we,Ce),oe===ne&&(we={...we,transaction_approval_amount_type:se});let ke={transaction_envelope_type:(0,l.isEIP1559Transaction)(e)?m.TRANSACTION_ENVELOPE_TYPE_NAMES.FEE_MARKET:m.TRANSACTION_ENVELOPE_TYPE_NAMES.LEGACY,first_seen:k,gas_limit:_,transaction_contract_method:oe,transaction_replaced:de,...r,...ee};return oe===ne&&(ke={...ke,transaction_approval_amount_vs_balance_ratio:ae,transaction_approval_amount_vs_proposed_ratio:ie}),{properties:we,sensitiveProperties:ke}}r.handlePostTransactionBalanceUpdate=async({getParticipateInMetrics:e,trackEvent:t},{transactionMeta:r,approvalTransactionMeta:n})=>{var s;if(e()&&r.swapMetaData)if("0x0"===(null===(s=r.txReceipt)||void 0===s?void 0:s.status))t({event:"Swap Failed",sensitiveProperties:{...r.swapMetaData},category:h.MetaMetricsEventCategory.Swaps});else{var o;const e=(0,m.getSwapsTokensReceivedFromTxMeta)(r.destinationTokenSymbol,r,r.destinationTokenAddress,r.txParams.from,r.destinationTokenDecimals,n,r.chainId),s=e?`${new i.BigNumber(e,10).div(r.swapMetaData.token_to_amount,10).times(100).round(2)}%`:null,a=null!==(o=r.txReceipt)&&void 0!==o&&o.gasUsed&&r.swapMetaData.estimated_gas?`${new i.BigNumber(r.txReceipt.gasUsed,16).div(r.swapMetaData.estimated_gas,10).times(100).round(2)}%`:null,c=function(e,t){var r,n;let s="0x0";null!=t&&t.txReceipt&&(s=(0,m.calcGasTotal)(t.txReceipt.gasUsed,t.txReceipt.effectiveGasPrice));const o=(0,m.calcGasTotal)(null===(r=e.txReceipt)||void 0===r?void 0:r.gasUsed,null===(n=e.txReceipt)||void 0===n?void 0:n.effectiveGasPrice),a=new i.BigNumber(o,16).plus(s,16).toString(16);return{approvalGasCostInEth:Number((0,u.hexWEIToDecETH)(s)),tradeGasCostInEth:Number((0,u.hexWEIToDecETH)(o)),tradeAndApprovalGasCostInEth:Number((0,u.hexWEIToDecETH)(a))}}(r,n);t({event:h.MetaMetricsEventName.SwapCompleted,category:h.MetaMetricsEventCategory.Swaps,sensitiveProperties:{...r.swapMetaData,token_to_amount_received:e,quote_vs_executionRatio:s,estimated_vs_used_gasRatio:a,approval_gas_cost_in_eth:c.approvalGasCostInEth,trade_gas_cost_in_eth:c.tradeGasCostInEth,trade_and_approval_gas_cost_in_eth:c.tradeAndApprovalGasCostInEth,token_to_amount:r.swapMetaData.token_to_amount.toString(10)}})}}}}},{package:"$root$",file:"app/scripts/lib/transaction/metrics.ts"}],[1319,{"./logging-utils":1326,"./utils/cache":1329,"@metamask/json-rpc-engine":1484},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockCacheMiddleware=void 0;const n=e("@metamask/json-rpc-engine"),s=e("./logging-utils"),o=e("./utils/cache"),i=(0,s.createModuleLogger)(s.projectLogger,"block-cache"),a=[undefined,null,"<nil>"];class c{constructor(){this.cache={}}getBlockCache(e){const t=Number.parseInt(e,16);let r=this.cache[t];if(!r){const e={};this.cache[t]=e,r=e}return r}async get(e,t){const r=this.getBlockCache(t),n=(0,o.cacheIdentifierForRequest)(e,!0);return n?r[n]:undefined}async set(e,t,r){if(!this.canCacheResult(e,r))return;const n=(0,o.cacheIdentifierForRequest)(e,!0);if(!n)return;this.getBlockCache(t)[n]=r}canCacheRequest(e){if(!(0,o.canCache)(e.method))return!1;return"pending"!==(0,o.blockTagForRequest)(e)}canCacheResult(e,t){return!a.includes(t)&&!(e.method&&["eth_getTransactionByHash","eth_getTransactionReceipt"].includes(e.method)&&(!t||!t.blockHash||"0x0000000000000000000000000000000000000000000000000000000000000000"===t.blockHash))}clearBefore(e){const t=Number.parseInt(e,16);Object.keys(this.cache).map(Number).filter((e=>e<t)).forEach((e=>delete this.cache[e]))}}r.createBlockCacheMiddleware=function({blockTracker:e}={}){if(!e)throw new Error("createBlockCacheMiddleware - No PollingBlockTracker specified");const t=new c,r={[o.CacheStrategy.Permanent]:t,[o.CacheStrategy.Block]:t,[o.CacheStrategy.Fork]:t,[o.CacheStrategy.Never]:undefined};return(0,n.createAsyncMiddleware)((async(n,s,a)=>{if(n.skipCache)return a();const c=(0,o.cacheTypeForMethod)(n.method),l=r[c];if(!l)return a();if(!l.canCacheRequest(n))return a();const u=(0,o.blockTagForRequest)(n),d=u&&"string"==typeof u?u:"latest";let h;if(i("blockTag = %o, req = %o",d,n),"earliest"===d)h="0x00";else if("latest"===d){i("Fetching latest block number to determine cache key");const r=await e.getLatestBlock();i("Clearing values stored under block numbers before %o",r),t.clearBefore(r),h=r}else h=d;const p=await l.get(n,h);return p===undefined?(i("No cache stored under block number %o, carrying request forward",h),await a(),i("Populating cache with",s),await l.set(n,h,s.result)):(i("Cache hit, reusing cache result stored under block number %o",h),s.result=p),undefined}))}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/block-cache.js"}],[132,{"../../../../shared/constants/app":4962,"../../../../shared/constants/smartTransactions":4984,"../../../../shared/modules/conversion.utils":5010,"@metamask/smart-transactions-controller/dist/types":1947,"@metamask/transaction-controller":2660,loglevel:4328},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.submitSmartTransactionHook=void 0;var n,s=e("@metamask/smart-transactions-controller/dist/types"),o=e("@metamask/transaction-controller"),i=(n=e("loglevel"))&&n.__esModule?n:{default:n},a=e("../../../../shared/modules/conversion.utils"),c=e("../../../../shared/constants/smartTransactions"),l=e("../../../../shared/constants/app");function u(e,t){h(e,t),t.add(e)}function d(e,t,r){h(e,t),t.set(e,r)}function h(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function m(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,f(e,t,"get"))}function g(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,f(e,t,"set"),r),r}function f(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}var y=new WeakMap,w=new WeakMap,C=new WeakMap,k=new WeakMap,v=new WeakMap,b=new WeakMap,S=new WeakMap,T=new WeakMap,_=new WeakMap,E=new WeakMap,A=new WeakMap,M=new WeakSet,P=new WeakSet,I=new WeakSet,R=new WeakSet,N=new WeakSet,j=new WeakSet,x=new WeakSet,O=new WeakSet;class B{constructor(e){u(this,O),u(this,x),u(this,j),u(this,N),u(this,R),u(this,I),u(this,P),u(this,M),d(this,y,{writable:!0,value:void 0}),d(this,w,{writable:!0,value:void 0}),d(this,C,{writable:!0,value:void 0}),d(this,k,{writable:!0,value:void 0}),d(this,v,{writable:!0,value:void 0}),d(this,b,{writable:!0,value:void 0}),d(this,S,{writable:!0,value:void 0}),d(this,T,{writable:!0,value:void 0}),d(this,_,{writable:!0,value:void 0}),d(this,E,{writable:!0,value:void 0}),d(this,A,{writable:!0,value:void 0});const{transactionMeta:t,smartTransactionsController:r,transactionController:n,isSmartTransaction:s,controllerMessenger:o,featureFlags:i}=e;g(this,w,""),g(this,y,!1),g(this,E,t),g(this,T,r),g(this,_,n),g(this,S,s),g(this,k,o),g(this,v,i),g(this,b,t.origin!==l.ORIGIN_METAMASK),g(this,C,t.chainId),g(this,A,t.txParams)}async submit(){var e;const t=!(null===(e=m(this,E))||void 0===e||!e.type)&&[o.TransactionType.swapAndSend,o.TransactionType.swapApproval].includes(m(this,E).type),r={transactionHash:undefined};if(!m(this,S)||t)return r;const{id:n}=await m(this,k).call("ApprovalController:startFlow");let s;g(this,w,n);try{s=await m(this,T).getFees({...m(this,A),chainId:m(this,C)},undefined)}catch(e){return i.default.error("Error in smart transaction publish hook, falling back to regular transaction submission",e),p(this,M,U).call(this),r}try{var a;const e=await p(this,j,$).call(this,{getFeesResponse:s}),t=null==e?void 0:e.uuid;if(!t)throw new Error("No smart transaction UUID");const r=null===(a=m(this,v))||void 0===a||null===(a=a.smartTransactions)||void 0===a?void 0:a.returnTxHashAsap;let n;if(p(this,P,F).call(this,{uuid:t}),p(this,R,L).call(this,{uuid:t}),n=r&&null!=e&&e.txHash?e.txHash:await p(this,N,H).call(this,{uuid:t}),null===n)throw new Error("Transaction does not have a transaction hash, there was a problem");return{transactionHash:n}}catch(e){throw i.default.error("Error in smart transaction publish hook",e),p(this,M,U).call(this),e}}}function U(){m(this,y)||(g(this,y,!0),m(this,k).call("ApprovalController:endFlow",{id:m(this,w)}))}function F({uuid:e}){const t=()=>{p(this,M,U).call(this)};m(this,k).call("ApprovalController:addRequest",{id:m(this,w),origin:origin,type:l.SMART_TRANSACTION_CONFIRMATION_TYPES.showSmartTransactionStatusPage,requestState:{smartTransaction:{status:s.SmartTransactionStatuses.PENDING,creationTime:Date.now(),uuid:e},isDapp:m(this,b),txId:m(this,E).id}},!0).then(t,t)}async function D({smartTransaction:e}){return await m(this,k).call("ApprovalController:updateRequestState",{id:m(this,w),requestState:{smartTransaction:e,isDapp:m(this,b),txId:m(this,E).id}})}async function L({uuid:e}){m(this,T).eventEmitter.on(`${e}:smartTransaction`,(async e=>{const{status:t}=e;t&&t!==s.SmartTransactionStatuses.PENDING&&(m(this,y)||await p(this,I,D).call(this,{smartTransaction:e}))}))}function H({uuid:e}){return new Promise((t=>{m(this,T).eventEmitter.on(`${e}:smartTransaction`,(async e=>{const{status:r,statusMetadata:n}=e;r&&r!==s.SmartTransactionStatuses.PENDING&&(i.default.debug("Smart Transaction: ",e),null!=n&&n.minedHash?(i.default.debug("Smart Transaction - Received tx hash: ",null==n?void 0:n.minedHash),t(n.minedHash)):t(null))}))}))}async function $({getFeesResponse:e}){var t,r;const n=await p(this,O,K).call(this,(null===(t=e.tradeTxFees)||void 0===t?void 0:t.fees)??[],!1),s=await p(this,O,K).call(this,(null===(r=e.tradeTxFees)||void 0===r?void 0:r.cancelFees)||[],!0);return await m(this,T).submitSignedTransactions({signedTransactions:n,signedCanceledTransactions:s,txParams:m(this,A),transactionMeta:m(this,E)})}function q(e,t){const r={...m(this,A),maxFeePerGas:`0x${(0,a.decimalToHex)(e.maxFeePerGas)}`,maxPriorityFeePerGas:`0x${(0,a.decimalToHex)(e.maxPriorityFeePerGas)}`,gas:t?`0x${(0,a.decimalToHex)(c.CANCEL_GAS_LIMIT_DEC)}`:m(this,A).gas};return t&&(r.to=r.from,r.data="0x"),r}async function K(e,t){const r=e.map((e=>p(this,x,q).call(this,e,t))).map((e=>({...e,chainId:e.chainId||m(this,C)})));return await m(this,_).approveTransactionsWithSameNonce(r,{hasNonce:!0})}r.submitSmartTransactionHook=e=>new B(e).submit()}}},{package:"$root$",file:"app/scripts/lib/transaction/smart-transactions.ts"}],[1320,{"./utils/cache":1329,"@metamask/json-rpc-engine":1484},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefRewriteMiddleware=void 0;const n=e("@metamask/json-rpc-engine"),s=e("./utils/cache");r.createBlockRefRewriteMiddleware=function({blockTracker:e}={}){if(!e)throw Error('BlockRefRewriteMiddleware - mandatory "blockTracker" option is missing.');return(0,n.createAsyncMiddleware)((async(t,r,n)=>{const o=(0,s.blockTagParamIndex)(t.method);if(o===undefined)return n();if("latest"!==(Array.isArray(t.params)&&t.params[o]?t.params[o]:"latest"))return n();const i=await e.getLatestBlock();return Array.isArray(t.params)&&(t.params[o]=i),n()}))}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/block-ref-rewrite.js"}],[1321,{"./logging-utils":1326,"./utils/cache":1329,"@metamask/json-rpc-engine":1484,"klona/full":4192},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefMiddleware=void 0;const n=e("@metamask/json-rpc-engine"),s=e("klona/full"),o=e("./logging-utils"),i=e("./utils/cache"),a=(0,o.createModuleLogger)(o.projectLogger,"block-ref");r.createBlockRefMiddleware=function({provider:e,blockTracker:t}={}){if(!e)throw Error('BlockRefMiddleware - mandatory "provider" option is missing.');if(!t)throw Error('BlockRefMiddleware - mandatory "blockTracker" option is missing.');return(0,n.createAsyncMiddleware)((async(r,n,o)=>{var c;const l=(0,i.blockTagParamIndex)(r.method);if(l===undefined)return o();if("latest"!==(Array.isArray(r.params)&&null!==(c=r.params[l])&&void 0!==c?c:"latest"))return a('blockRef is not "latest", carrying request forward'),o();const u=await t.getLatestBlock();a(`blockRef is "latest", setting param ${l} to latest block ${u}`);const d=(0,s.klona)(r);return Array.isArray(d.params)&&(d.params[l]=u),a("Performing another request %o",d),n.result=await e.request(d),undefined}))}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/block-ref.js"}],[1322,{"./logging-utils":1326,"@metamask/json-rpc-engine":1484},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockTrackerInspectorMiddleware=void 0;const n=e("@metamask/json-rpc-engine"),s=e("./logging-utils"),o=(0,s.createModuleLogger)(s.projectLogger,"block-tracker-inspector"),i=["eth_getTransactionByHash","eth_getTransactionReceipt"];function a(e){const{result:t}=e;return t&&"object"==typeof t&&(r=t,n="blockNumber",Object.hasOwnProperty.call(r,n))&&"string"==typeof t.blockNumber?t.blockNumber:undefined;var r,n}r.createBlockTrackerInspectorMiddleware=function({blockTracker:e}){return(0,n.createAsyncMiddleware)((async(t,r,n)=>{if(!i.includes(t.method))return n();await n();const s=a(r);if(!s)return undefined;o("res.result.blockNumber exists, proceeding. res = %o",r);return Number.parseInt(s,16)>Number.parseInt(e.getCurrentBlock(),16)&&(o("blockNumber from response is greater than current block number, refreshing current block number"),await e.checkForLatestBlock()),undefined}))}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/block-tracker-inspector.js"}],[1323,{"./utils/timeout":1332,"@metamask/json-rpc-engine":1484,"@metamask/rpc-errors":1884},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createFetchConfigFromReq=r.createFetchMiddleware=void 0;const n=e("@metamask/json-rpc-engine"),s=e("@metamask/rpc-errors"),o=e("./utils/timeout"),i=["Gateway timeout","ETIMEDOUT","failed to parse response body","Failed to fetch"];function a(e){switch(e.status){case 405:throw s.rpcErrors.methodNotFound();case 418:throw s.rpcErrors.internal({message:"Request is being rate limited."});case 503:case 504:throw function(){let e="Gateway timeout. The request took too long to process. ";return e+="This can happen when querying logs over too wide a block range.",s.rpcErrors.internal({message:e})}()}}function c(e,t){if(200!==e.status)throw s.rpcErrors.internal({message:`Non-200 status code: '${e.status}'`,data:t});if(t.error)throw s.rpcErrors.internal({data:t.error});return t.result}function l({btoa:e,req:t,rpcUrl:r,originHttpHeaderKey:n}){const s=new URL(r),o=function(e){let t="";t+=e.protocol,t+=`//${e.hostname}`,e.port&&(t+=`:${e.port}`);return t+=`${e.pathname}`,t+=`${e.search}`,t}(s),i={id:t.id,jsonrpc:t.jsonrpc,method:t.method,params:t.params},a=t.origin,c={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)};if(s.username&&s.password){const t=e(`${s.username}:${s.password}`);c.headers.Authorization=`Basic ${t}`}return n&&a&&(c.headers[n]=a),{fetchUrl:o,fetchParams:c}}r.createFetchMiddleware=function({btoa:e,fetch:t,rpcUrl:r,originHttpHeaderKey:s}){return(0,n.createAsyncMiddleware)((async(n,u,d)=>{const{fetchUrl:h,fetchParams:p}=l({btoa:e,req:n,rpcUrl:r,originHttpHeaderKey:s});for(let e=0;e<5;e++){try{const e=await t(h,p);a(e);const r=await e.text();let n;try{n=JSON.parse(r)}catch(e){throw new Error(`FetchMiddleware - failed to parse response body: "${r}"`)}const s=c(e,n);return void(u.result=s)}catch(e){const t=e.toString();if(!i.some((e=>t.includes(e))))throw e}await(0,o.timeout)(1e3)}}))},r.createFetchConfigFromReq=l}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/fetch.js"}],[1324,{"./block-cache":1319,"./block-ref":1321,"./block-ref-rewrite":1320,"./block-tracker-inspector":1322,"./fetch":1323,"./inflight-cache":1325,"./providerAsMiddleware":1327,"./retryOnEmpty":1328,"./wallet":1333},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./block-cache"),r),s(e("./block-ref-rewrite"),r),s(e("./block-ref"),r),s(e("./block-tracker-inspector"),r),s(e("./fetch"),r),s(e("./inflight-cache"),r),s(e("./providerAsMiddleware"),r),s(e("./retryOnEmpty"),r),s(e("./wallet"),r)}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/index.js"}],[1325,{"./logging-utils":1326,"./utils/cache":1329,"@metamask/json-rpc-engine":1484,"klona/full":4192},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createInflightCacheMiddleware=void 0;const n=e("@metamask/json-rpc-engine"),s=e("klona/full"),o=e("./logging-utils"),i=e("./utils/cache"),a=(0,o.createModuleLogger)(o.projectLogger,"inflight-cache");r.createInflightCacheMiddleware=function(){const e={};return(0,n.createAsyncMiddleware)((async(t,r,n)=>{if(t.skipCache)return n();const o=(0,i.cacheIdentifierForRequest)(t);if(!o)return a("Request is not cacheable, proceeding. req = %o",t),n();let c=e[o];return c?(a("Running %i handler(s) for request %o",c.length,t),await async function(e,t){const{resolve:r,promise:n}=function(){let e;const t=new Promise((t=>{e=t}));return{resolve:e,promise:t}}();return t.push((t=>{e.result=(0,s.klona)(t.result),e.error=(0,s.klona)(t.error),r()})),n}(r,c),undefined):(c=[],e[o]=c,a("Carrying original request forward %o",t),await n(),delete e[o],a("Running %i collected handler(s) for request %o",c.length,t),function(e,t){setTimeout((()=>{t.forEach((t=>{try{t(e)}catch(e){console.error(e)}}))}))}(r,c),undefined)}))}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/inflight-cache.js"}],[1326,{"@metamask/utils":1344},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.projectLogger=void 0;const n=e("@metamask/utils");Object.defineProperty(r,"createModuleLogger",{enumerable:!0,get:function(){return n.createModuleLogger}}),r.projectLogger=(0,n.createProjectLogger)("eth-json-rpc-middleware")}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/logging-utils.js"}],[1327,{"@metamask/json-rpc-engine":1484},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ethersProviderAsMiddleware=r.providerAsMiddleware=void 0;const n=e("@metamask/json-rpc-engine");r.providerAsMiddleware=function(e){return(0,n.createAsyncMiddleware)((async(t,r)=>{r.result=await e.request(t)}))},r.ethersProviderAsMiddleware=function(e){return(t,r,n,s)=>{e.send(t,((e,t)=>e?s(e):(Object.assign(r,t),s())))}}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/providerAsMiddleware.js"}],[1328,{"./logging-utils":1326,"./utils/cache":1329,"./utils/error":1330,"./utils/timeout":1332,"@metamask/json-rpc-engine":1484,"klona/full":4192},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createRetryOnEmptyMiddleware=void 0;const n=e("@metamask/json-rpc-engine"),s=e("klona/full"),o=e("./logging-utils"),i=e("./utils/cache"),a=e("./utils/error"),c=e("./utils/timeout"),l=(0,o.createModuleLogger)(o.projectLogger,"retry-on-empty"),u=[undefined,null,"<nil>"];r.createRetryOnEmptyMiddleware=function({provider:e,blockTracker:t}={}){if(!e)throw Error('RetryOnEmptyMiddleware - mandatory "provider" option is missing.');if(!t)throw Error('RetryOnEmptyMiddleware - mandatory "blockTracker" option is missing.');return(0,n.createAsyncMiddleware)((async(r,n,o)=>{const d=(0,i.blockTagParamIndex)(r.method);if(d===undefined)return o();let h=Array.isArray(r.params)&&r.params[d]?r.params[d]:undefined;if(h===undefined&&(h="latest"),["latest","pending"].includes(h))return o();const p=Number.parseInt(h.slice(2),16);if(Number.isNaN(p))return o();const m=await t.getLatestBlock(),g=Number.parseInt(m.slice(2),16);if(p>g)return l("Requested block number %o is higher than latest block number %o, falling through to original request",p,g),o();l("Requested block number %o is not higher than latest block number %o, trying request until non-empty response is received",p,g);const f=(0,s.klona)(r),y=await async function(e,t){for(let r=0;r<e;r++)try{return await t()}catch(e){if((0,a.isExecutionRevertedError)(e))throw e;l("(call %i) Request failed, waiting 1s to retry again...",r+1),await(0,c.timeout)(1e3)}throw l("Retries exhausted"),new Error("RetryOnEmptyMiddleware - retries exhausted")}(10,(async()=>{l("Performing request %o",f);const t=await e.request(f);l("Result is %o",t);if(u.includes(t))throw new Error(`RetryOnEmptyMiddleware - empty result "${JSON.stringify(t)}" for request "${JSON.stringify(f)}"`);return t}));return l("Copying result %o",y),n.result=y,undefined}))}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/retryOnEmpty.js"}],[1329,{"safe-stable-stringify":4753},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.cacheTypeForMethod=r.blockTagParamIndex=r.blockTagForRequest=r.canCache=r.cacheIdentifierForRequest=r.CacheStrategy=void 0;const n=(0,e("safe-stable-stringify").configure)({bigint:!1,circularValue:Error});var s;function o(e){return a(e)!==s.Never}function i(e){switch(e){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":return 1;case"eth_getBlockByNumber":return 0;default:return undefined}}function a(e){switch(e){case"web3_clientVersion":case"web3_sha3":case"eth_protocolVersion":case"eth_getBlockTransactionCountByHash":case"eth_getUncleCountByBlockHash":case"eth_getCode":case"eth_getBlockByHash":case"eth_getTransactionByHash":case"eth_getTransactionByBlockHashAndIndex":case"eth_getTransactionReceipt":case"eth_getUncleByBlockHashAndIndex":case"eth_getCompilers":case"eth_compileLLL":case"eth_compileSolidity":case"eth_compileSerpent":case"shh_version":case"test_permaCache":return s.Permanent;case"eth_getBlockByNumber":case"eth_getBlockTransactionCountByNumber":case"eth_getUncleCountByBlockNumber":case"eth_getTransactionByBlockNumberAndIndex":case"eth_getUncleByBlockNumberAndIndex":case"test_forkCache":return s.Fork;case"eth_gasPrice":case"eth_blockNumber":case"eth_getBalance":case"eth_getStorageAt":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":case"eth_getFilterLogs":case"eth_getLogs":case"test_blockCache":return s.Block;default:return s.Never}}!function(e){e.Block="block",e.Fork="fork",e.Never="never",e.Permanent="perma"}(s=r.CacheStrategy||(r.CacheStrategy={})),r.cacheIdentifierForRequest=function(e,t){var r;const s=t?function(e){if(!e.params)return[];const t=i(e.method);if(t===undefined||!Array.isArray(e.params)||t>=e.params.length)return e.params;if("eth_getBlockByNumber"===e.method)return e.params.slice(1);return e.params.slice(0,t)}(e):null!==(r=e.params)&&void 0!==r?r:[];return o(e.method)?`${e.method}:${n(s)}`:null},r.canCache=o,r.blockTagForRequest=function(e){if(!e.params)return undefined;const t=i(e.method);return t===undefined||!Array.isArray(e.params)||t>=e.params.length?undefined:e.params[t]},r.blockTagParamIndex=i,r.cacheTypeForMethod=a}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/utils/cache.js"}],[133,{"../../../../shared/constants/security-provider":4983,"../ppom/ppom-util":96,"@metamask/keyring-api":1566,"ethereumjs-util":3776},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.addDappTransaction=async function(e){const{dappRequest:t}=e,{id:r,method:n,origin:s}=t,{securityAlertResponse:o}=t,i={actionId:r,method:n,origin:s,requireApproval:!0,securityAlertResponse:o},{waitForHash:c}=await a({...e,transactionOptions:i});return await c()},r.addTransaction=async function(e){!function(e){const{chainId:t,ppomController:r,securityAlertsEnabled:n,transactionOptions:s,transactionParams:a,updateSecurityAlertResponse:c}=e,{type:l}=s,u=i.SECURITY_PROVIDER_EXCLUDED_TRANSACTION_TYPES.includes(l);if(!n||!i.SECURITY_PROVIDER_SUPPORTED_CHAIN_IDS.includes(t)||u)return;try{const{from:n,to:l,value:u,data:d}=a,{actionId:h,origin:p}=s,m={method:"eth_sendTransaction",id:h??"",origin:p??"",params:[{from:n,to:l??"",value:u??"",data:d??""}],jsonrpc:"2.0"},g=(0,o.generateSecurityAlertId)();(0,o.validateRequestWithPPOM)({ppomController:r,request:m,securityAlertId:g,chainId:t}).then((e=>{c(m.method,g,e)}));const f={...i.LOADING_SECURITY_ALERT_RESPONSE,securityAlertId:g};e.transactionOptions.securityAlertResponse=f}catch(e){(0,o.handlePPOMError)(e,"Error validating JSON RPC using PPOM: ")}}(e);const{transactionMeta:t,waitForHash:r}=await a(e);if(!e.waitForSubmit)return r().catch((()=>{})),t;const n=await r();return function(e,t){return t.state.transactions.find((t=>t.hash===e))}(n,e.transactionController)};var n=e("@metamask/keyring-api"),s=e("ethereumjs-util"),o=e("../ppom/ppom-util"),i=e("../../../../shared/constants/security-provider");async function a(e){const{selectedAccount:t}=e;return t.type===n.EthAccountType.Erc4337?async function(e){var t;const{networkClientId:r,transactionController:n,transactionOptions:o,transactionParams:i,userOperationController:a}=e,{maxFeePerGas:l,maxPriorityFeePerGas:u}=i,{origin:d,requireApproval:h,type:p}=o,m={...i,maxFeePerGas:(0,s.addHexPrefix)(l),maxPriorityFeePerGas:(0,s.addHexPrefix)(u)},g=null==o||null===(t=o.swaps)||void 0===t?void 0:t.meta;null!=g&&g.type&&delete g.type;const f={networkClientId:r,origin:d,requireApproval:h,swaps:g,type:p},y=await a.addUserOperationFromTransaction(m,f);a.startPollingByNetworkClientId(r);return{transactionMeta:c(y.id,n),waitForHash:y.transactionHash}}(e):async function(e){const{transactionController:t,transactionOptions:r,transactionParams:n,networkClientId:s}=e,{result:o,transactionMeta:i}=await t.addTransaction(n,{...r});return{transactionMeta:i,waitForHash:()=>o}}(e)}function c(e,t){return t.state.transactions.find((t=>t.id===e))}}}},{package:"$root$",file:"app/scripts/lib/transaction/util.ts"}],[1330,{"@metamask/rpc-errors":1884,"@metamask/utils":1344},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isExecutionRevertedError=void 0;const n=e("@metamask/rpc-errors"),s=e("@metamask/utils");r.isExecutionRevertedError=function(e){return(0,s.isJsonRpcError)(e)&&e.code===n.errorCodes.rpc.invalidInput&&"execution reverted"===e.message}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/utils/error.js"}],[1331,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){return"string"!=typeof e?e:JSON.parse(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.parseTypedMessage=r.normalizeTypedMessage=void 0,r.normalizeTypedMessage=function(e){var t;let r;try{r=n(e)}catch(t){return e}const{verifyingContract:s}=null!==(t=r.domain)&&void 0!==t?t:{};return s?(r.domain.verifyingContract=function(e){if(e.startsWith("0X"))return`0x${e.slice(2)}`;return e}(s),JSON.stringify(r)):e},r.parseTypedMessage=n}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/utils/normalize.js"}],[1332,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.timeout=void 0,r.timeout=async function(e){return new Promise((t=>setTimeout(t,e)))}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/utils/timeout.js"}],[1333,{"./utils/normalize":1331,"@metamask/eth-sig-util":1365,"@metamask/json-rpc-engine":1484,"@metamask/rpc-errors":1884,"@metamask/utils":1344},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.createWalletMiddleware=void 0;const i=o(e("@metamask/eth-sig-util")),a=e("@metamask/json-rpc-engine"),c=e("@metamask/rpc-errors"),l=e("@metamask/utils"),u=e("./utils/normalize");function d(e){const{domain:{verifyingContract:t}={}}=(0,u.parseTypedMessage)(e);if(t&&"cosmos"!==t&&!(0,l.isValidHexAddress)(t))throw c.rpcErrors.invalidInput()}function h(e){return 42===e.length}r.createWalletMiddleware=function({getAccounts:e,processDecryptMessage:t,processEncryptionPublicKey:r,processEthSignMessage:n,processPersonalMessage:s,processTransaction:o,processSignTransaction:l,processTypedMessage:p,processTypedMessageV3:m,processTypedMessageV4:g}){if(!e)throw new Error("opts.getAccounts is required");return(0,a.createScaffoldMiddleware)({eth_accounts:(0,a.createAsyncMiddleware)((async function(t,r){r.result=await e(t)})),eth_coinbase:(0,a.createAsyncMiddleware)((async function(t,r){const n=await e(t);r.result=n[0]||null})),eth_sendTransaction:(0,a.createAsyncMiddleware)((async function(e,t){if(!o)throw c.rpcErrors.methodNotSupported();if(!(e.params&&Array.isArray(e.params)&&e.params.length>=1))throw c.rpcErrors.invalidInput();const r=e.params[0],n=Object.assign(Object.assign({},r),{from:await f((null==r?void 0:r.from)||"",e)});t.result=await o(n,e)})),eth_signTransaction:(0,a.createAsyncMiddleware)((async function(e,t){if(!l)throw c.rpcErrors.methodNotSupported();if(!(e.params&&Array.isArray(e.params)&&e.params.length>=1))throw c.rpcErrors.invalidInput();const r=e.params[0],n=Object.assign(Object.assign({},r),{from:await f((null==r?void 0:r.from)||"",e)});t.result=await l(n,e)})),eth_sign:(0,a.createAsyncMiddleware)((async function(e,t){if(!n)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,s=await f(r[0],e),o=r[1],i=r[2]||{},a=Object.assign(Object.assign({},i),{from:s,data:o,signatureMethod:"eth_sign"});t.result=await n(a,e)})),eth_signTypedData:(0,a.createAsyncMiddleware)((async function(e,t){if(!p)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,n=r[0],s=await f(r[1],e),o=r[2]||{},i=Object.assign(Object.assign({},o),{from:s,data:n,signatureMethod:"eth_signTypedData",version:"V1"});t.result=await p(i,e,"V1")})),eth_signTypedData_v3:(0,a.createAsyncMiddleware)((async function(e,t){if(!m)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,n=await f(r[0],e),s=(0,u.normalizeTypedMessage)(r[1]);d(s);const o={data:s,from:n,version:"V3",signatureMethod:"eth_signTypedData_v3"};t.result=await m(o,e,"V3")})),eth_signTypedData_v4:(0,a.createAsyncMiddleware)((async function(e,t){if(!g)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,n=await f(r[0],e),s=(0,u.normalizeTypedMessage)(r[1]);d(s);const o={data:s,from:n,version:"V4",signatureMethod:"eth_signTypedData_v4"};t.result=await g(o,e,"V4")})),personal_sign:(0,a.createAsyncMiddleware)((async function(e,t){if(!s)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,n=r[0],o=r[1],i=r[2]||{};let a,l;if(h(n)&&!h(o)){let e="The eth_personalSign method requires params ordered ";e+="[message, address]. This was previously handled incorrectly, ",e+="and has been corrected automatically. ",e+="Please switch this param order for smooth behavior in the future.",t.warning=e,a=n,l=o}else l=n,a=o;a=await f(a,e);const u=Object.assign(Object.assign({},i),{from:a,data:l,signatureMethod:"personal_sign"});t.result=await s(u,e)})),eth_getEncryptionPublicKey:(0,a.createAsyncMiddleware)((async function(e,t){if(!r)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=1))throw c.rpcErrors.invalidInput();const n=e.params,s=await f(n[0],e);t.result=await r(s,e)})),eth_decrypt:(0,a.createAsyncMiddleware)((async function(e,r){if(!t)throw c.rpcErrors.methodNotSupported();if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=1))throw c.rpcErrors.invalidInput();const n=e.params,s=n[0],o=await f(n[1],e),i=n[2]||{},a=Object.assign(Object.assign({},i),{from:o,data:s});r.result=await t(a,e)})),personal_ecRecover:(0,a.createAsyncMiddleware)((async function(e,t){if(!((null==e?void 0:e.params)&&Array.isArray(e.params)&&e.params.length>=2))throw c.rpcErrors.invalidInput();const r=e.params,n=r[0],s=r[1],o=i.recoverPersonalSignature({data:n,signature:s});t.result=o}))});async function f(t,r){if("string"==typeof t&&t.length>0&&h(t)){const n=(await e(r)).map((e=>e.toLowerCase())),s=t.toLowerCase();if(n.includes(s))return s;throw c.providerErrors.unauthorized()}throw c.rpcErrors.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})}}}}},{package:"@metamask/eth-json-rpc-middleware",file:"node_modules/@metamask/eth-json-rpc-middleware/dist/wallet.js"}],[1334,{"./errors.cjs":1342,"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.assertExhaustive=r.assertStruct=r.assert=r.AssertionError=void 0;const n=e("@metamask/superstruct"),s=e("./errors.cjs");function o(e,t){return r=e,Boolean("string"==typeof r?.prototype?.constructor?.name)?new e({message:t}):e({message:t});var r}class i extends Error{constructor(e){super(e.message),this.code="ERR_ASSERTION"}}r.AssertionError=i,r.assert=function(e,t="Assertion failed.",r=i){if(!e){if(t instanceof Error)throw t;throw o(r,t)}},r.assertStruct=function(e,t,r="Assertion failed",a=i){try{(0,n.assert)(e,t)}catch(e){throw o(a,`${r}: ${function(e){return(0,s.getErrorMessage)(e).replace(/\.$/u,"")}(e)}.`)}},r.assertExhaustive=function(e){throw new Error("Invalid branch reached. Should be detected during compilation.")}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/assert.cjs"}],[1335,{"./assert.cjs":1334,"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.base64=void 0;const n=e("@metamask/superstruct"),s=e("./assert.cjs");r.base64=(e,t={})=>{const r=t.paddingRequired??!1,o=t.characterSet??"base64";let i,a;return"base64"===o?i=String.raw`[A-Za-z0-9+\/]`:((0,s.assert)("base64url"===o),i=String.raw`[-_A-Za-z0-9]`),a=r?new RegExp(`^(?:${i}{4})*(?:${i}{3}=|${i}{2}==)?$`,"u"):new RegExp(`^(?:${i}{4})*(?:${i}{2,3}|${i}{3}=|${i}{2}==)?$`,"u"),(0,n.pattern)(e,a)}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/base64.cjs"}],[1336,{"./assert.cjs":1334,"./hex.cjs":1343,"@scure/base":2797,buffer:3520},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.createDataView=r.concatBytes=r.valueToBytes=r.base64ToBytes=r.stringToBytes=r.numberToBytes=r.signedBigIntToBytes=r.bigIntToBytes=r.hexToBytes=r.bytesToBase64=r.bytesToString=r.bytesToNumber=r.bytesToSignedBigInt=r.bytesToBigInt=r.bytesToHex=r.assertIsBytes=r.isBytes=void 0;const n=e("@scure/base"),s=e("./assert.cjs"),o=e("./hex.cjs"),i=48,a=58,c=87;const l=function(){const e=[];return()=>{if(0===e.length)for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return e}}();function u(e){return e instanceof Uint8Array}function d(e){(0,s.assert)(u(e),"Value must be a Uint8Array.")}function h(e){if(d(e),0===e.length)return"0x";const t=l(),r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=t[e[n]];return(0,o.add0x)(r.join(""))}function p(e){d(e);const t=h(e);return BigInt(t)}function m(e){if("0x"===e?.toLowerCase?.())return new Uint8Array;(0,o.assertIsHexString)(e);const t=(0,o.remove0x)(e).toLowerCase(),r=t.length%2==0?t:`0${t}`,n=new Uint8Array(r.length/2);for(let e=0;e<n.length;e++){const t=r.charCodeAt(2*e),s=r.charCodeAt(2*e+1),o=t-(t<a?i:c),l=s-(s<a?i:c);n[e]=16*o+l}return n}function g(e){(0,s.assert)("bigint"==typeof e,"Value must be a bigint."),(0,s.assert)(e>=BigInt(0),"Value must be a non-negative bigint.");return m(e.toString(16))}function f(e){(0,s.assert)("number"==typeof e,"Value must be a number."),(0,s.assert)(e>=0,"Value must be a non-negative number."),(0,s.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToBytes` instead.");return m(e.toString(16))}function y(e){return(0,s.assert)("string"==typeof e,"Value must be a string."),(new TextEncoder).encode(e)}function w(e){if("bigint"==typeof e)return g(e);if("number"==typeof e)return f(e);if("string"==typeof e)return e.startsWith("0x")?m(e):y(e);if(u(e))return e;throw new TypeError(`Unsupported value type: "${typeof e}".`)}r.isBytes=u,r.assertIsBytes=d,r.bytesToHex=h,r.bytesToBigInt=p,r.bytesToSignedBigInt=function(e){d(e);let t=BigInt(0);for(const r of e)t=(t<<BigInt(8))+BigInt(r);return BigInt.asIntN(8*e.length,t)},r.bytesToNumber=function(e){d(e);const t=p(e);return(0,s.assert)(t<=BigInt(Number.MAX_SAFE_INTEGER),"Number is not a safe integer. Use `bytesToBigInt` instead."),Number(t)},r.bytesToString=function(e){return d(e),(new TextDecoder).decode(e)},r.bytesToBase64=function(e){return d(e),n.base64.encode(e)},r.hexToBytes=m,r.bigIntToBytes=g,r.signedBigIntToBytes=function(e,t){(0,s.assert)("bigint"==typeof e,"Value must be a bigint."),(0,s.assert)("number"==typeof t,"Byte length must be a number."),(0,s.assert)(t>0,"Byte length must be greater than 0."),(0,s.assert)(function(e,t){(0,s.assert)(t>0);const r=e>>BigInt(31);return!((~e&r)+(e&~r)>>BigInt(8*t-1))}(e,t),"Byte length is too small to represent the given value.");let r=e;const n=new Uint8Array(t);for(let e=0;e<n.length;e++)n[e]=Number(BigInt.asUintN(8,r)),r>>=BigInt(8);return n.reverse()},r.numberToBytes=f,r.stringToBytes=y,r.base64ToBytes=function(e){return(0,s.assert)("string"==typeof e,"Value must be a string."),n.base64.decode(e)},r.valueToBytes=w,r.concatBytes=function(e){const t=new Array(e.length);let r=0;for(let n=0;n<e.length;n++){const s=w(e[n]);t[n]=s,r+=s.length}const n=new Uint8Array(r);for(let e=0,r=0;e<t.length;e++)n.set(t[e],r),r+=t[e].length;return n},r.createDataView=function(e){if(void 0!==t&&e instanceof t){const t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return new DataView(t)}return new DataView(e.buffer,e.byteOffset,e.byteLength)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/bytes.cjs"}],[1337,{"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.toCaipChainId=r.parseCaipAccountId=r.parseCaipChainId=r.isCaipAccountAddress=r.isCaipAccountId=r.isCaipReference=r.isCaipNamespace=r.isCaipChainId=r.KnownCaipNamespace=r.CaipAccountAddressStruct=r.CaipAccountIdStruct=r.CaipReferenceStruct=r.CaipNamespaceStruct=r.CaipChainIdStruct=r.CAIP_ACCOUNT_ADDRESS_REGEX=r.CAIP_ACCOUNT_ID_REGEX=r.CAIP_REFERENCE_REGEX=r.CAIP_NAMESPACE_REGEX=r.CAIP_CHAIN_ID_REGEX=void 0;const n=e("@metamask/superstruct");function s(e){return(0,n.is)(e,r.CaipNamespaceStruct)}function o(e){return(0,n.is)(e,r.CaipReferenceStruct)}r.CAIP_CHAIN_ID_REGEX=/^(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})$/u,r.CAIP_NAMESPACE_REGEX=/^[-a-z0-9]{3,8}$/u,r.CAIP_REFERENCE_REGEX=/^[-_a-zA-Z0-9]{1,32}$/u,r.CAIP_ACCOUNT_ID_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})):(?<accountAddress>[-.%a-zA-Z0-9]{1,128})$/u,r.CAIP_ACCOUNT_ADDRESS_REGEX=/^[-.%a-zA-Z0-9]{1,128}$/u,r.CaipChainIdStruct=(0,n.pattern)((0,n.string)(),r.CAIP_CHAIN_ID_REGEX),r.CaipNamespaceStruct=(0,n.pattern)((0,n.string)(),r.CAIP_NAMESPACE_REGEX),r.CaipReferenceStruct=(0,n.pattern)((0,n.string)(),r.CAIP_REFERENCE_REGEX),r.CaipAccountIdStruct=(0,n.pattern)((0,n.string)(),r.CAIP_ACCOUNT_ID_REGEX),r.CaipAccountAddressStruct=(0,n.pattern)((0,n.string)(),r.CAIP_ACCOUNT_ADDRESS_REGEX),function(e){e.Eip155="eip155",e.Wallet="wallet"}(r.KnownCaipNamespace||(r.KnownCaipNamespace={})),r.isCaipChainId=function(e){return(0,n.is)(e,r.CaipChainIdStruct)},r.isCaipNamespace=s,r.isCaipReference=o,r.isCaipAccountId=function(e){return(0,n.is)(e,r.CaipAccountIdStruct)},r.isCaipAccountAddress=function(e){return(0,n.is)(e,r.CaipAccountAddressStruct)},r.parseCaipChainId=function(e){const t=r.CAIP_CHAIN_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP chain ID.");return{namespace:t.groups.namespace,reference:t.groups.reference}},r.parseCaipAccountId=function(e){const t=r.CAIP_ACCOUNT_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP account ID.");return{address:t.groups.accountAddress,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}},r.toCaipChainId=function(e,t){if(!s(e))throw new Error(`Invalid "namespace", must match: ${r.CAIP_NAMESPACE_REGEX.toString()}`);if(!o(t))throw new Error(`Invalid "reference", must match: ${r.CAIP_REFERENCE_REGEX.toString()}`);return`${e}:${t}`}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/caip-types.cjs"}],[1338,{"./base64.cjs":1335,"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ChecksumStruct=void 0;const n=e("@metamask/superstruct"),s=e("./base64.cjs");r.ChecksumStruct=(0,n.size)((0,s.base64)((0,n.string)(),{paddingRequired:!0}),44,44)}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/checksum.cjs"}],[1339,{"./assert.cjs":1334,"./bytes.cjs":1336,"./hex.cjs":1343,"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createHex=r.createBytes=r.createBigInt=r.createNumber=void 0;const n=e("@metamask/superstruct"),s=e("./assert.cjs"),o=e("./bytes.cjs"),i=e("./hex.cjs"),a=(0,n.union)([(0,n.number)(),(0,n.bigint)(),(0,n.string)(),i.StrictHexStruct]),c=(0,n.coerce)((0,n.number)(),a,Number),l=(0,n.coerce)((0,n.bigint)(),a,BigInt),u=((0,n.union)([i.StrictHexStruct,(0,n.instance)(Uint8Array)]),(0,n.coerce)((0,n.instance)(Uint8Array),(0,n.union)([i.StrictHexStruct]),o.hexToBytes)),d=(0,n.coerce)(i.StrictHexStruct,(0,n.instance)(Uint8Array),o.bytesToHex);r.createNumber=function(e){try{const t=(0,n.create)(e,c);return(0,s.assert)(Number.isFinite(t),`Expected a number-like value, got "${e}".`),t}catch(t){if(t instanceof n.StructError)throw new Error(`Expected a number-like value, got "${e}".`);throw t}},r.createBigInt=function(e){try{return(0,n.create)(e,l)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a number-like value, got "${String(e.value)}".`);throw e}},r.createBytes=function(e){if("string"==typeof e&&"0x"===e.toLowerCase())return new Uint8Array;try{return(0,n.create)(e,u)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}},r.createHex=function(e){if(e instanceof Uint8Array&&0===e.length||"string"==typeof e&&"0x"===e.toLowerCase())return"0x";try{return(0,n.create)(e,d)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/coercers.cjs"}],[134,{"../../../../shared/constants/app":4962,"../../../../shared/constants/verification":4992,"@ethersproject/hash":512,"@ethersproject/wallet":575,"@metamask/rpc-errors":1884,"@metamask/utils":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createTxVerificationMiddleware=function(e,t=a.TRUSTED_SIGNERS){return function(r,l,u,d){if(r.method!==c.MESSAGE_TYPE.ETH_SEND_TRANSACTION||!Array.isArray(r.params)||!function(e){return(0,i.isObject)(e[0])&&"string"==typeof e[0].data&&"string"==typeof e[0].from&&"string"==typeof e[0].to&&"string"==typeof e[0].value&&(!(0,i.hasProperty)(e[0],"chainId")||"string"==typeof e[0].chainId&&e[0].chainId.startsWith("0x"))}(r.params))return u();const h=r.params[0],p="string"==typeof h.chainId?h.chainId.toLowerCase():e.state.providerConfig.chainId,m=(0,a.getExperience)(h.to.toLowerCase(),p);if(!m||!a.EXPERIENCES_TO_VERIFY.includes(m))return u();const g=`0x${h.data.slice(-a.TX_SIG_LEN)}`,f=(0,s.verifyMessage)(function(e){const t={to:(0,n.hashMessage)(e.to.toLowerCase()),from:(0,n.hashMessage)(e.from.toLowerCase()),data:(0,n.hashMessage)(e.data.toLowerCase().slice(0,e.data.length-a.TX_SIG_LEN)),value:(0,n.hashMessage)(e.value.toLowerCase())};return(0,n.hashMessage)(JSON.stringify(t))}(h),g);return f!==t[m]?d(o.rpcErrors.invalidParams("Invalid transaction signature.")):u()}};var n=e("@ethersproject/hash"),s=e("@ethersproject/wallet"),o=e("@metamask/rpc-errors"),i=e("@metamask/utils"),a=e("../../../../shared/constants/verification"),c=e("../../../../shared/constants/app")}}},{package:"$root$",file:"app/scripts/lib/tx-verification/tx-verification-middleware.ts"}],[1340,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,o=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},i=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.FrozenSet=r.FrozenMap=void 0;class a{get size(){return o(this,n,"f").size}[(n=new WeakMap,Symbol.iterator)](){return o(this,n,"f")[Symbol.iterator]()}constructor(e){n.set(this,void 0),i(this,n,new Map(e),"f"),Object.freeze(this)}entries(){return o(this,n,"f").entries()}forEach(e,t){return o(this,n,"f").forEach(((r,n,s)=>e.call(t,r,n,this)))}get(e){return o(this,n,"f").get(e)}has(e){return o(this,n,"f").has(e)}keys(){return o(this,n,"f").keys()}values(){return o(this,n,"f").values()}toString(){return`FrozenMap(${this.size}) {${this.size>0?` ${[...this.entries()].map((([e,t])=>`${String(e)} => ${String(t)}`)).join(", ")} `:""}}`}}r.FrozenMap=a;class c{get size(){return o(this,s,"f").size}[(s=new WeakMap,Symbol.iterator)](){return o(this,s,"f")[Symbol.iterator]()}constructor(e){s.set(this,void 0),i(this,s,new Set(e),"f"),Object.freeze(this)}entries(){return o(this,s,"f").entries()}forEach(e,t){return o(this,s,"f").forEach(((r,n,s)=>e.call(t,r,n,this)))}has(e){return o(this,s,"f").has(e)}keys(){return o(this,s,"f").keys()}values(){return o(this,s,"f").values()}toString(){return`FrozenSet(${this.size}) {${this.size>0?` ${[...this.values()].map((e=>String(e))).join(", ")} `:""}}`}}r.FrozenSet=c,Object.freeze(a),Object.freeze(a.prototype),Object.freeze(c),Object.freeze(c.prototype)}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/collections.cjs"}],[1341,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/encryption-types.cjs"}],[1342,{"./misc.cjs":1348,"pony-cause":4459},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.wrapError=r.getErrorMessage=r.isErrorWithStack=r.isErrorWithMessage=r.isErrorWithCode=void 0;const n=e("pony-cause"),s=e("./misc.cjs");function o(e){return"object"==typeof e&&null!==e&&"code"in e}function i(e){return"object"==typeof e&&null!==e&&"message"in e}r.isErrorWithCode=o,r.isErrorWithMessage=i,r.isErrorWithStack=function(e){return"object"==typeof e&&null!==e&&"stack"in e},r.getErrorMessage=function(e){return i(e)&&"string"==typeof e.message?e.message:(0,s.isNullOrUndefined)(e)?"":String(e)},r.wrapError=function(e,t){if((r=e)instanceof Error||(0,s.isObject)(r)&&"Error"===r.constructor.name){let r;return r=2===Error.length?new Error(t,{cause:e}):new n.ErrorWithCause(t,{cause:e}),o(e)&&(r.code=e.code),r}var r;return t.length>0?new Error(`${String(e)}: ${t}`):new Error(String(e))}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/errors.cjs"}],[1343,{"./assert.cjs":1334,"./bytes.cjs":1336,"@metamask/superstruct":2618,"@noble/hashes/sha3":2779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.remove0x=r.add0x=r.isValidChecksumAddress=r.getChecksumAddress=r.isValidHexAddress=r.assertIsStrictHexString=r.assertIsHexString=r.isStrictHexString=r.isHexString=r.HexChecksumAddressStruct=r.HexAddressStruct=r.StrictHexStruct=r.HexStruct=void 0;const n=e("@metamask/superstruct"),s=e("@noble/hashes/sha3"),o=e("./assert.cjs"),i=e("./bytes.cjs");function a(e){return(0,n.is)(e,r.HexStruct)}function c(e){return(0,n.is)(e,r.StrictHexStruct)}function l(e){(0,o.assert)((0,n.is)(e,r.HexChecksumAddressStruct),"Invalid hex address.");const t=d(e.toLowerCase()),a=d((0,i.bytesToHex)((0,s.keccak_256)(t)));return`0x${t.split("").map(((e,t)=>{const r=a[t];return(0,o.assert)((0,n.is)(r,(0,n.string)()),"Hash shorter than address."),parseInt(r,16)>7?e.toUpperCase():e})).join("")}`}function u(e){return!!(0,n.is)(e,r.HexChecksumAddressStruct)&&l(e)===e}function d(e){return e.startsWith("0x")||e.startsWith("0X")?e.substring(2):e}r.HexStruct=(0,n.pattern)((0,n.string)(),/^(?:0x)?[0-9a-f]+$/iu),r.StrictHexStruct=(0,n.pattern)((0,n.string)(),/^0x[0-9a-f]+$/iu),r.HexAddressStruct=(0,n.pattern)((0,n.string)(),/^0x[0-9a-f]{40}$/u),r.HexChecksumAddressStruct=(0,n.pattern)((0,n.string)(),/^0x[0-9a-fA-F]{40}$/u),r.isHexString=a,r.isStrictHexString=c,r.assertIsHexString=function(e){(0,o.assert)(a(e),"Value must be a hexadecimal string.")},r.assertIsStrictHexString=function(e){(0,o.assert)(c(e),'Value must be a hexadecimal string, starting with "0x".')},r.isValidHexAddress=function(e){return(0,n.is)(e,r.HexAddressStruct)||u(e)},r.getChecksumAddress=l,r.isValidChecksumAddress=u,r.add0x=function(e){return e.startsWith("0x")?e:e.startsWith("0X")?`0x${e.substring(2)}`:`0x${e}`},r.remove0x=d}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/hex.cjs"}],[1344,{"./assert.cjs":1334,"./base64.cjs":1335,"./bytes.cjs":1336,"./caip-types.cjs":1337,"./checksum.cjs":1338,"./coercers.cjs":1339,"./collections.cjs":1340,"./encryption-types.cjs":1341,"./errors.cjs":1342,"./hex.cjs":1343,"./json.cjs":1345,"./keyring.cjs":1346,"./logging.cjs":1347,"./misc.cjs":1348,"./number.cjs":1349,"./opaque.cjs":1350,"./promise.cjs":1351,"./time.cjs":1352,"./transaction-types.cjs":1353,"./versions.cjs":1354},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./assert.cjs"),r),s(e("./base64.cjs"),r),s(e("./bytes.cjs"),r),s(e("./caip-types.cjs"),r),s(e("./checksum.cjs"),r),s(e("./coercers.cjs"),r),s(e("./collections.cjs"),r),s(e("./encryption-types.cjs"),r),s(e("./errors.cjs"),r),s(e("./hex.cjs"),r),s(e("./json.cjs"),r),s(e("./keyring.cjs"),r),s(e("./logging.cjs"),r),s(e("./misc.cjs"),r),s(e("./number.cjs"),r),s(e("./opaque.cjs"),r),s(e("./promise.cjs"),r),s(e("./time.cjs"),r),s(e("./transaction-types.cjs"),r),s(e("./versions.cjs"),r)}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/index.cjs"}],[1345,{"./assert.cjs":1334,"./misc.cjs":1348,"@metamask/superstruct":2618},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getJsonRpcIdValidator=r.assertIsJsonRpcError=r.isJsonRpcError=r.assertIsJsonRpcFailure=r.isJsonRpcFailure=r.assertIsJsonRpcSuccess=r.isJsonRpcSuccess=r.assertIsJsonRpcResponse=r.isJsonRpcResponse=r.assertIsPendingJsonRpcResponse=r.isPendingJsonRpcResponse=r.JsonRpcResponseStruct=r.JsonRpcFailureStruct=r.JsonRpcSuccessStruct=r.PendingJsonRpcResponseStruct=r.assertIsJsonRpcRequest=r.isJsonRpcRequest=r.assertIsJsonRpcNotification=r.isJsonRpcNotification=r.JsonRpcNotificationStruct=r.JsonRpcRequestStruct=r.JsonRpcParamsStruct=r.JsonRpcErrorStruct=r.JsonRpcIdStruct=r.JsonRpcVersionStruct=r.jsonrpc2=r.getJsonSize=r.getSafeJson=r.isValidJson=r.JsonStruct=r.UnsafeJsonStruct=r.exactOptional=r.object=void 0;const n=e("@metamask/superstruct"),s=e("./assert.cjs"),o=e("./misc.cjs");function i({path:e,branch:t}){const r=e[e.length-1];return(0,o.hasProperty)(t[t.length-2],r)}function a(e){return new n.Struct({...e,type:`optional ${e.type}`,validator:(t,r)=>!i(r)||e.validator(t,r),refiner:(t,r)=>!i(r)||e.refiner(t,r)})}r.object=e=>(0,n.object)(e),r.exactOptional=a;function c(e){return(0,n.create)(e,r.JsonStruct)}r.UnsafeJsonStruct=(0,n.union)([(0,n.literal)(null),(0,n.boolean)(),(0,n.define)("finite number",(e=>(0,n.is)(e,(0,n.number)())&&Number.isFinite(e))),(0,n.string)(),(0,n.array)((0,n.lazy)((()=>r.UnsafeJsonStruct))),(0,n.record)((0,n.string)(),(0,n.lazy)((()=>r.UnsafeJsonStruct)))]),r.JsonStruct=(0,n.coerce)(r.UnsafeJsonStruct,(0,n.any)(),(e=>((0,s.assertStruct)(e,r.UnsafeJsonStruct),JSON.parse(JSON.stringify(e,((e,t)=>"__proto__"===e||"constructor"===e?undefined:t)))))),r.isValidJson=function(e){try{return c(e),!0}catch{return!1}},r.getSafeJson=c,r.getJsonSize=function(e){(0,s.assertStruct)(e,r.JsonStruct,"Invalid JSON value");const t=JSON.stringify(e);return(new TextEncoder).encode(t).byteLength},r.jsonrpc2="2.0",r.JsonRpcVersionStruct=(0,n.literal)(r.jsonrpc2),r.JsonRpcIdStruct=(0,n.nullable)((0,n.union)([(0,n.number)(),(0,n.string)()])),r.JsonRpcErrorStruct=(0,r.object)({code:(0,n.integer)(),message:(0,n.string)(),data:a(r.JsonStruct),stack:a((0,n.string)())}),r.JsonRpcParamsStruct=(0,n.union)([(0,n.record)((0,n.string)(),r.JsonStruct),(0,n.array)(r.JsonStruct)]),r.JsonRpcRequestStruct=(0,r.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,method:(0,n.string)(),params:a(r.JsonRpcParamsStruct)}),r.JsonRpcNotificationStruct=(0,r.object)({jsonrpc:r.JsonRpcVersionStruct,method:(0,n.string)(),params:a(r.JsonRpcParamsStruct)}),r.isJsonRpcNotification=function(e){return(0,n.is)(e,r.JsonRpcNotificationStruct)},r.assertIsJsonRpcNotification=function(e,t){(0,s.assertStruct)(e,r.JsonRpcNotificationStruct,"Invalid JSON-RPC notification",t)},r.isJsonRpcRequest=function(e){return(0,n.is)(e,r.JsonRpcRequestStruct)},r.assertIsJsonRpcRequest=function(e,t){(0,s.assertStruct)(e,r.JsonRpcRequestStruct,"Invalid JSON-RPC request",t)},r.PendingJsonRpcResponseStruct=(0,n.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,result:(0,n.optional)((0,n.unknown)()),error:(0,n.optional)(r.JsonRpcErrorStruct)}),r.JsonRpcSuccessStruct=(0,r.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,result:r.JsonStruct}),r.JsonRpcFailureStruct=(0,r.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,error:r.JsonRpcErrorStruct}),r.JsonRpcResponseStruct=(0,n.union)([r.JsonRpcSuccessStruct,r.JsonRpcFailureStruct]),r.isPendingJsonRpcResponse=function(e){return(0,n.is)(e,r.PendingJsonRpcResponseStruct)},r.assertIsPendingJsonRpcResponse=function(e,t){(0,s.assertStruct)(e,r.PendingJsonRpcResponseStruct,"Invalid pending JSON-RPC response",t)},r.isJsonRpcResponse=function(e){return(0,n.is)(e,r.JsonRpcResponseStruct)},r.assertIsJsonRpcResponse=function(e,t){(0,s.assertStruct)(e,r.JsonRpcResponseStruct,"Invalid JSON-RPC response",t)},r.isJsonRpcSuccess=function(e){return(0,n.is)(e,r.JsonRpcSuccessStruct)},r.assertIsJsonRpcSuccess=function(e,t){(0,s.assertStruct)(e,r.JsonRpcSuccessStruct,"Invalid JSON-RPC success response",t)},r.isJsonRpcFailure=function(e){return(0,n.is)(e,r.JsonRpcFailureStruct)},r.assertIsJsonRpcFailure=function(e,t){(0,s.assertStruct)(e,r.JsonRpcFailureStruct,"Invalid JSON-RPC failure response",t)},r.isJsonRpcError=function(e){return(0,n.is)(e,r.JsonRpcErrorStruct)},r.assertIsJsonRpcError=function(e,t){(0,s.assertStruct)(e,r.JsonRpcErrorStruct,"Invalid JSON-RPC error",t)},r.getJsonRpcIdValidator=function(e){const{permitEmptyString:t,permitFractions:r,permitNull:n}={permitEmptyString:!0,permitFractions:!1,permitNull:!0,...e};return e=>Boolean("number"==typeof e&&(r||Number.isInteger(e))||"string"==typeof e&&(t||e.length>0)||n&&null===e)}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/json.cjs"}],[1346,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/keyring.cjs"}],[1347,{debug:3665},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.createProjectLogger=void 0;const s=(0,n(e("debug")).default)("metamask");r.createProjectLogger=function(e){return s.extend(e)},r.createModuleLogger=function(e,t){return e.extend(t)}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/logging.cjs"}],[1348,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.calculateNumberSize=r.calculateStringSize=r.isASCII=r.isPlainObject=r.ESCAPE_CHARACTERS_REGEXP=r.JsonSize=r.getKnownPropertyNames=r.hasProperty=r.isObject=r.isNullOrUndefined=r.isNonEmptyArray=void 0,r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isNullOrUndefined=function(e){return null===e||e===undefined},r.isObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)};function n(e){return e.charCodeAt(0)<=127}r.hasProperty=(e,t)=>Object.hasOwnProperty.call(e,t),r.getKnownPropertyNames=function(e){return Object.getOwnPropertyNames(e)},function(e){e[e.Null=4]="Null",e[e.Comma=1]="Comma",e[e.Wrapper=1]="Wrapper",e[e.True=4]="True",e[e.False=5]="False",e[e.Quote=1]="Quote",e[e.Colon=1]="Colon",e[e.Date=24]="Date"}(r.JsonSize||(r.JsonSize={})),r.ESCAPE_CHARACTERS_REGEXP=/"|\\|\n|\r|\t/gu,r.isPlainObject=function(e){if("object"!=typeof e||null===e)return!1;try{let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}catch(e){return!1}},r.isASCII=n,r.calculateStringSize=function(e){return e.split("").reduce(((e,t)=>n(t)?e+1:e+2),0)+(e.match(r.ESCAPE_CHARACTERS_REGEXP)??[]).length},r.calculateNumberSize=function(e){return e.toString().length}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/misc.cjs"}],[1349,{"./assert.cjs":1334,"./hex.cjs":1343},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.hexToBigInt=r.hexToNumber=r.bigIntToHex=r.numberToHex=void 0;const n=e("./assert.cjs"),s=e("./hex.cjs");r.numberToHex=e=>((0,n.assert)("number"==typeof e,"Value must be a number."),(0,n.assert)(e>=0,"Value must be a non-negative number."),(0,n.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToHex` instead."),(0,s.add0x)(e.toString(16)));r.bigIntToHex=e=>((0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)(e>=0,"Value must be a non-negative bigint."),(0,s.add0x)(e.toString(16)));r.hexToNumber=e=>{(0,s.assertIsHexString)(e);const t=parseInt(e,16);return(0,n.assert)(Number.isSafeInteger(t),"Value is not a safe integer. Use `hexToBigInt` instead."),t};r.hexToBigInt=e=>((0,s.assertIsHexString)(e),BigInt((0,s.add0x)(e)))}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/number.cjs"}],[1350,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/opaque.cjs"}],[1351,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createDeferredPromise=void 0,r.createDeferredPromise=function({suppressUnhandledRejection:e=!1}={}){let t,r;const n=new Promise(((e,n)=>{t=e,r=n}));return e&&n.catch((e=>{})),{promise:n,resolve:t,reject:r}}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/promise.cjs"}],[1352,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.timeSince=r.inMilliseconds=r.Duration=void 0,function(e){e[e.Millisecond=1]="Millisecond",e[e.Second=1e3]="Second",e[e.Minute=6e4]="Minute",e[e.Hour=36e5]="Hour",e[e.Day=864e5]="Day",e[e.Week=6048e5]="Week",e[e.Year=31536e6]="Year"}(r.Duration||(r.Duration={}));const n=(e,t)=>{if(!(e=>Number.isInteger(e)&&e>=0)(e))throw new Error(`"${t}" must be a non-negative integer. Received: "${e}".`)};r.inMilliseconds=function(e,t){return n(e,"count"),e*t},r.timeSince=function(e){return n(e,"timestamp"),Date.now()-e}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/time.cjs"}],[1353,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/transaction-types.cjs"}],[1354,{"./assert.cjs":1334,"@metamask/superstruct":2618,semver:4785},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.satisfiesVersionRange=r.gtRange=r.gtVersion=r.assertIsSemVerRange=r.assertIsSemVerVersion=r.isValidSemVerRange=r.isValidSemVerVersion=r.VersionRangeStruct=r.VersionStruct=void 0;const n=e("@metamask/superstruct"),s=e("semver"),o=e("./assert.cjs");r.VersionStruct=(0,n.refine)((0,n.string)(),"Version",(e=>null!==(0,s.valid)(e)||`Expected SemVer version, got "${e}"`)),r.VersionRangeStruct=(0,n.refine)((0,n.string)(),"Version range",(e=>null!==(0,s.validRange)(e)||`Expected SemVer range, got "${e}"`)),r.isValidSemVerVersion=function(e){return(0,n.is)(e,r.VersionStruct)},r.isValidSemVerRange=function(e){return(0,n.is)(e,r.VersionRangeStruct)},r.assertIsSemVerVersion=function(e){(0,o.assertStruct)(e,r.VersionStruct)},r.assertIsSemVerRange=function(e){(0,o.assertStruct)(e,r.VersionRangeStruct)},r.gtVersion=function(e,t){return(0,s.gt)(e,t)},r.gtRange=function(e,t){return(0,s.gtr)(e,t)},r.satisfiesVersionRange=function(e,t){return(0,s.satisfies)(e,t,{includePrerelease:!0})}}}},{package:"@metamask/eth-json-rpc-middleware>@metamask/utils",file:"node_modules/@metamask/eth-json-rpc-middleware/node_modules/@metamask/utils/dist/versions.cjs"}],[1359,{"./ledger-bridge":1360,"./ledger-iframe-bridge":1361,"./ledger-keyring":1362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./ledger-keyring"),r),s(e("./ledger-iframe-bridge"),r),s(e("./ledger-bridge"),r)}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/index.js"}],[136,{"../../shared/constants/app":4962,"../../shared/constants/hardware-wallets":4969,"../../shared/constants/keyring":4970,"../../shared/constants/logs":4972,"../../shared/constants/metametrics":4973,"../../shared/constants/methods-tags":4974,"../../shared/constants/network":4977,"../../shared/constants/permissions":4981,"../../shared/constants/smartTransactions":4984,"../../shared/constants/swaps":4986,"../../shared/constants/time":4988,"../../shared/constants/tokens":4989,"../../shared/constants/transaction":4990,"../../shared/constants/urls":4991,"../../shared/lib/metamask-controller-utils":4996,"../../shared/lib/token-util":5001,"../../shared/lib/trace":5002,"../../shared/lib/transactions-controller-utils":5003,"../../shared/modules/caip-stream":5008,"../../shared/modules/mv3.utils":5020,"../../shared/modules/network.utils":5021,"../../shared/modules/selectors":5027,"../../shared/modules/string-utils":5030,"../../shared/modules/transaction.utils":5032,"../../shared/notifications":5034,"./controllers/account-order":7,"./controllers/alert":8,"./controllers/app-metadata":9,"./controllers/app-state":10,"./controllers/authentication/authentication-controller":12,"./controllers/bridge":14,"./controllers/decrypt-message":15,"./controllers/encryption-public-key":16,"./controllers/metamask-notifications/metamask-notifications":19,"./controllers/metametrics":26,"./controllers/network-order":27,"./controllers/onboarding":28,"./controllers/permissions":32,"./controllers/preferences":35,"./controllers/push-platform-notifications/push-platform-notifications":36,"./controllers/swaps":43,"./controllers/user-storage/user-storage-controller":51,"./detect-multiple-instances":52,"./lib/AccountIdentitiesPetnamesBridge":55,"./lib/AddressBookPetnamesBridge":56,"./lib/ComposableObservableStore":57,"./lib/SnapsNameProvider":58,"./lib/WeakRefObjectMap":59,"./lib/account-tracker":60,"./lib/accounts/BalancesController":61,"./lib/backup":64,"./lib/createDupeReqFilterStream":65,"./lib/createEvmMethodsToNonEvmAccountReqFilterMiddleware":66,"./lib/createLoggerMiddleware":67,"./lib/createMetaRPCHandler":68,"./lib/createMetamaskMiddleware":69,"./lib/createOnboardingMiddleware":70,"./lib/createOriginMiddleware":71,"./lib/createRPCMethodTrackingMiddleware":72,"./lib/createTabIdMiddleware":74,"./lib/encryptor-factory":75,"./lib/hardware-keyring-builder-factory":83,"./lib/multichain/address":88,"./lib/offscreen-bridge/lattice-offscreen-keyring":91,"./lib/offscreen-bridge/ledger-offscreen-bridge":92,"./lib/offscreen-bridge/trezor-offscreen-bridge":93,"./lib/ppom/indexed-db-backend":94,"./lib/ppom/ppom":97,"./lib/ppom/ppom-middleware":95,"./lib/ppom/ppom-util":96,"./lib/rpc-method-middleware":111,"./lib/segment":113,"./lib/snap-keyring":118,"./lib/snap-keyring/keyring-snaps-permissions":119,"./lib/stream-utils":124,"./lib/transaction/decode/util":130,"./lib/transaction/metrics":131,"./lib/transaction/smart-transactions":132,"./lib/transaction/util":133,"./lib/tx-verification/tx-verification-middleware":134,"./lib/util":135,"./snaps/preinstalled-snaps":277,"./translate":278,"@ethersproject/abi":483,"@keystonehq/metamask-airgapped-keyring":632,"@metamask/accounts-controller":1124,"@metamask/address-book-controller":1153,"@metamask/announcement-controller":1161,"@metamask/approval-controller":1164,"@metamask/assets-controllers":1196,"@metamask/base-controller":1235,"@metamask/controller-utils":1245,"@metamask/ens-controller":1269,"@metamask/eth-json-rpc-filters":1287,"@metamask/eth-json-rpc-filters/subscriptionManager":1301,"@metamask/eth-json-rpc-middleware":1324,"@metamask/eth-ledger-bridge-keyring":1359,"@metamask/eth-query":1363,"@metamask/eth-trezor-keyring":1421,"@metamask/ethjs-query":1438,"@metamask/gas-fee-controller":1446,"@metamask/keyring-api":1566,"@metamask/keyring-controller":1619,"@metamask/logging-controller":1626,"@metamask/metamask-eth-abis":1654,"@metamask/name-controller":1665,"@metamask/network-controller":1706,"@metamask/notification-controller":1771,"@metamask/obs-store":1782,"@metamask/obs-store/dist/asStream":1781,"@metamask/permission-controller":1796,"@metamask/permission-log-controller":1834,"@metamask/phishing-controller":1836,"@metamask/ppom-validator":1854,"@metamask/queued-request-controller":1871,"@metamask/rate-limit-controller":1879,"@metamask/scure-bip39/dist/wordlists/english":1908,"@metamask/selected-network-controller":1920,"@metamask/signature-controller":1928,"@metamask/smart-transactions-controller":1946,"@metamask/snaps-controllers":2153,"@metamask/snaps-rpc-methods":2467,"@metamask/snaps-utils":2616,"@metamask/transaction-controller":2660,"@metamask/user-operation-controller":2707,"@sentry/browser":2853,"await-semaphore":3414,buffer:3520,"eth-lattice-keyring":3713,"eth-rpc-errors":3745,events:3814,"json-rpc-engine":4166,"json-rpc-middleware-stream":4171,lodash:4322,loglevel:4328,nanoid:4415,"readable-stream":4734},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.METAMASK_CONTROLLER_EVENTS=void 0;var n=Nt(e("events")),s=e("readable-stream"),o=e("@metamask/assets-controllers"),i=e("@metamask/obs-store"),a=e("@metamask/obs-store/dist/asStream"),c=e("json-rpc-engine"),l=e("json-rpc-middleware-stream"),u=e("@metamask/eth-json-rpc-middleware"),d=e("lodash"),h=e("@metamask/keyring-controller"),p=Nt(e("@metamask/eth-json-rpc-filters")),m=Nt(e("@metamask/eth-json-rpc-filters/subscriptionManager")),g=e("eth-rpc-errors"),f=e("await-semaphore"),y=Nt(e("loglevel")),w=e("@metamask/eth-trezor-keyring"),C=e("@metamask/eth-ledger-bridge-keyring"),k=Nt(e("eth-lattice-keyring")),v=e("@keystonehq/metamask-airgapped-keyring"),b=Nt(e("@metamask/eth-query")),S=Nt(e("@metamask/ethjs-query")),T=Nt(e("nanoid")),_=e("@sentry/browser"),E=e("@metamask/address-book-controller"),A=e("@metamask/approval-controller"),M=e("@metamask/base-controller"),P=e("@metamask/ens-controller"),I=e("@metamask/phishing-controller"),R=e("@metamask/announcement-controller"),N=e("@metamask/network-controller"),j=e("@metamask/gas-fee-controller"),x=e("@metamask/permission-controller"),O=Nt(e("@metamask/smart-transactions-controller")),B=e("@metamask/selected-network-controller"),U=e("@metamask/logging-controller"),F=e("@metamask/permission-log-controller"),D=e("@metamask/rate-limit-controller"),L=e("@metamask/notification-controller"),H=e("@metamask/snaps-controllers"),$=e("@metamask/snaps-rpc-methods"),q=e("@metamask/accounts-controller"),K=e("@metamask/signature-controller"),G=e("@metamask/ppom-validator"),W=e("@metamask/controller-utils"),V=e("@metamask/scure-bip39/dist/wordlists/english"),J=e("@metamask/name-controller"),z=e("@metamask/queued-request-controller"),Y=e("@metamask/user-operation-controller"),X=e("@metamask/transaction-controller"),Q=e("@metamask/snaps-utils"),Z=e("@ethersproject/abi"),ee=e("@metamask/metamask-eth-abis"),te=e("@metamask/keyring-api"),re=e("../../shared/constants/methods-tags"),ne=e("../../shared/constants/transaction"),se=e("../../shared/constants/swaps"),oe=e("../../shared/constants/network"),ie=e("../../shared/constants/smartTransactions"),ae=e("../../shared/constants/hardware-wallets"),ce=e("../../shared/constants/keyring"),le=e("../../shared/constants/permissions"),ue=e("../../shared/notifications"),de=e("../../shared/constants/time"),he=e("../../shared/constants/app"),pe=e("../../shared/constants/metametrics"),me=e("../../shared/constants/logs"),ge=e("../../shared/lib/token-util"),fe=e("../../shared/modules/string-utils"),ye=e("../../shared/modules/transaction.utils"),we=e("../../shared/constants/tokens"),Ce=e("../../shared/lib/metamask-controller-utils"),ke=e("../../shared/modules/mv3.utils"),ve=e("../../shared/modules/network.utils"),be=e("../../shared/modules/selectors"),Se=e("../../shared/modules/caip-stream"),Te=e("../../shared/constants/urls"),_e=e("../../shared/lib/transactions-controller-utils"),Ee=e("../../shared/lib/trace"),Ae=e("./lib/accounts/BalancesController"),Me=e("./lib/transaction/metrics"),Pe=e("./lib/transaction/smart-transactions"),Ie=e("./lib/snap-keyring/keyring-snaps-permissions"),Re=e("./lib/SnapsNameProvider"),Ne=e("./lib/AddressBookPetnamesBridge"),je=e("./lib/AccountIdentitiesPetnamesBridge"),xe=e("./lib/ppom/ppom-middleware"),Oe=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=Rt(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=s?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}(e("./lib/ppom/ppom")),Be=e("./detect-multiple-instances"),Ue=Nt(e("./lib/ComposableObservableStore")),Fe=Nt(e("./lib/account-tracker")),De=Nt(e("./lib/createDupeReqFilterStream")),Le=Nt(e("./lib/createLoggerMiddleware")),He=e("./lib/rpc-method-middleware"),$e=Nt(e("./lib/createOriginMiddleware")),qe=Nt(e("./lib/createTabIdMiddleware")),Ke=e("./controllers/network-order"),Ge=e("./controllers/account-order"),We=Nt(e("./lib/createOnboardingMiddleware")),Ve=e("./lib/stream-utils"),Je=Nt(e("./controllers/preferences")),ze=Nt(e("./controllers/app-state")),Ye=Nt(e("./controllers/alert")),Xe=Nt(e("./controllers/onboarding")),Qe=Nt(e("./lib/backup")),Ze=Nt(e("./controllers/decrypt-message")),et=Nt(e("./controllers/swaps")),tt=Nt(e("./controllers/metametrics")),rt=e("./lib/segment"),nt=Nt(e("./lib/createMetaRPCHandler")),st=e("./lib/util"),ot=Nt(e("./lib/createMetamaskMiddleware")),it=e("./lib/hardware-keyring-builder-factory"),at=Nt(e("./controllers/encryption-public-key")),ct=Nt(e("./controllers/app-metadata")),lt=e("./controllers/permissions"),ut=Nt(e("./lib/createRPCMethodTrackingMiddleware")),dt=e("./lib/ppom/indexed-db-backend"),ht=e("./translate"),pt=e("./lib/offscreen-bridge/trezor-offscreen-bridge"),mt=e("./lib/offscreen-bridge/ledger-offscreen-bridge"),gt=e("./lib/snap-keyring"),ft=e("./lib/encryptor-factory"),yt=e("./lib/transaction/util"),wt=e("./lib/offscreen-bridge/lattice-offscreen-keyring"),Ct=Nt(e("./snaps/preinstalled-snaps")),kt=e("./lib/WeakRefObjectMap"),vt=Nt(e("./controllers/authentication/authentication-controller")),bt=Nt(e("./controllers/user-storage/user-storage-controller")),St=e("./controllers/push-platform-notifications/push-platform-notifications"),Tt=e("./controllers/metamask-notifications/metamask-notifications"),_t=e("./lib/tx-verification/tx-verification-middleware"),Et=e("./lib/ppom/ppom-util"),At=Nt(e("./lib/createEvmMethodsToNonEvmAccountReqFilterMiddleware")),Mt=e("./lib/multichain/address"),Pt=Nt(e("./controllers/bridge")),It=e("./lib/transaction/decode/util");function Rt(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Rt=function(e){return e?r:t})(e)}function Nt(e){return e&&e.__esModule?e:{default:e}}function jt(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function xt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ot(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}r.METAMASK_CONTROLLER_EVENTS={UPDATE_BADGE:"updateBadge",APPROVAL_STATE_CHANGE:"ApprovalController:stateChange",QUEUED_REQUEST_STATE_CHANGE:"QueuedRequestController:stateChange",METAMASK_NOTIFICATIONS_LIST_UPDATED:"MetamaskNotificationsController:notificationsListUpdated",METAMASK_NOTIFICATIONS_MARK_AS_READ:"MetamaskNotificationsController:markNotificationsAsRead",NOTIFICATIONS_STATE_CHANGE:"NotificationController:stateChange"};var Bt=new WeakSet,Ut=new WeakSet,Ft=new WeakSet;class Dt extends n.default{constructor(e){super(),jt(this,Ft),jt(this,Ut),jt(this,Bt),xt(this,"_trackSnapExportUsage",(0,d.wrap)((0,d.memoize)((()=>(0,d.throttle)(((e,t,r,n)=>{var s;return this.metaMetricsController.trackEvent({event:pe.MetaMetricsEventName.SnapExportUsed,category:pe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,export:t,snap_category:null===(s=this._getSnapMetadata(e))||void 0===s?void 0:s.category,success:r,origin:n}})}),60*de.SECOND)),((e,t,r,n)=>`${e}${t}${n}`)),((e,...t)=>e(...t)(...t)))),xt(this,"handleWatchAssetRequest",(({asset:e,type:t,origin:r,networkClientId:n})=>{switch(t){case W.ERC20:return this.tokensController.watchAsset({asset:e,type:t,networkClientId:n});case W.ERC721:case W.ERC1155:return this.nftController.watchNft(e,t,r);default:throw new Error(`Asset type ${t} not supported`)}})),xt(this,"removePermissionsFor",(e=>{try{this.permissionController.revokePermissions(e)}catch(e){if(!(e instanceof x.PermissionsRequestNotFoundError))throw e}})),xt(this,"updateCaveat",((e,t,r,n)=>{try{this.controllerMessenger.call("PermissionController:updateCaveat",e,t,r,n)}catch(e){if(!(e instanceof x.PermissionsRequestNotFoundError))throw e}})),xt(this,"updateNetworksList",(e=>{try{this.networkOrderController.updateNetworksList(e)}catch(e){throw y.default.error(e.message),e}})),xt(this,"updateAccountsList",(e=>{try{this.accountOrderController.updateAccountsList(e)}catch(e){throw y.default.error(e.message),e}})),xt(this,"updateHiddenAccountsList",(e=>{try{this.accountOrderController.updateHiddenAccountsList(e)}catch(e){throw y.default.error(e.message),e}})),xt(this,"rejectPermissionsRequest",(e=>{try{this.permissionController.rejectPermissionsRequest(e)}catch(e){if(!(e instanceof x.PermissionsRequestNotFoundError))throw e}})),xt(this,"acceptPermissionsRequest",(e=>{try{this.permissionController.acceptPermissionsRequest(e)}catch(e){if(!(e instanceof x.PermissionsRequestNotFoundError))throw e}})),xt(this,"resolvePendingApproval",(async(e,t,r)=>{try{await this.approvalController.accept(e,t,r)}catch(e){if(!(e instanceof A.ApprovalRequestNotFoundError))throw e}})),xt(this,"rejectPendingApproval",((e,t)=>{try{this.approvalController.reject(e,new g.EthereumRpcError(t.code,t.message,t.data))}catch(e){if(!(e instanceof A.ApprovalRequestNotFoundError))throw e}}));const{isFirstMetaMaskControllerSetup:t}=e;this.defaultMaxListeners=20,this.sendUpdate=(0,d.debounce)(this.privateSendUpdate.bind(this),200*de.MILLISECOND),this.opts=e,this.extension=e.browser,this.platform=e.platform,this.notificationManager=e.notificationManager;const r=e.initState||{},n=this.platform.getVersion();this.recordFirstTimeInfo(r),this.featureFlags=e.featureFlags,this.activeControllerConnections=0,this.offscreenPromise=e.offscreenPromise??Promise.resolve(),this.getRequestAccountTabIds=e.getRequestAccountTabIds,this.getOpenMetamaskTabsIds=e.getOpenMetamaskTabsIds,this.controllerMessenger=new M.ControllerMessenger,this.loggingController=new U.LoggingController({messenger:this.controllerMessenger.getRestricted({name:"LoggingController"}),state:r.LoggingController}),this.localStoreApiWrapper=e.localStore,this.currentMigrationVersion=e.currentMigrationVersion,this.store=new Ue.default({state:r,controllerMessenger:this.controllerMessenger,persist:!0}),this.connections={},this.createVaultMutex=new f.Mutex,this.extension.runtime.onInstalled.addListener((e=>{"update"===e.reason&&("8.1.0"===n&&this.platform.openExtensionInBrowser(),this.loggingController.add({type:U.LogType.GenericLog,data:{event:me.LOG_EVENT.VERSION_UPDATE,previousVersion:e.previousVersion,version:n}}))})),this.appMetadataController=new ct.default({state:r.AppMetadataController,currentMigrationVersion:this.currentMigrationVersion,currentAppVersion:n});const s=()=>{this.encryptionPublicKeyController.clearUnapproved(),this.decryptMessageController.clearUnapproved(),this.signatureController.clearUnapproved(),this.approvalController.clear(g.ethErrors.provider.userRejectedRequest())};this.queuedRequestController=new z.QueuedRequestController({messenger:this.controllerMessenger.getRestricted({name:"QueuedRequestController",allowedActions:["NetworkController:getState","NetworkController:setActiveNetwork","SelectedNetworkController:getNetworkClientIdForDomain"],allowedEvents:["SelectedNetworkController:stateChange"]}),shouldRequestSwitchNetwork:({method:e})=>re.methodsRequiringNetworkSwitch.includes(e),clearPendingConfirmations:s,showApprovalRequest:e.showUserConfirmation}),this.approvalController=new A.ApprovalController({messenger:this.controllerMessenger.getRestricted({name:"ApprovalController"}),showApprovalRequest:e.showUserConfirmation,typesExcludedFromRateLimiting:[W.ApprovalType.EthSign,W.ApprovalType.PersonalSign,W.ApprovalType.EthSignTypedData,W.ApprovalType.Transaction,W.ApprovalType.WatchAsset,W.ApprovalType.EthGetEncryptionPublicKey,W.ApprovalType.EthDecrypt]});const i=this.controllerMessenger.getRestricted({name:"NetworkController"});let a={};r.NetworkController&&(a=r.NetworkController),this.networkController=new N.NetworkController({messenger:i,state:a,infuraProjectId:e.infuraProjectId,trackMetaMetricsEvent:(...e)=>this.metaMetricsController.trackEvent(...e)}),this.networkController.initializeProvider(),this.provider=this.networkController.getProviderAndBlockTracker().provider,this.blockTracker=this.networkController.getProviderAndBlockTracker().blockTracker,this.deprecatedNetworkVersions={};const c=this.controllerMessenger.getRestricted({name:"AccountsController",allowedEvents:["SnapController:stateChange","KeyringController:accountRemoved","KeyringController:stateChange"],allowedActions:["KeyringController:getAccounts","KeyringController:getKeyringsByType","KeyringController:getKeyringForAccount"]});this.accountsController=new q.AccountsController({messenger:c,state:r.AccountsController});const l=this.controllerMessenger.getRestricted({name:"PreferencesController",allowedActions:["AccountsController:setSelectedAccount","AccountsController:getAccountByAddress","AccountsController:setAccountName"],allowedEvents:["AccountsController:stateChange"]});this.preferencesController=new Je.default({initState:r.PreferencesController,initLangCode:e.initLangCode,messenger:l,provider:this.provider,networkConfigurations:this.networkController.state.networkConfigurations});const u=this.controllerMessenger.getRestricted({name:"TokenListController",allowedActions:["NetworkController:getNetworkClientById"],allowedEvents:["NetworkController:stateChange"]});this.tokenListController=new o.TokenListController({chainId:this.networkController.state.providerConfig.chainId,preventPollingOnNetworkRestart:!Ot(this,Ft,$t).call(this,this.preferencesController.store.getState()),messenger:u,state:r.TokenListController}),this.assetsContractController=new o.AssetsContractController({chainId:this.networkController.state.providerConfig.chainId,onPreferencesStateChange:e=>this.preferencesController.store.subscribe(e),onNetworkDidChange:e=>i.subscribe("NetworkController:networkDidChange",(()=>{const t=this.networkController.state;return e(t)})),getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController)},{provider:this.provider},r.AssetsContractController);const p=this.controllerMessenger.getRestricted({name:"TokensController",allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById","AccountsController:getSelectedAccount","AccountsController:getAccount"],allowedEvents:["NetworkController:networkDidChange","AccountsController:selectedEvmAccountChange","PreferencesController:stateChange","TokenListController:stateChange"]});this.tokensController=new o.TokensController({state:r.TokensController,provider:this.provider,messenger:p,chainId:this.networkController.state.providerConfig.chainId});const m=this.controllerMessenger.getRestricted({name:"NftController",allowedEvents:["PreferencesController:stateChange","NetworkController:networkDidChange","AccountsController:selectedEvmAccountChange"],allowedActions:[`${this.approvalController.name}:addRequest`,`${this.networkController.name}:getNetworkClientById`,"AccountsController:getSelectedAccount","AccountsController:getAccount"]});this.nftController=new o.NftController({state:r.NftController,messenger:m,chainId:this.networkController.state.providerConfig.chainId,getERC721AssetName:this.assetsContractController.getERC721AssetName.bind(this.assetsContractController),getERC721AssetSymbol:this.assetsContractController.getERC721AssetSymbol.bind(this.assetsContractController),getERC721TokenURI:this.assetsContractController.getERC721TokenURI.bind(this.assetsContractController),getERC721OwnerOf:this.assetsContractController.getERC721OwnerOf.bind(this.assetsContractController),getERC1155BalanceOf:this.assetsContractController.getERC1155BalanceOf.bind(this.assetsContractController),getERC1155TokenURI:this.assetsContractController.getERC1155TokenURI.bind(this.assetsContractController),onNftAdded:({address:e,symbol:t,tokenId:r,standard:n,source:s})=>this.metaMetricsController.trackEvent({event:pe.MetaMetricsEventName.NftAdded,category:pe.MetaMetricsEventCategory.Wallet,sensitiveProperties:{token_contract_address:e,token_symbol:t,token_id:r,token_standard:n,asset_type:ne.AssetType.NFT,source:s}})}),this.nftController.setApiKey(null);const b=this.controllerMessenger.getRestricted({name:"NftDetectionController",allowedEvents:["NetworkController:stateChange","PreferencesController:stateChange"],allowedActions:["ApprovalController:addRequest","NetworkController:getState","NetworkController:getNetworkClientById","AccountsController:getSelectedAccount"]});this.nftDetectionController=new o.NftDetectionController({messenger:b,chainId:this.networkController.state.providerConfig.chainId,getOpenSeaApiKey:()=>this.nftController.openSeaApiKey,getBalancesInSingleCall:this.assetsContractController.getBalancesInSingleCall.bind(this.assetsContractController),addNft:this.nftController.addNft.bind(this.nftController),getNftState:()=>this.nftController.state,disabled:this.preferencesController.store.getState().useNftDetection!==undefined&&!this.preferencesController.store.getState().useNftDetection}),this.metaMetricsController=new tt.default({segment:rt.segment,preferencesStore:this.preferencesController.store,onNetworkDidChange:i.subscribe.bind(i,"NetworkController:networkDidChange"),getNetworkIdentifier:()=>{const{type:e,rpcUrl:t}=this.networkController.state.providerConfig;return e===oe.NETWORK_TYPES.RPC?t:e},getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,version:this.platform.getVersion(),environment:"production",extension:this.extension,initState:r.MetaMetricsController,captureException:_.captureException}),this.on("update",(e=>{this.metaMetricsController.handleMetaMaskStateUpdate(e)}));const S=this.controllerMessenger.getRestricted({name:"GasFeeController",allowedActions:["NetworkController:getEIP1559Compatibility","NetworkController:getNetworkClientById","NetworkController:getState"],allowedEvents:["NetworkController:stateChange"]}),T=se.GAS_API_BASE_URL;this.gasFeeController=new j.GasFeeController({state:r.GasFeeController,interval:1e4,messenger:S,clientId:se.SWAPS_CLIENT_ID,getProvider:()=>this.networkController.getProviderAndBlockTracker().provider,onNetworkDidChange:e=>{i.subscribe("NetworkController:networkDidChange",(()=>e(this.networkController.state)))},getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),legacyAPIEndpoint:`${T}/networks/<chain_id>/gasPrices`,EIP1559APIEndpoint:`${T}/networks/<chain_id>/suggestedGasFees`,getCurrentNetworkLegacyGasAPICompatibility:()=>{const{chainId:e}=this.networkController.state.providerConfig;return e===oe.CHAIN_IDS.BSC},getChainId:()=>this.networkController.state.providerConfig.chainId}),this.appStateController=new ze.default({addUnlockListener:this.on.bind(this,"unlock"),isUnlocked:this.isUnlocked.bind(this),initState:r.AppStateController,onInactiveTimeout:()=>this.setLocked(),preferencesStore:this.preferencesController.store,messenger:this.controllerMessenger.getRestricted({name:"AppStateController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`],allowedEvents:["KeyringController:qrKeyringStateChange"]}),extension:this.extension});const $=this.controllerMessenger.getRestricted({name:"CurrencyRateController",allowedActions:[`${this.networkController.name}:getNetworkClientById`]});this.currencyRateController=new o.CurrencyRateController({includeUsdRate:!0,messenger:$,state:r.CurrencyController});const V=this.currencyRateController.fetchExchangeRate.bind(this.currencyRateController);this.currencyRateController.fetchExchangeRate=(...e)=>this.preferencesController.store.getState().useCurrencyRateCheck?V(...e):{conversionRate:null,usdConversionRate:null};const Z=this.controllerMessenger.getRestricted({name:"PhishingController"});this.phishingController=new I.PhishingController({messenger:Z,state:r.PhishingController,hotlistRefreshInterval:undefined,stalelistRefreshInterval:undefined}),this.ppomController=new G.PPOMController({messenger:this.controllerMessenger.getRestricted({name:"PPOMController",allowedEvents:["NetworkController:stateChange"]}),storageBackend:new dt.IndexedDBPPOMStorage("PPOMDB",1),provider:this.provider,ppomProvider:{PPOM:Oe.PPOM,ppomInit:Oe.default},state:r.PPOMController,chainId:this.networkController.state.providerConfig.chainId,securityAlertsEnabled:this.preferencesController.store.getState().securityAlertsEnabled,onPreferencesChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),cdnBaseUrl:"static.cx.metamask.io/api/v1/confirmations/ppom",blockaidPublicKey:"066ad3e8af5583385e312c156d238055215d5f25247c1e91055afa756cb98a88"});const ee=this.controllerMessenger.getRestricted({name:"AnnouncementController"});this.announcementController=new R.AnnouncementController({messenger:ee,allAnnouncements:ue.UI_NOTIFICATIONS,state:r.AnnouncementController});const te=this.controllerMessenger.getRestricted({name:"NetworkOrderController",allowedEvents:["NetworkController:stateChange"]});this.networkOrderController=new Ke.NetworkOrderController({messenger:te,state:r.NetworkOrderController});const ae=this.controllerMessenger.getRestricted({name:"AccountOrderController"});this.accountOrderController=new Ge.AccountOrderController({messenger:ae,state:r.AccountOrderController});const ce=this.controllerMessenger.getRestricted({name:"BalancesController",allowedEvents:["AccountsController:accountAdded","AccountsController:accountRemoved"],allowedActions:["AccountsController:listMultichainAccounts","SnapController:handleRequest"]});this.multichainBalancesController=new Ae.BalancesController({messenger:ce,state:r.MultichainBalancesController});const ge=this.controllerMessenger.getRestricted({name:"RatesController"});this.multichainRatesController=new o.RatesController({state:r.MultichainRatesController,messenger:ge,includeUsdRate:!0,fetchMultiExchangeRate:o.fetchMultiExchangeRate});const fe=this.controllerMessenger.getRestricted({name:"TokenRatesController",allowedActions:["TokensController:getState","NetworkController:getNetworkClientById","NetworkController:getState","AccountsController:getAccount","AccountsController:getSelectedAccount"],allowedEvents:["NetworkController:stateChange","AccountsController:selectedEvmAccountChange","PreferencesController:stateChange","TokensController:stateChange"]});this.tokenRatesController=new o.TokenRatesController({state:r.TokenRatesController,messenger:fe,tokenPricesService:new o.CodefiTokenPricesServiceV2}),this.preferencesController.store.subscribe((0,st.previousValueComparator)(((e,t)=>{const{useCurrencyRateCheck:r}=e,{useCurrencyRateCheck:n}=t;n&&!r?this.tokenRatesController.start():!n&&r&&this.tokenRatesController.stop()}),this.preferencesController.store.getState())),this.ensController=new P.EnsController({messenger:this.controllerMessenger.getRestricted({name:"EnsController"}),provider:this.provider,onNetworkDidChange:i.subscribe.bind(i,"NetworkController:networkDidChange")}),this.onboardingController=new Xe.default({initState:r.OnboardingController});let ye=[(0,h.keyringBuilderFactory)(v.MetaMaskKeyring)];if(!1===ke.isManifestV3){var we;const e=null===(we=this.opts.overrides)||void 0===we?void 0:we.keyrings,t=[(null==e?void 0:e.lattice)||k.default,v.MetaMaskKeyring],r=[{keyring:(null==e?void 0:e.trezor)||w.TrezorKeyring,bridge:(null==e?void 0:e.trezorBridge)||w.TrezorConnectBridge},{keyring:(null==e?void 0:e.ledger)||C.LedgerKeyring,bridge:(null==e?void 0:e.ledgerBridge)||C.LedgerIframeBridge}];ye=t.map((e=>(0,h.keyringBuilderFactory)(e))),r.forEach((e=>ye.push((0,it.hardwareKeyringBuilderFactory)(e.keyring,e.bridge))))}else ye.push((0,it.hardwareKeyringBuilderFactory)(w.TrezorKeyring,pt.TrezorOffscreenBridge),(0,it.hardwareKeyringBuilderFactory)(C.LedgerKeyring,mt.LedgerOffscreenBridge),(0,h.keyringBuilderFactory)(wt.LatticeKeyringOffscreen));const Ce=this.controllerMessenger.getRestricted({name:"SnapKeyringBuilder",allowedActions:["ApprovalController:addRequest","ApprovalController:acceptRequest","ApprovalController:rejectRequest","ApprovalController:startFlow","ApprovalController:endFlow","ApprovalController:showSuccess","ApprovalController:showError","PhishingController:test","PhishingController:maybeUpdateState","KeyringController:getAccounts","AccountsController:setSelectedAccount","AccountsController:getAccountByAddress"]});ye.push((0,gt.snapKeyringBuilder)(Ce,(()=>this.snapController),(async()=>{await this.keyringController.persistAllKeyrings(),await this.accountsController.updateAccounts()}),(e=>this.preferencesController.setSelectedAddress(e)),(e=>this.removeAccount(e)),this.metaMetricsController.trackEvent.bind(this.metaMetricsController),(e=>{if(!e)return null;const t=this.getLocale(),{snaps:r}=this.snapController.state,n=r[e];if(!n)return(0,Q.stripSnapPrefix)(e);if(n.localizationFiles){return(0,Q.getLocalizedSnapManifest)(n.manifest,t,n.localizationFiles).proposedName}return n.manifest.proposedName}),(e=>Ct.default.some((t=>t.snapId===e)))));const ve=this.controllerMessenger.getRestricted({name:"KeyringController"});this.keyringController=new h.KeyringController({cacheEncryptionKey:!0,keyringBuilders:ye,state:r.KeyringController,encryptor:e.encryptor||(0,ft.encryptorFactory)(6e5),messenger:ve}),this.controllerMessenger.subscribe("KeyringController:unlock",(()=>this._onUnlock())),this.controllerMessenger.subscribe("KeyringController:lock",(()=>this._onLock())),this.controllerMessenger.subscribe("KeyringController:stateChange",(e=>{this._onKeyringControllerUpdate(e)})),this.permissionController=new x.PermissionController({messenger:this.controllerMessenger.getRestricted({name:"PermissionController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:hasRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,"SnapController:getPermitted","SnapController:install","SubjectMetadataController:getSubjectMetadata"]}),state:r.PermissionController,caveatSpecifications:(0,lt.getCaveatSpecifications)({getInternalAccounts:this.accountsController.listAccounts.bind(this.accountsController),findNetworkClientIdByChainId:this.networkController.findNetworkClientIdByChainId.bind(this.networkController)}),permissionSpecifications:{...(0,lt.getPermissionSpecifications)({getInternalAccounts:this.accountsController.listAccounts.bind(this.accountsController),getAllAccounts:this.keyringController.getAccounts.bind(this.keyringController),captureKeyringTypesWithMissingIdentities:(e=[],t=[])=>{const r=t.filter((t=>!e.some((e=>e.address.toLowerCase()===t.toLowerCase())))).map((e=>this.keyringController.getAccountKeyringType(e))),n=e.length,s=Object.keys(this.accountTracker.store.getState().accounts||{}).length;(0,_.captureException)(new Error(`Attempt to get permission specifications failed because their were ${t.length} accounts, but ${n} identities, and the ${r} keyrings included accounts with missing identities. Meanwhile, there are ${s} accounts in the account tracker.`))}}),...this.getSnapPermissionSpecifications()},unrestrictedMethods:lt.unrestrictedMethods}),this.selectedNetworkController=new B.SelectedNetworkController({messenger:this.controllerMessenger.getRestricted({name:"SelectedNetworkController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","NetworkController:getSelectedNetworkClient","PermissionController:hasPermissions","PermissionController:getSubjectNames"],allowedEvents:["NetworkController:stateChange","PermissionController:stateChange"]}),state:r.SelectedNetworkController,useRequestQueuePreference:this.preferencesController.store.getState().useRequestQueue,onPreferencesStateChange:e=>this.preferencesController.store.subscribe(e),domainProxyMap:new kt.WeakRefObjectMap}),this.permissionLogController=new F.PermissionLogController({messenger:this.controllerMessenger.getRestricted({name:"PermissionLogController"}),restrictedMethods:new Set(Object.keys(le.RestrictedMethods)),state:r.PermissionLogController}),this.subjectMetadataController=new x.SubjectMetadataController({messenger:this.controllerMessenger.getRestricted({name:"SubjectMetadataController",allowedActions:[`${this.permissionController.name}:hasPermissions`]}),state:r.SubjectMetadataController,subjectCacheLimit:100});const Se=ke.isManifestV3&&"undefined"!=typeof chrome&&void 0!==chrome.offscreen,Te={messenger:this.controllerMessenger.getRestricted({name:"ExecutionService"}),setupSnapProvider:this.setupSnapProvider.bind(this)};this.snapExecutionService=!1===Se?new H.IframeExecutionService({...Te,iframeUrl:new URL("https://execution.metamask.io/iframe/6.5.0/index.html")}):new H.OffscreenExecutionService({...Te,offscreenPromise:this.offscreenPromise});const _e=this.controllerMessenger.getRestricted({name:"SnapController",allowedEvents:["ExecutionService:unhandledError","ExecutionService:outboundRequest","ExecutionService:outboundResponse"],allowedActions:[`${this.permissionController.name}:getEndowments`,`${this.permissionController.name}:getPermissions`,`${this.permissionController.name}:hasPermission`,`${this.permissionController.name}:hasPermissions`,`${this.permissionController.name}:requestPermissions`,`${this.permissionController.name}:revokeAllPermissions`,`${this.permissionController.name}:revokePermissions`,`${this.permissionController.name}:revokePermissionForAllSubjects`,`${this.permissionController.name}:getSubjectNames`,`${this.permissionController.name}:updateCaveat`,`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:updateRequestState`,`${this.permissionController.name}:grantPermissions`,`${this.subjectMetadataController.name}:getSubjectMetadata`,`${this.subjectMetadataController.name}:addSubjectMetadata`,"ExecutionService:executeSnap","ExecutionService:getRpcRequestHandler","ExecutionService:terminateSnap","ExecutionService:terminateAllSnaps","ExecutionService:handleRpcRequest","SnapsRegistry:get","SnapsRegistry:getMetadata","SnapsRegistry:update","SnapsRegistry:resolveVersion","SnapInterfaceController:createInterface","SnapInterfaceController:getInterface"]}),Ee=!0;this.snapController=new H.SnapController({environmentEndowmentPermissions:Object.values(le.EndowmentPermissions),excludedPermissions:{...le.ExcludedSnapPermissions,...le.ExcludedSnapEndowments},closeAllConnections:this.removeAllConnections.bind(this),state:r.SnapController,messenger:_e,featureFlags:{dappsCanUpdateSnaps:!0,allowLocalSnaps:!1,requireAllowlist:Ee},encryptor:(0,ft.encryptorFactory)(6e5),getMnemonic:this.getPrimaryKeyringMnemonic.bind(this),preinstalledSnaps:Ct.default,getFeatureFlags:()=>({disableSnaps:!1===this.preferencesController.store.getState().useExternalServices})}),this.notificationController=new L.NotificationController({messenger:this.controllerMessenger.getRestricted({name:"NotificationController"}),state:r.NotificationController}),this.rateLimitController=new D.RateLimitController({state:r.RateLimitController,messenger:this.controllerMessenger.getRestricted({name:"RateLimitController"}),implementations:{showNativeNotification:{method:(e,t)=>{const r=this.controllerMessenger.call("SubjectMetadataController:getState").subjectMetadata[e];return this.platform._showNotification((null==r?void 0:r.name)??e,t).catch((e=>{y.default.error("Failed to create notification",e)})),null},rateLimitCount:2,rateLimitTimeout:3e5},showInAppNotification:{method:(e,t)=>(this.controllerMessenger.call("NotificationController:show",e,t),null),rateLimitCount:5,rateLimitTimeout:6e4}}});const Me=this.controllerMessenger.getRestricted({name:"CronjobController",allowedEvents:["SnapController:snapInstalled","SnapController:snapUpdated","SnapController:snapUninstalled","SnapController:snapEnabled","SnapController:snapDisabled"],allowedActions:[`${this.permissionController.name}:getPermissions`,"SnapController:handleRequest","SnapController:getAll"]});this.cronjobController=new H.CronjobController({state:r.CronjobController,messenger:Me});const Pe=this.controllerMessenger.getRestricted({name:"SnapsRegistry",allowedEvents:[],allowedActions:[]});this.snapsRegistry=new H.JsonSnapsRegistry({state:r.SnapsRegistry,messenger:Pe,refetchOnAllowlistMiss:Ee,url:{registry:"https://acl.execution.metamask.io/latest/registry.json",signature:"https://acl.execution.metamask.io/latest/signature.json"},publicKey:"0x025b65308f0f0fb8bc7f7ff87bfc296e0330eee5d3c1d1ee4a048b2fd6a86fa0a6"});const Ie=this.controllerMessenger.getRestricted({name:"SnapInterfaceController",allowedActions:[`${this.phishingController.name}:maybeUpdateState`,`${this.phishingController.name}:testOrigin`]});this.snapInterfaceController=new H.SnapInterfaceController({state:r.SnapInterfaceController,messenger:Ie}),this.authenticationController=new vt.default({state:r.AuthenticationController,messenger:this.controllerMessenger.getRestricted({name:"AuthenticationController",allowedActions:["KeyringController:getState","SnapController:handleRequest","UserStorageController:disableProfileSyncing"],allowedEvents:["KeyringController:lock","KeyringController:unlock"]}),metametrics:{getMetaMetricsId:()=>this.metaMetricsController.getMetaMetricsId()}}),this.userStorageController=new bt.default({getMetaMetricsState:()=>this.metaMetricsController.state.participateInMetaMetrics,state:r.UserStorageController,messenger:this.controllerMessenger.getRestricted({name:"UserStorageController",allowedActions:["KeyringController:getState","SnapController:handleRequest","AuthenticationController:getBearerToken","AuthenticationController:getSessionProfile","AuthenticationController:isSignedIn","AuthenticationController:performSignOut","AuthenticationController:performSignIn","MetamaskNotificationsController:disableMetamaskNotifications","MetamaskNotificationsController:selectIsMetamaskNotificationsEnabled"],allowedEvents:["KeyringController:lock","KeyringController:unlock"]})});const xe=this.controllerMessenger.getRestricted({name:"PushPlatformNotificationsController",allowedActions:["AuthenticationController:getBearerToken"]});this.pushPlatformNotificationsController=new St.PushPlatformNotificationsController({state:r.PushPlatformNotificationsController,messenger:xe}),xe.subscribe("PushPlatformNotificationsController:onNewNotifications",(e=>{this.metaMetricsController.trackEvent({category:pe.MetaMetricsEventCategory.PushNotifications,event:pe.MetaMetricsEventName.PushNotificationReceived,properties:{notification_id:e.id,notification_type:e.type,chain_id:null==e?void 0:e.chain_id}})})),xe.subscribe("PushPlatformNotificationsController:pushNotificationClicked",(e=>{this.metaMetricsController.trackEvent({category:pe.MetaMetricsEventCategory.PushNotifications,event:pe.MetaMetricsEventName.PushNotificationClicked,properties:{notification_id:e.id,notification_type:e.type,chain_id:null==e?void 0:e.chain_id}})})),this.metamaskNotificationsController=new Tt.MetamaskNotificationsController({messenger:this.controllerMessenger.getRestricted({name:"MetamaskNotificationsController",allowedActions:["KeyringController:getAccounts","KeyringController:getState","AuthenticationController:getBearerToken","AuthenticationController:isSignedIn","UserStorageController:enableProfileSyncing","UserStorageController:getStorageKey","UserStorageController:performGetStorage","UserStorageController:performSetStorage","PushPlatformNotificationsController:enablePushNotifications","PushPlatformNotificationsController:disablePushNotifications","PushPlatformNotificationsController:updateTriggerPushNotifications"],allowedEvents:["KeyringController:stateChange","KeyringController:lock","KeyringController:unlock","PushPlatformNotificationsController:onNewNotifications"]}),state:r.MetamaskNotificationsController}),this.accountTracker=new Fe.default({provider:this.provider,blockTracker:this.blockTracker,getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,getNetworkIdentifier:e=>{const{type:t,rpcUrl:r}=e??this.networkController.state.providerConfig;return t===oe.NETWORK_TYPES.RPC?r:t},preferencesController:this.preferencesController,onboardingController:this.onboardingController,controllerMessenger:this.controllerMessenger.getRestricted({name:"AccountTracker",allowedEvents:["AccountsController:selectedEvmAccountChange"],allowedActions:["AccountsController:getSelectedAccount"]}),initState:{accounts:{}},onAccountRemoved:this.controllerMessenger.subscribe.bind(this.controllerMessenger,"KeyringController:accountRemoved")}),this.on("controllerConnectionChanged",(e=>{const{completedOnboarding:t}=this.onboardingController.store.getState();e>0&&t?this.triggerNetworkrequests():this.stopNetworkRequests()})),this.onboardingController.store.subscribe((0,st.previousValueComparator)((async(e,t)=>{const{completedOnboarding:r}=e,{completedOnboarding:n}=t;if(!r&&n){const{address:e}=this.accountsController.getSelectedAccount();this._addAccountsWithBalance(),this.postOnboardingInitialization(),this.triggerNetworkrequests(),await this.tokenDetectionController.detectTokens({selectedAddress:e})}}),this.onboardingController.store.getState()));const De=this.controllerMessenger.getRestricted({name:"TokenDetectionController",allowedActions:["AccountsController:getAccount","AccountsController:getSelectedAccount","KeyringController:getState","NetworkController:getNetworkClientById","NetworkController:getNetworkConfigurationByNetworkClientId","NetworkController:getState","PreferencesController:getState","TokenListController:getState","TokensController:getState","TokensController:addDetectedTokens"],allowedEvents:["AccountsController:selectedEvmAccountChange","KeyringController:lock","KeyringController:unlock","NetworkController:networkDidChange","PreferencesController:stateChange","TokenListController:stateChange"]});this.tokenDetectionController=new o.TokenDetectionController({messenger:De,getBalancesInSingleCall:this.assetsContractController.getBalancesInSingleCall.bind(this.assetsContractController),trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.addressBookController=new E.AddressBookController(undefined,r.AddressBookController),this.alertController=new Ye.default({initState:r.AlertController,preferencesStore:this.preferencesController.store,controllerMessenger:this.controllerMessenger.getRestricted({name:"AlertController",allowedEvents:["AccountsController:selectedAccountChange"],allowedActions:["AccountsController:getSelectedAccount"]})}),this.backup=new Qe.default({preferencesController:this.preferencesController,addressBookController:this.addressBookController,accountsController:this.accountsController,networkController:this.networkController,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.snapAndHardwareMetricsParams={getSelectedAccount:this.accountsController.getSelectedAccount.bind(this.accountsController),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]})};const Le=this.controllerMessenger.getRestricted({name:"TransactionController",allowedActions:[`${this.approvalController.name}:addRequest`,"NetworkController:findNetworkClientIdByChainId","NetworkController:getNetworkClientById"],allowedEvents:["NetworkController:stateChange"]});this.txController=new X.TransactionController({blockTracker:this.blockTracker,getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),getExternalPendingTransactions:this.getExternalPendingTransactions.bind(this),getGasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getNetworkClientRegistry:this.networkController.getNetworkClientRegistry.bind(this.networkController),getNetworkState:()=>this.networkController.state,getPermittedAccounts:this.getPermittedAccounts.bind(this),getSavedGasFees:()=>this.preferencesController.store.getState().advancedGasFee[this.networkController.state.providerConfig.chainId],getSelectedAddress:()=>this.accountsController.getSelectedAccount().address,incomingTransactions:{includeTokenTransfers:!1,isEnabled:()=>{var e;return Boolean((null===(e=this.preferencesController.store.getState().incomingTransactionsPreferences)||void 0===e?void 0:e[this.networkController.state.providerConfig.chainId])&&this.onboardingController.store.getState().completedOnboarding)},queryEntireHistory:!1,updateTransactions:!1},isMultichainEnabled:"",isSimulationEnabled:()=>this.preferencesController.store.getState().useTransactionSimulations,messenger:Le,onNetworkStateChange:e=>{i.subscribe("NetworkController:networkDidChange",(()=>e()))},pendingTransactions:{isResubmitEnabled:()=>{const e=this._getMetaMaskState();return!((0,be.getSmartTransactionsOptInStatus)(e)&&(0,be.getCurrentChainSupportsSmartTransactions)(e))}},provider:this.provider,testGasFeeFlows:!1,hooks:{publish:this._publishSmartTransactionHook.bind(this)},sign:(...e)=>this.keyringController.signTransaction(...e),state:r.TransactionController}),this._addTransactionControllerListeners(),this.decryptMessageController=new Ze.default({getState:this.getState.bind(this),messenger:this.controllerMessenger.getRestricted({name:"DecryptMessageController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,`${this.keyringController.name}:decryptMessage`]}),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.encryptionPublicKeyController=new at.default({messenger:this.controllerMessenger.getRestricted({name:"EncryptionPublicKeyController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`]}),getEncryptionPublicKey:this.keyringController.getEncryptionPublicKey.bind(this.keyringController),getAccountKeyringType:this.keyringController.getAccountKeyringType.bind(this.keyringController),getState:this.getState.bind(this),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.signatureController=new K.SignatureController({messenger:this.controllerMessenger.getRestricted({name:"SignatureController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.keyringController.name}:signMessage`,`${this.keyringController.name}:signPersonalMessage`,`${this.keyringController.name}:signTypedMessage`,`${this.loggingController.name}:add`]}),isEthSignEnabled:()=>{var e;return null===(e=this.preferencesController.store.getState())||void 0===e||null===(e=e.disabledRpcMethodPreferences)||void 0===e?void 0:e.eth_sign},getAllState:this.getState.bind(this),getCurrentChainId:()=>this.networkController.state.providerConfig.chainId}),this.signatureController.hub.on("cancelWithReason",(({message:e,reason:t})=>{this.metaMetricsController.trackEvent({event:t,category:pe.MetaMetricsEventCategory.Transactions,properties:{action:"Sign Request",type:e.type}})})),this.swapsController=new et.default({getBufferedGasLimit:async(e,t)=>{const{gas:r,simulationFails:n}=await this.txController.estimateGasBuffered(e.txParams,t);return{gasLimit:r,simulationFails:n}},provider:this.provider,getProviderConfig:()=>this.networkController.state.providerConfig,getTokenRatesState:()=>this.tokenRatesController.state,getCurrentChainId:()=>this.networkController.state.providerConfig.chainId,getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getLayer1GasFee:this.txController.getLayer1GasFee.bind(this.txController),getNetworkClientId:()=>this.networkController.state.selectedNetworkClientId,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)},r.SwapsController),this.bridgeController=new Pt.default,this.smartTransactionsController=new O.default({getNetworkClientById:this.networkController.getNetworkClientById.bind(this.networkController),onNetworkStateChange:i.subscribe.bind(i,"NetworkController:stateChange"),getNonceLock:this.txController.getNonceLock.bind(this.txController),confirmExternalTransaction:this.txController.confirmExternalTransaction.bind(this.txController),getTransactions:this.txController.getTransactions.bind(this.txController),provider:this.provider,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)},{supportedChainIds:(0,ie.getAllowedSmartTransactionsChainIds)()},r.SmartTransactionsController);const He=()=>this.preferencesController.store.getState().useExternalNameSources;this.nameController=new J.NameController({messenger:this.controllerMessenger.getRestricted({name:"NameController",allowedActions:[]}),providers:[new J.ENSNameProvider({reverseLookup:this.ensController.reverseResolveAddress.bind(this.ensController)}),new J.EtherscanNameProvider({isEnabled:He}),new J.TokenNameProvider({isEnabled:He}),new J.LensNameProvider({isEnabled:He}),new Re.SnapsNameProvider({messenger:this.controllerMessenger.getRestricted({name:"SnapsNameProvider",allowedActions:["SnapController:getAll","SnapController:get","SnapController:handleRequest","PermissionController:getState"]})})],state:r.NameController});const $e=this.controllerMessenger.getRestricted({name:"PetnamesBridge",allowedEvents:["NameController:stateChange","AccountsController:stateChange"],allowedActions:["AccountsController:listAccounts"]});new Ne.AddressBookPetnamesBridge({addressBookController:this.addressBookController,nameController:this.nameController,messenger:$e}).init(),new je.AccountIdentitiesPetnamesBridge({nameController:this.nameController,messenger:$e}).init(),this.userOperationController=new Y.UserOperationController({entrypoint:null,getGasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),messenger:this.controllerMessenger.getRestricted({name:"UserOperationController",allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById","KeyringController:prepareUserOperation","KeyringController:patchUserOperation","KeyringController:signUserOperation"]}),state:r.UserOperationController}),this.userOperationController.hub.on("user-operation-added",this._onUserOperationAdded.bind(this)),this.userOperationController.hub.on("transaction-updated",this._onUserOperationTransactionUpdated.bind(this)),i.subscribe("NetworkController:networkDidChange",(()=>{this.accountTracker.updateAccounts()})),i.subscribe("NetworkController:networkWillChange",s.bind(this)),this.metamaskMiddleware=(0,ot.default)({static:{eth_syncing:!1,web3_clientVersion:`MetaMask/v${n}`},version:n,getAccounts:async({origin:e},{suppressUnauthorizedError:t=!0}={})=>{if(e===he.ORIGIN_METAMASK){const e=this.accountsController.getSelectedAccount().address;return e?[e]:[]}return this.isUnlocked()?await this.getPermittedAccounts(e,{suppressUnauthorizedError:t}):[]},processTransaction:(e,t)=>(0,yt.addDappTransaction)(this.getAddTransactionRequest({transactionParams:e,dappRequest:t})),processEthSignMessage:this.signatureController.newUnsignedMessage.bind(this.signatureController),processTypedMessage:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processTypedMessageV3:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processTypedMessageV4:this.signatureController.newUnsignedTypedMessage.bind(this.signatureController),processPersonalMessage:this.signatureController.newUnsignedPersonalMessage.bind(this.signatureController),processEncryptionPublicKey:this.encryptionPublicKeyController.newRequestEncryptionPublicKey.bind(this.encryptionPublicKeyController),processDecryptMessage:this.decryptMessageController.newRequestDecryptMessage.bind(this.decryptMessageController),getPendingNonce:this.getPendingNonce.bind(this),getPendingTransactionByHash:e=>this.txController.state.transactions.find((t=>t.hash===e&&t.status===X.TransactionStatus.submitted))}),this.on("update",(e=>this._onStateUpdate(e)));const qe={AccountTracker:this.accountTracker.store,TokenRatesController:this.tokenRatesController,DecryptMessageController:this.decryptMessageController,EncryptionPublicKeyController:this.encryptionPublicKeyController,SignatureController:this.signatureController,SwapsController:this.swapsController.store,BridgeController:this.bridgeController.store,EnsController:this.ensController,ApprovalController:this.approvalController,PPOMController:this.ppomController};this.store.updateStructure({AccountsController:this.accountsController,AppStateController:this.appStateController.store,AppMetadataController:this.appMetadataController.store,MultichainBalancesController:this.multichainBalancesController,TransactionController:this.txController,KeyringController:this.keyringController,PreferencesController:this.preferencesController.store,MetaMetricsController:this.metaMetricsController.store,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,NetworkController:this.networkController,AlertController:this.alertController.store,OnboardingController:this.onboardingController.store,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,NetworkOrderController:this.networkOrderController,AccountOrderController:this.accountOrderController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,PhishingController:this.phishingController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,MultichainRatesController:this.multichainRatesController,SnapController:this.snapController,CronjobController:this.cronjobController,SnapsRegistry:this.snapsRegistry,NotificationController:this.notificationController,SnapInterfaceController:this.snapInterfaceController,PPOMController:this.ppomController,NameController:this.nameController,UserOperationController:this.userOperationController,AuthenticationController:this.authenticationController,UserStorageController:this.userStorageController,MetamaskNotificationsController:this.metamaskNotificationsController,PushPlatformNotificationsController:this.pushPlatformNotificationsController,...qe}),this.memStore=new Ue.default({config:{AccountsController:this.accountsController,AppStateController:this.appStateController.store,AppMetadataController:this.appMetadataController.store,MultichainBalancesController:this.multichainBalancesController,NetworkController:this.networkController,KeyringController:this.keyringController,PreferencesController:this.preferencesController.store,MetaMetricsController:this.metaMetricsController.store,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,AlertController:this.alertController.store,OnboardingController:this.onboardingController.store,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,NetworkOrderController:this.networkOrderController,AccountOrderController:this.accountOrderController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,TxController:this.txController,MultichainRatesController:this.multichainRatesController,SnapController:this.snapController,CronjobController:this.cronjobController,SnapsRegistry:this.snapsRegistry,NotificationController:this.notificationController,SnapInterfaceController:this.snapInterfaceController,NameController:this.nameController,UserOperationController:this.userOperationController,AuthenticationController:this.authenticationController,UserStorageController:this.userStorageController,MetamaskNotificationsController:this.metamaskNotificationsController,QueuedRequestController:this.queuedRequestController,PushPlatformNotificationsController:this.pushPlatformNotificationsController,...qe},controllerMessenger:this.controllerMessenger});const We=[this.accountTracker.resetState,this.decryptMessageController.resetState.bind(this.decryptMessageController),this.encryptionPublicKeyController.resetState.bind(this.encryptionPublicKeyController),this.signatureController.resetState.bind(this.signatureController),this.swapsController.resetState,this.ensController.resetState.bind(this.ensController),this.approvalController.clear.bind(this.approvalController)];ke.isManifestV3?!0===t&&(this.resetStates(We),this.extension.storage.session.set({isFirstMetaMaskControllerSetup:!1})):this.resetStates(We);!this.isUnlocked()&&this.onboardingController.store.getState().completedOnboarding,this._startUISync(),this.extension.runtime.getPlatformInfo().then((({os:e})=>{this.appStateController.setBrowserEnvironment(e,this.extension.runtime.getBrowserInfo===undefined?"chrome":"firefox")})),this.setupControllerEventSubscriptions(),this.setupMultichainDataAndSubscriptions(),this.publicConfigStore=this.createPublicConfigStore(),this.extension.runtime.onMessageExternal.addListener(Be.onMessageReceived),(0,Be.checkForMultipleVersionsRunning)(),this.onboardingController.store.getState().completedOnboarding&&this.postOnboardingInitialization()}postOnboardingInitialization(){const{usePhishDetect:e}=this.preferencesController.store.getState();this.networkController.lookupNetwork(),e&&this.phishingController.maybeUpdateState()}triggerNetworkrequests(){this.accountTracker.start(),this.txController.startIncomingTransactionPolling(),this.tokenDetectionController.enable();const e=this.preferencesController.store.getState(),{useCurrencyRateCheck:t}=e;t&&this.tokenRatesController.start(),Ot(this,Ft,$t).call(this,e)&&this.tokenListController.start()}stopNetworkRequests(){this.accountTracker.stop(),this.txController.stopIncomingTransactionPolling(),this.tokenDetectionController.disable();const e=this.preferencesController.store.getState(),{useCurrencyRateCheck:t}=e;t&&this.tokenRatesController.stop(),Ot(this,Ft,$t).call(this,e)&&this.tokenListController.stop()}resetStates(e){e.forEach((e=>{try{e()}catch(e){console.error(e)}}))}async getSnapKeyring(){let[e]=this.keyringController.getKeyringsByType(ce.KeyringType.snap);return e||(e=await this.keyringController.addNewKeyring(ce.KeyringType.snap)),e}trackInsightSnapView(e){this.metaMetricsController.trackEvent({event:pe.MetaMetricsEventName.InsightSnapViewed,category:pe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e}})}_getSnapMetadata(e){var t;return null===(t=this.snapsRegistry.state.database)||void 0===t||null===(t=t.verifiedSnaps)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.metadata}async handleSnapRequest(e){try{const t=await this.controllerMessenger.call("SnapController:handleRequest",e);return this._trackSnapExportUsage(e.snapId,e.handler,!0,e.origin),t}catch(t){throw this._trackSnapExportUsage(e.snapId,e.handler,!1,e.origin),t}}getLocale(){const{currentLocale:e}=this.preferencesController.store.getState();return e}getSnapPermissionSpecifications(){return{...(0,$.buildSnapEndowmentSpecifications)(Object.keys(le.ExcludedSnapEndowments)),...(0,$.buildSnapRestrictedMethodSpecifications)(Object.keys(le.ExcludedSnapPermissions),{getLocale:this.getLocale.bind(this),clearSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:clearSnapState"),getMnemonic:this.getPrimaryKeyringMnemonic.bind(this),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),handleSnapRpcRequest:this.handleSnapRequest.bind(this),getSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getSnapState"),showDialog:(e,t,r,n)=>this.approvalController.addAndShowApprovalRequest({origin:e,type:he.SNAP_DIALOG_TYPES[t],requestData:{id:r,placeholder:n}}),showNativeNotification:(e,t)=>this.controllerMessenger.call("RateLimitController:call",e,"showNativeNotification",e,t.message),showInAppNotification:(e,t)=>this.controllerMessenger.call("RateLimitController:call",e,"showInAppNotification",e,t.message),updateSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:updateSnapState"),maybeUpdatePhishingList:()=>{const{usePhishDetect:e}=this.preferencesController.store.getState();e&&this.controllerMessenger.call("PhishingController:maybeUpdateState")},isOnPhishingList:e=>{const{usePhishDetect:t}=this.preferencesController.store.getState();return!!t&&this.controllerMessenger.call("PhishingController:testOrigin",e).result},createInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:createInterface"),getInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:getInterface"),getSnapKeyring:this.getSnapKeyring.bind(this)})}}dismissNotifications(e){this.notificationController.dismiss(e)}markNotificationsAsRead(e){this.notificationController.markRead(e)}setupControllerEventSubscriptions(){let e;this.preferencesController.store.subscribe((0,st.previousValueComparator)(((e,t)=>{Ot(this,Bt,Lt).call(this,t,e)}),this.preferencesController.store.getState())),this.controllerMessenger.subscribe(`${this.accountsController.name}:selectedAccountChange`,(async t=>{t.address&&t.address!==e&&(e=t.address,await this._onAccountChange(t.address))})),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,(async(e,t)=>{const r=(0,lt.getChangedAccounts)(e,t);for(const[e,t]of r.entries())this._notifyAccountsChange(e,t)}),lt.getPermittedAccountsByOrigin),this.controllerMessenger.subscribe("NetworkController:networkDidChange",(async()=>{await this.txController.updateIncomingTransactions()})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstallStarted`,((e,t,r)=>{var n;const s=null===(n=this._getSnapMetadata(e))||void 0===n?void 0:n.category;this.metaMetricsController.trackEvent({event:r?pe.MetaMetricsEventName.SnapUpdateStarted:pe.MetaMetricsEventName.SnapInstallStarted,category:pe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,origin:t,snap_category:s}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstallFailed`,((e,t,r,n)=>{var s;const o=n.includes("User rejected the request."),i=r?pe.MetaMetricsEventName.SnapUpdateFailed:pe.MetaMetricsEventName.SnapInstallFailed,a=r?pe.MetaMetricsEventName.SnapUpdateRejected:pe.MetaMetricsEventName.SnapInstallRejected,c=null===(s=this._getSnapMetadata(e))||void 0===s?void 0:s.category;this.metaMetricsController.trackEvent({event:o?a:i,category:pe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,origin:t,snap_category:c}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstalled`,((e,t)=>{var r;const n=e.id,s=null===(r=this._getSnapMetadata(n))||void 0===r?void 0:r.category;this.metaMetricsController.trackEvent({event:pe.MetaMetricsEventName.SnapInstalled,category:pe.MetaMetricsEventCategory.Snaps,properties:{snap_id:n,version:e.version,origin:t,snap_category:s}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUpdated`,((e,t,r)=>{var n;const s=e.id,o=null===(n=this._getSnapMetadata(s))||void 0===n?void 0:n.category;this.metaMetricsController.trackEvent({event:pe.MetaMetricsEventName.SnapUpdated,category:pe.MetaMetricsEventCategory.Snaps,properties:{snap_id:s,old_version:t,new_version:e.version,origin:r,snap_category:o}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapTerminated`,(e=>{const t=Object.values(this.approvalController.state.pendingApprovals).filter((t=>t.origin===e.id&&t.type.startsWith(le.RestrictedMethods.snap_dialog)));for(const e of t)this.approvalController.reject(e.id,new Error("Snap was terminated."))})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUninstalled`,(e=>{var t;const r=Object.values(this.notificationController.state.notifications).reduce(((t,r)=>(r.origin===e.id&&t.push(r.id),t)),[]);this.dismissNotifications(r);const n=e.id,s=null===(t=this._getSnapMetadata(n))||void 0===t?void 0:t.category;this.metaMetricsController.trackEvent({event:pe.MetaMetricsEventName.SnapUninstalled,category:pe.MetaMetricsEventCategory.Snaps,properties:{snap_id:n,version:e.version,snap_category:s}})}))}setupMultichainDataAndSubscriptions(){(0,te.isEvmAccountType)(this.accountsController.getSelectedMultichainAccount().type)||this.multichainRatesController.start(),this.controllerMessenger.subscribe("AccountsController:selectedAccountChange",(e=>{(0,te.isEvmAccountType)(e.type)?this.multichainRatesController.stop():this.multichainRatesController.start()})),this.multichainBalancesController.start(),this.multichainBalancesController.updateBalances()}createPublicConfigStore(){const e=new i.ObservableStore,t=async({isUnlocked:e})=>{const{chainId:t,networkVersion:r}=await this.getProviderNetworkState();return{isUnlocked:e,chainId:t,networkVersion:r??"loading"}},r=async r=>{var n;(null===(n=r.networksMetadata[r.selectedNetworkClientId])||void 0===n?void 0:n.status)===oe.NetworkStatus.Available&&e.putState(await t(r))};return this.on("update",r),r(this.getState()),e}async getProviderState(e){const t=await this.getProviderNetworkState(this.preferencesController.getUseRequestQueue()?e:undefined);return{isUnlocked:this.isUnlocked(),accounts:await this.getPermittedAccounts(e),...t}}async getProviderNetworkState(e=B.METAMASK_DOMAIN){const t=this.controllerMessenger.call("SelectedNetworkController:getNetworkClientIdForDomain",e),r=this.controllerMessenger.call("NetworkController:getNetworkClientById",t),{chainId:n}=r.configuration,{completedOnboarding:s}=this.onboardingController.store.getState();let o=this.deprecatedNetworkVersions[t];if(!o&&s){const e=new b.default(r.provider);o=await new Promise((t=>{e.sendAsync({method:"net_version"},((e,r)=>{e?(console.error(e),t(null)):t((0,ve.convertNetworkId)(r))}))})),this.deprecatedNetworkVersions[t]=o}return{chainId:n,networkVersion:o??"loading"}}getState(){const{vault:e}=this.keyringController.state,t=Boolean(e),r=this.memStore.getFlatState();return delete r.vault,{isInitialized:t,...r,snapStates:{},unencryptedSnapStates:{},snaps:Object.values(r.snaps??{}).reduce(((e,t)=>{const{sourceCode:r,auxiliaryFiles:n,...s}=t;return e[t.id]=s,e}),{})}}getApi(){const{accountsController:e,addressBookController:t,alertController:r,appStateController:n,keyringController:s,nftController:o,nftDetectionController:i,currencyRateController:a,tokenDetectionController:c,ensController:l,gasFeeController:u,metaMetricsController:d,networkController:h,announcementController:p,onboardingController:m,permissionController:g,preferencesController:f,bridgeController:y,swapsController:w,tokensController:C,smartTransactionsController:k,txController:v,assetsContractController:S,backup:T,approvalController:_,phishingController:E,authenticationController:A,userStorageController:M,metamaskNotificationsController:P,pushPlatformNotificationsController:I}=this;return{getState:this.getState.bind(this),setCurrentCurrency:a.setCurrentCurrency.bind(a),setUseBlockie:f.setUseBlockie.bind(f),setUseNonceField:f.setUseNonceField.bind(f),setUsePhishDetect:f.setUsePhishDetect.bind(f),setUseMultiAccountBalanceChecker:f.setUseMultiAccountBalanceChecker.bind(f),setUseSafeChainsListValidation:f.setUseSafeChainsListValidation.bind(f),setUseTokenDetection:f.setUseTokenDetection.bind(f),setUseNftDetection:f.setUseNftDetection.bind(f),setUse4ByteResolution:f.setUse4ByteResolution.bind(f),setUseCurrencyRateCheck:f.setUseCurrencyRateCheck.bind(f),setOpenSeaEnabled:f.setOpenSeaEnabled.bind(f),getUseRequestQueue:this.preferencesController.getUseRequestQueue.bind(this.preferencesController),getProviderConfig:()=>this.networkController.state.providerConfig,setSecurityAlertsEnabled:f.setSecurityAlertsEnabled.bind(f),setAddSnapAccountEnabled:f.setAddSnapAccountEnabled.bind(f),setBitcoinSupportEnabled:f.setBitcoinSupportEnabled.bind(f),setBitcoinTestnetSupportEnabled:f.setBitcoinTestnetSupportEnabled.bind(f),setUseExternalNameSources:f.setUseExternalNameSources.bind(f),setUseTransactionSimulations:f.setUseTransactionSimulations.bind(f),setUseRequestQueue:this.setUseRequestQueue.bind(this),setIpfsGateway:f.setIpfsGateway.bind(f),setIsIpfsGatewayEnabled:f.setIsIpfsGatewayEnabled.bind(f),setUseAddressBarEnsResolution:f.setUseAddressBarEnsResolution.bind(f),setParticipateInMetaMetrics:d.setParticipateInMetaMetrics.bind(d),setDataCollectionForMarketing:d.setDataCollectionForMarketing.bind(d),setCurrentLocale:f.setCurrentLocale.bind(f),setIncomingTransactionsPreferences:f.setIncomingTransactionsPreferences.bind(f),setServiceWorkerKeepAlivePreference:f.setServiceWorkerKeepAlivePreference.bind(f),markPasswordForgotten:this.markPasswordForgotten.bind(this),unMarkPasswordForgotten:this.unMarkPasswordForgotten.bind(this),getRequestAccountTabIds:this.getRequestAccountTabIds,getOpenMetamaskTabsIds:this.getOpenMetamaskTabsIds,markNotificationPopupAsAutomaticallyClosed:()=>this.notificationManager.markAsAutomaticallyClosed(),requestUserApproval:_.addAndShowApprovalRequest.bind(_),addNewAccount:this.addNewAccount.bind(this),getSeedPhrase:this.getSeedPhrase.bind(this),resetAccount:this.resetAccount.bind(this),removeAccount:this.removeAccount.bind(this),importAccountWithStrategy:this.importAccountWithStrategy.bind(this),getNextAvailableAccountName:e.getNextAvailableAccountName.bind(e),getAccountsBySnapId:e=>(0,gt.getAccountsBySnapId)(this,e),connectHardware:this.connectHardware.bind(this),forgetDevice:this.forgetDevice.bind(this),checkHardwareStatus:this.checkHardwareStatus.bind(this),unlockHardwareWalletAccount:this.unlockHardwareWalletAccount.bind(this),attemptLedgerTransportCreation:this.attemptLedgerTransportCreation.bind(this),submitQRHardwareCryptoHDKey:s.submitQRCryptoHDKey.bind(s),submitQRHardwareCryptoAccount:s.submitQRCryptoAccount.bind(s),cancelSyncQRHardware:s.cancelQRSynchronization.bind(s),submitQRHardwareSignature:s.submitQRSignature.bind(s),cancelQRHardwareSignRequest:s.cancelQRSignRequest.bind(s),submitPassword:this.submitPassword.bind(this),verifyPassword:this.verifyPassword.bind(this),setProviderType:e=>this.networkController.setProviderType(e),setActiveNetwork:e=>this.networkController.setActiveNetwork(e),setActiveNetworkConfigurationId:e=>{this.networkController.setActiveNetwork(e)},setNetworkClientIdForDomain:(e,t)=>this.selectedNetworkController.setNetworkClientIdForDomain(e,t),rollbackToPreviousProvider:h.rollbackToPreviousProvider.bind(h),removeNetworkConfiguration:this.removeNetworkConfiguration.bind(this),upsertNetworkConfiguration:this.networkController.upsertNetworkConfiguration.bind(this.networkController),getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getNetworkConfigurationByNetworkClientId:this.networkController.getNetworkConfigurationByNetworkClientId.bind(this.networkController),setSelectedAddress:e=>{const t=this.accountsController.getAccountByAddress(e);if(!t)throw new Error(`No account found for address: ${e}`);this.accountsController.setSelectedAccount(t.id)},toggleExternalServices:this.toggleExternalServices.bind(this),addToken:C.addToken.bind(C),updateTokenType:C.updateTokenType.bind(C),setFeatureFlag:f.setFeatureFlag.bind(f),setPreference:f.setPreference.bind(f),addKnownMethodData:f.addKnownMethodData.bind(f),setDismissSeedBackUpReminder:f.setDismissSeedBackUpReminder.bind(f),setDisabledRpcMethodPreference:f.setDisabledRpcMethodPreference.bind(f),getRpcMethodPreferences:f.getRpcMethodPreferences.bind(f),setAdvancedGasFee:f.setAdvancedGasFee.bind(f),setTheme:f.setTheme.bind(f),setSnapsAddSnapAccountModalDismissed:f.setSnapsAddSnapAccountModalDismissed.bind(f),setSelectedInternalAccount:e=>{this.accountsController.getAccount(e)&&this.accountsController.setSelectedAccount(e)},setAccountName:e.setAccountName.bind(e),setAccountLabel:(e,t)=>{this.preferencesController.setAccountLabel(e,t);const r=this.accountsController.getAccountByAddress(e);if(r===undefined)throw new Error(`No account found for address: ${e}`);this.accountsController.setAccountName(r.id,t)},getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),getTokenSymbol:this.getTokenSymbol.bind(this),addNft:o.addNft.bind(o),addNftVerifyOwnership:o.addNftVerifyOwnership.bind(o),removeAndIgnoreNft:o.removeAndIgnoreNft.bind(o),removeNft:o.removeNft.bind(o),checkAndUpdateAllNftsOwnershipStatus:o.checkAndUpdateAllNftsOwnershipStatus.bind(o),checkAndUpdateSingleNftOwnershipStatus:o.checkAndUpdateSingleNftOwnershipStatus.bind(o),isNftOwner:o.isNftOwner.bind(o),setAddressBook:t.set.bind(t),removeFromAddressBook:t.delete.bind(t),setLastActiveTime:n.setLastActiveTime.bind(n),setCurrentExtensionPopupId:n.setCurrentExtensionPopupId.bind(n),setDefaultHomeActiveTabName:n.setDefaultHomeActiveTabName.bind(n),setConnectedStatusPopoverHasBeenShown:n.setConnectedStatusPopoverHasBeenShown.bind(n),setRecoveryPhraseReminderHasBeenShown:n.setRecoveryPhraseReminderHasBeenShown.bind(n),setRecoveryPhraseReminderLastShown:n.setRecoveryPhraseReminderLastShown.bind(n),setTermsOfUseLastAgreed:n.setTermsOfUseLastAgreed.bind(n),setSurveyLinkLastClickedOrClosed:n.setSurveyLinkLastClickedOrClosed.bind(n),setOnboardingDate:n.setOnboardingDate.bind(n),setNewPrivacyPolicyToastClickedOrClosed:n.setNewPrivacyPolicyToastClickedOrClosed.bind(n),setNewPrivacyPolicyToastShownDate:n.setNewPrivacyPolicyToastShownDate.bind(n),setSnapsInstallPrivacyWarningShownStatus:n.setSnapsInstallPrivacyWarningShownStatus.bind(n),setOutdatedBrowserWarningLastShown:n.setOutdatedBrowserWarningLastShown.bind(n),setShowTestnetMessageInDropdown:n.setShowTestnetMessageInDropdown.bind(n),setShowBetaHeader:n.setShowBetaHeader.bind(n),setShowPermissionsTour:n.setShowPermissionsTour.bind(n),setShowAccountBanner:n.setShowAccountBanner.bind(n),setShowNetworkBanner:n.setShowNetworkBanner.bind(n),updateNftDropDownState:n.updateNftDropDownState.bind(n),setFirstTimeUsedNetwork:n.setFirstTimeUsedNetwork.bind(n),setSwitchedNetworkDetails:n.setSwitchedNetworkDetails.bind(n),clearSwitchedNetworkDetails:n.clearSwitchedNetworkDetails.bind(n),setSwitchedNetworkNeverShowMessage:n.setSwitchedNetworkNeverShowMessage.bind(n),tryReverseResolveAddress:l.reverseResolveAddress.bind(l),setLocked:this.setLocked.bind(this),createNewVaultAndKeychain:this.createNewVaultAndKeychain.bind(this),createNewVaultAndRestore:this.createNewVaultAndRestore.bind(this),exportAccount:this.exportAccount.bind(this),updateTransaction:v.updateTransaction.bind(v),approveTransactionsWithSameNonce:v.approveTransactionsWithSameNonce.bind(v),createCancelTransaction:this.createCancelTransaction.bind(this),createSpeedUpTransaction:this.createSpeedUpTransaction.bind(this),estimateGas:this.estimateGas.bind(this),getNextNonce:this.getNextNonce.bind(this),addTransaction:(e,t)=>(0,yt.addTransaction)(this.getAddTransactionRequest({transactionParams:e,transactionOptions:t,waitForSubmit:!1})),addTransactionAndWaitForPublish:(e,t)=>(0,yt.addTransaction)(this.getAddTransactionRequest({transactionParams:e,transactionOptions:t,waitForSubmit:!0})),createTransactionEventFragment:Me.createTransactionEventFragmentWithTxId.bind(null,this.getTransactionMetricsRequest()),getTransactions:this.txController.getTransactions.bind(this.txController),updateEditableParams:this.txController.updateEditableParams.bind(this.txController),updateTransactionGasFees:v.updateTransactionGasFees.bind(v),updateTransactionSendFlowHistory:v.updateTransactionSendFlowHistory.bind(v),updatePreviousGasParams:v.updatePreviousGasParams.bind(v),abortTransactionSigning:v.abortTransactionSigning.bind(v),getLayer1GasFee:v.getLayer1GasFee.bind(v),decryptMessage:this.decryptMessageController.decryptMessage.bind(this.decryptMessageController),decryptMessageInline:this.decryptMessageController.decryptMessageInline.bind(this.decryptMessageController),cancelDecryptMessage:this.decryptMessageController.cancelDecryptMessage.bind(this.decryptMessageController),encryptionPublicKey:this.encryptionPublicKeyController.encryptionPublicKey.bind(this.encryptionPublicKeyController),cancelEncryptionPublicKey:this.encryptionPublicKeyController.cancelEncryptionPublicKey.bind(this.encryptionPublicKeyController),setSeedPhraseBackedUp:m.setSeedPhraseBackedUp.bind(m),completeOnboarding:m.completeOnboarding.bind(m),setFirstTimeFlowType:m.setFirstTimeFlowType.bind(m),setAlertEnabledness:r.setAlertEnabledness.bind(r),setUnconnectedAccountAlertShown:r.setUnconnectedAccountAlertShown.bind(r),setWeb3ShimUsageAlertDismissed:r.setWeb3ShimUsageAlertDismissed.bind(r),removePermissionsFor:this.removePermissionsFor,approvePermissionsRequest:this.acceptPermissionsRequest,rejectPermissionsRequest:this.rejectPermissionsRequest,...(0,lt.getPermissionBackgroundApiMethods)(g),disableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disable"),enableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:enable"),updateSnap:(e,t)=>(this.controllerMessenger.call("SnapController:install",e,t),null),removeSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:remove"),handleSnapRequest:this.handleSnapRequest.bind(this),revokeDynamicSnapPermissions:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:revokeDynamicPermissions"),dismissNotifications:this.dismissNotifications.bind(this),markNotificationsAsRead:this.markNotificationsAsRead.bind(this),disconnectOriginFromSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disconnectOrigin"),updateNetworksList:this.updateNetworksList.bind(this),updateAccountsList:this.updateAccountsList.bind(this),updateHiddenAccountsList:this.updateHiddenAccountsList.bind(this),getPhishingResult:async e=>(await E.maybeUpdateState(),E.test(e)),deleteInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:deleteInterface"),updateInterfaceState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:updateInterfaceState"),fetchAndSetQuotes:w.fetchAndSetQuotes.bind(w),setSelectedQuoteAggId:w.setSelectedQuoteAggId.bind(w),resetSwapsState:w.resetSwapsState.bind(w),setSwapsTokens:w.setSwapsTokens.bind(w),clearSwapsQuotes:w.clearSwapsQuotes.bind(w),setApproveTxId:w.setApproveTxId.bind(w),setTradeTxId:w.setTradeTxId.bind(w),setSwapsTxGasPrice:w.setSwapsTxGasPrice.bind(w),setSwapsTxGasLimit:w.setSwapsTxGasLimit.bind(w),setSwapsTxMaxFeePerGas:w.setSwapsTxMaxFeePerGas.bind(w),setSwapsTxMaxFeePriorityPerGas:w.setSwapsTxMaxFeePriorityPerGas.bind(w),safeRefetchQuotes:w.safeRefetchQuotes.bind(w),stopPollingForQuotes:w.stopPollingForQuotes.bind(w),setBackgroundSwapRouteState:w.setBackgroundSwapRouteState.bind(w),resetPostFetchState:w.resetPostFetchState.bind(w),setSwapsErrorKey:w.setSwapsErrorKey.bind(w),setInitialGasEstimate:w.setInitialGasEstimate.bind(w),setCustomApproveTxData:w.setCustomApproveTxData.bind(w),setSwapsLiveness:w.setSwapsLiveness.bind(w),setSwapsFeatureFlags:w.setSwapsFeatureFlags.bind(w),setSwapsUserFeeLevel:w.setSwapsUserFeeLevel.bind(w),setSwapsQuotesPollingLimitEnabled:w.setSwapsQuotesPollingLimitEnabled.bind(w),setBridgeFeatureFlags:y.setBridgeFeatureFlags.bind(y),fetchSmartTransactionFees:k.getFees.bind(k),clearSmartTransactionFees:k.clearFees.bind(k),submitSignedTransactions:k.submitSignedTransactions.bind(k),cancelSmartTransaction:k.cancelSmartTransaction.bind(k),fetchSmartTransactionsLiveness:k.fetchLiveness.bind(k),updateSmartTransaction:k.updateSmartTransaction.bind(k),setStatusRefreshInterval:k.setStatusRefreshInterval.bind(k),trackMetaMetricsEvent:d.trackEvent.bind(d),trackMetaMetricsPage:d.trackPage.bind(d),createEventFragment:d.createEventFragment.bind(d),updateEventFragment:d.updateEventFragment.bind(d),finalizeEventFragment:d.finalizeEventFragment.bind(d),trackInsightSnapView:this.trackInsightSnapView.bind(this),resolvePendingApproval:this.resolvePendingApproval,rejectPendingApproval:this.rejectPendingApproval,resetViewedNotifications:p.resetViewed.bind(p),updateViewedNotifications:p.updateViewed.bind(p),currencyRateStartPollingByNetworkClientId:a.startPollingByNetworkClientId.bind(a),currencyRateStopPollingByPollingToken:a.stopPollingByPollingToken.bind(a),gasFeeStartPollingByNetworkClientId:u.startPollingByNetworkClientId.bind(u),gasFeeStopPollingByPollingToken:u.stopPollingByPollingToken.bind(u),getGasFeeTimeEstimate:u.getTimeEstimate.bind(u),addPollingTokenToAppState:n.addPollingToken.bind(n),removePollingTokenFromAppState:n.removePollingToken.bind(n),backupUserData:T.backupUserData.bind(T),restoreUserData:T.restoreUserData.bind(T),detectTokens:c.detectTokens.bind(c),detectNfts:i.detectNfts.bind(i),addDetectedTokens:C.addDetectedTokens.bind(C),addImportedTokens:C.addTokens.bind(C),ignoreTokens:C.ignoreTokens.bind(C),getBalancesInSingleCall:S.getBalancesInSingleCall.bind(S),performSignIn:A.performSignIn.bind(A),performSignOut:A.performSignOut.bind(A),enableProfileSyncing:M.enableProfileSyncing.bind(M),disableProfileSyncing:M.disableProfileSyncing.bind(M),setIsProfileSyncingEnabled:M.setIsProfileSyncingEnabled.bind(M),checkAccountsPresence:P.checkAccountsPresence.bind(P),createOnChainTriggers:P.createOnChainTriggers.bind(P),deleteOnChainTriggersByAccount:P.deleteOnChainTriggersByAccount.bind(P),updateOnChainTriggersByAccount:P.updateOnChainTriggersByAccount.bind(P),fetchAndUpdateMetamaskNotifications:P.fetchAndUpdateMetamaskNotifications.bind(P),markMetamaskNotificationsAsRead:P.markMetamaskNotificationsAsRead.bind(P),setFeatureAnnouncementsEnabled:P.setFeatureAnnouncementsEnabled.bind(P),enablePushNotifications:I.enablePushNotifications.bind(I),disablePushNotifications:I.disablePushNotifications.bind(I),updateTriggerPushNotifications:I.updateTriggerPushNotifications.bind(I),enableMetamaskNotifications:P.enableMetamaskNotifications.bind(P),disableMetamaskNotifications:P.disableMetamaskNotifications.bind(P),throwTestError:this.throwTestError.bind(this),updateProposedNames:this.nameController.updateProposedNames.bind(this.nameController),setName:this.nameController.setName.bind(this.nameController),multichainUpdateBalance:e=>this.multichainBalancesController.updateBalance(e),multichainUpdateBalances:()=>this.multichainBalancesController.updateBalances(),decodeTransactionData:e=>(0,It.decodeTransactionData)({...e,ethQuery:new b.default(this.provider)}),endTrace:Ee.endTrace}}async exportAccount(e,t){return await this.verifyPassword(t),this.keyringController.exportAccount(t,e)}async getTokenStandardAndDetails(e,t,r){var n,s;const{tokenList:o}=this.tokenListController.state,{tokens:i}=this.tokensController.state,a={...we.STATIC_MAINNET_TOKEN_LIST[e.toLowerCase()]||{},...o[e.toLowerCase()]||{},...i.find((({address:t})=>(0,fe.isEqualCaseInsensitive)(t,e)))||{}},c=(0,fe.isEqualCaseInsensitive)(a.standard,ne.TokenStandard.ERC20)||!0===a.erc20,l=!(r||(0,fe.isEqualCaseInsensitive)(a.standard,ne.TokenStandard.ERC1155)||(0,fe.isEqualCaseInsensitive)(a.standard,ne.TokenStandard.ERC721)||a.erc721),u=a.decimals!==undefined&&a.symbol;let d;if(c||l&&u)try{const r=t?await(0,ge.fetchTokenBalance)(e,t,this.provider):undefined;d={address:e,balance:r,standard:ne.TokenStandard.ERC20,decimals:a.decimals,symbol:a.symbol}}catch(e){y.default.warn(`Failed to get token balance. Error: ${e}`)}d===undefined&&(d=await this.assetsContractController.getTokenStandardAndDetails(e,t,r));if((0,fe.isEqualCaseInsensitive)(d.standard,ne.TokenStandard.ERC1155))try{const n=await(0,ge.fetchERC1155Balance)(e,t,r,this.provider),s=null!=n&&n._hex?parseInt(n._hex,16).toString():null;d={...d,balance:s}}catch(e){y.default.warn("Failed to get token balance. Error:",e)}return{...d,decimals:null===(n=d)||void 0===n||null===(n=n.decimals)||void 0===n?void 0:n.toString(10),balance:null===(s=d)||void 0===s||null===(s=s.balance)||void 0===s?void 0:s.toString(10)}}async getTokenSymbol(e){try{const t=await this.assetsContractController.getTokenStandardAndDetails(e);return null==t?void 0:t.symbol}catch(e){return null}}async createNewVaultAndKeychain(e){const t=await this.createVaultMutex.acquire();try{return await this.keyringController.createNewVaultAndKeychain(e)}finally{t()}}async createNewVaultAndRestore(e,r){const n=await this.createVaultMutex.acquire();try{const{completedOnboarding:n}=this.onboardingController.store.getState(),s=t.from(r);this.permissionController.clearState(),this.snapController.clearState(),this.notificationController.clear(),this.accountTracker.clearAccounts(),this.txController.clearUnapprovedTransactions(),n&&this.tokenDetectionController.enable(),await this.keyringController.createNewVaultAndRestore(e,this._convertMnemonicToWordlistIndices(s)),n&&(await this._addAccountsWithBalance(),this.setLedgerTransportPreference())}finally{n()}}async _addAccountsWithBalance(){const{chainId:e}=this.networkController.state.providerConfig,t=new b.default(this.provider),r=await this.keyringController.getAccounts();let n=r[r.length-1];for(let i=r.length;;i++){if("0x0"===await this.getBalance(n,t)){var s,o;await this.tokenDetectionController.detectTokens({selectedAddress:n});const t=null===(s=this.tokensController.state.allTokens)||void 0===s||null===(s=s[e])||void 0===s?void 0:s[n],r=null===(o=this.tokensController.state.allDetectedTokens)||void 0===o||null===(o=o[e])||void 0===o?void 0:o[n];if(0===((null==t?void 0:t.length)??0)&&0===((null==r?void 0:r.length)??0)){1!==i&&await this.removeAccount(n);break}}n=await this.keyringController.addNewAccount(i)}}_convertMnemonicToWordlistIndices(e){const t=e.toString().split(" ").map((e=>V.wordlist.indexOf(e)));return new Uint8Array(new Uint16Array(t).buffer)}_convertEnglishWordlistIndicesToCodepoints(e){return t.from(Array.from(new Uint16Array(e.buffer)).map((e=>V.wordlist[e])).join(" "))}getBalance(e,t){return new Promise(((r,n)=>{const s=this.accountTracker.store.getState().accounts[e];s&&s.balance?r(s.balance):t.getBalance(e,((e,t)=>{e?(n(e),y.default.error(e)):r(t||"0x0")}))}))}async submitPassword(e){const{completedOnboarding:t}=this.onboardingController.store.getState();await this.offscreenPromise,await this.keyringController.submitPassword(e);try{await this.blockTracker.checkForLatestBlock()}catch(e){y.default.error("Error while unlocking extension.",e)}await this.accountsController.updateAccounts(),t&&this.setLedgerTransportPreference()}async _loginUser(e){try{await this.submitPassword(e),await this.accountTracker.updateAccountsAllActiveNetworks()}finally{this._startUISync()}}_startUISync(){this.emit("startUISync"),this.startUISync=!0,this.memStore.subscribe(this.sendUpdate.bind(this))}async submitEncryptionKey(){try{const{loginToken:e,loginSalt:t}=await this.extension.storage.session.get(["loginToken","loginSalt"]);if(e&&t){const{vault:r}=this.keyringController.state;if(JSON.parse(r).salt!==t)return console.warn("submitEncryptionKey: Stored salt and vault salt do not match"),void await this.clearLoginArtifacts();await this.keyringController.submitEncryptionKey(e,t)}}catch(e){throw await this.clearLoginArtifacts(),e}}async clearLoginArtifacts(){await this.extension.storage.session.remove(["loginToken","loginSalt"])}async verifyPassword(e){await this.keyringController.verifyPassword(e)}getPrimaryKeyringMnemonic(){const[e]=this.keyringController.getKeyringsByType(ce.KeyringType.hdKeyTree);if(!e.mnemonic)throw new Error("Primary keyring mnemonic unavailable.");return e.mnemonic}async getKeyringForDevice(e,t=null){var r,n,s,o;const i=null===(r=this.opts.overrides)||void 0===r?void 0:r.keyrings;let a=null;switch(e){case ae.HardwareDeviceNames.trezor:a=(null==i||null===(n=i.trezor)||void 0===n?void 0:n.type)||w.TrezorKeyring.type;break;case ae.HardwareDeviceNames.ledger:a=(null==i||null===(s=i.ledger)||void 0===s?void 0:s.type)||C.LedgerKeyring.type;break;case ae.HardwareDeviceNames.qr:a=v.MetaMaskKeyring.type;break;case ae.HardwareDeviceNames.lattice:a=(null==i||null===(o=i.lattice)||void 0===o?void 0:o.type)||k.default.type;break;default:throw new Error("MetamaskController:getKeyringForDevice - Unknown device")}let[c]=await this.keyringController.getKeyringsByType(a);if(c||(c=await this.keyringController.addNewKeyring(a)),t&&c.setHdPath&&c.setHdPath(t),e===ae.HardwareDeviceNames.lattice&&(c.appName="MetaMask"),e===ae.HardwareDeviceNames.trezor){const e=c.getModel();this.appStateController.setTrezorModel(e)}return c.network=this.networkController.state.providerConfig.type,c}async attemptLedgerTransportCreation(){const e=await this.getKeyringForDevice(ae.HardwareDeviceNames.ledger);return await e.attemptMakeApp()}async connectHardware(e,t,r){const n=await this.getKeyringForDevice(e,r);e===ae.HardwareDeviceNames.ledger&&await this.setLedgerTransportPreference(n);let s=[];switch(t){case-1:s=await n.getPreviousPage();break;case 1:s=await n.getNextPage();break;default:s=await n.getFirstPage()}const o=await this.keyringController.getAccounts(),i=[...new Set(o.concat(s.map((e=>e.address.toLowerCase()))))];return this.accountTracker.syncWithAddresses(i),s}async checkHardwareStatus(e,t){return(await this.getKeyringForDevice(e,t)).isUnlocked()}async forgetDevice(e){const t=await this.getKeyringForDevice(e);for(const e of t.accounts)await this.removeAccount(e);return t.forgetDevice(),!0}async getAccountType(e){switch(await this.keyringController.getAccountKeyringType(e)){case ce.KeyringType.trezor:case ce.KeyringType.lattice:case ce.KeyringType.qr:case ce.KeyringType.ledger:return"hardware";case ce.KeyringType.imported:return"imported";case ce.KeyringType.snap:return"snap";default:return"MetaMask"}}async getDeviceModel(e){const t=await this.keyringController.getKeyringForAccount(e);switch(t.type){case ce.KeyringType.trezor:return t.getModel();case ce.KeyringType.qr:return t.getName();case ce.KeyringType.ledger:return ae.HardwareDeviceNames.ledger;case ce.KeyringType.lattice:return ae.HardwareDeviceNames.lattice;default:return undefined}}getAccountLabel(e,t,r){return`${e[0].toUpperCase()}${e.slice(1)} ${parseInt(t,10)+1} ${r||""}`.trim()}async unlockHardwareWalletAccount(e,t,r,n){const s=await this.getKeyringForDevice(t,r);s.setAccountToUnlock(e);const o=await this.keyringController.addNewAccountForKeyring(s),i=this.getAccountLabel(t===ae.HardwareDeviceNames.qr?s.getName():t,e,n);this.preferencesController.setAccountLabel(o,i),this.preferencesController.setSelectedAddress(o);const a=this.accountsController.getAccountByAddress(o);this.accountsController.setAccountName(a.id,i);const c=this.accountsController.listAccounts(),{identities:l}=this.preferencesController.store.getState();return{unlockedAccount:o,identities:l,accounts:c}}async addNewAccount(e){const t=await this.keyringController.getAccounts(),r=await this.keyringController.addNewAccount(e);return t.includes(r)||this.preferencesController.setSelectedAddress(r),r}async getSeedPhrase(e){return this._convertEnglishWordlistIndicesToCodepoints(await this.keyringController.exportSeedPhrase(e))}async resetAccount(){const e=this.accountsController.getSelectedAccount().address;return this.txController.wipeTransactions(!1,e),this.smartTransactionsController.wipeSmartTransactions({address:e,ignoreNetwork:!1}),this.networkController.resetConnection(),e}async getPermittedAccounts(e,{suppressUnauthorizedError:t=!0}={}){try{return await this.permissionController.executeRestrictedMethod(e,le.RestrictedMethods.eth_accounts)}catch(e){if(t&&e.code===g.errorCodes.provider.unauthorized)return[];throw e}}removeAllChainIdPermissions(e){this.permissionController.updatePermissionsByCaveat(le.CaveatTypes.restrictNetworkSwitching,(t=>lt.CaveatMutatorFactories[le.CaveatTypes.restrictNetworkSwitching].removeChainId(e,t)))}removeNetworkConfiguration(e){const{networkConfigurations:t}=this.networkController.state,{chainId:r}=t[e]??{};if(!r)throw new Error("Network configuration not found");Object.values(t).some((t=>t.chainId===r&&t.id!==e&&t.type!==e))||this.removeAllChainIdPermissions(r),this.networkController.removeNetworkConfiguration(e)}removeAllAccountPermissions(e){this.permissionController.updatePermissionsByCaveat(le.CaveatTypes.restrictReturnedAccounts,(t=>lt.CaveatMutatorFactories[le.CaveatTypes.restrictReturnedAccounts].removeAccount(e,t)))}async removeAccount(e){this.removeAllAccountPermissions(e);const t=await this.keyringController.getKeyringForAccount(e);await this.keyringController.removeAccount(e);const r=t?await t.getAccounts():{};var n;0===(null==r?void 0:r.length)&&(null===(n=t.destroy)||void 0===n||n.call(t));return e}async importAccountWithStrategy(e,t){const r=await this.keyringController.importAccountWithStrategy(e,t);this.preferencesController.setSelectedAddress(r)}getAddTransactionRequest({transactionParams:e,transactionOptions:t,dappRequest:r}){var n;return{dappRequest:r,networkClientId:(null==r?void 0:r.networkClientId)??this.networkController.state.selectedNetworkClientId,selectedAccount:this.accountsController.getAccountByAddress(e.from),transactionController:this.txController,transactionOptions:t,transactionParams:e,userOperationController:this.userOperationController,chainId:this.networkController.state.providerConfig.chainId,ppomController:this.ppomController,securityAlertsEnabled:null===(n=this.preferencesController.store.getState())||void 0===n?void 0:n.securityAlertsEnabled,updateSecurityAlertResponse:this.updateSecurityAlertResponse.bind(this)}}async getCurrentAccountEIP1559Compatibility(){return!0}async createCancelTransaction(e,t,r){await this.txController.stopTransaction(e,t,r);return this.getState()}async createSpeedUpTransaction(e,t,r){await this.txController.speedUpTransaction(e,t,r);return this.getState()}async estimateGas(e){return new Promise(((t,r)=>new S.default(this.provider).estimateGas(e,((e,n)=>e?r(e):t(n.toString(16))))))}async updateSecurityAlertResponse(e,t,r){(0,Et.updateSecurityAlertResponse)({appStateController:this.appStateController,method:e,securityAlertId:t,securityAlertResponse:r,signatureController:this.signatureController,transactionController:this.txController})}markPasswordForgotten(){this.preferencesController.setPasswordForgotten(!0),this.sendUpdate()}unMarkPasswordForgotten(){this.preferencesController.setPasswordForgotten(!1),this.sendUpdate()}setUseRequestQueue(e){this.preferencesController.setUseRequestQueue(e)}setupUntrustedCommunicationEip1193({connectionStream:e,sender:t,subjectType:r}){if(t.url&&this.onboardingController.store.getState().completedOnboarding&&this.preferencesController.store.getState().usePhishDetect){const{hostname:r}=new URL(t.url);this.phishingController.maybeUpdateState();const n=this.phishingController.test(r);if(null!=n&&n.result)return this.sendPhishingWarning(e,r),void this.metaMetricsController.trackEvent({event:pe.MetaMetricsEventName.PhishingPageDisplayed,category:pe.MetaMetricsEventCategory.Phishing,properties:{url:r}})}let n;n=r||(t.id&&t.id!==this.extension.runtime.id?x.SubjectType.Extension:x.SubjectType.Website);const s=(0,Ve.setupMultiplex)(e);this.setupProviderConnectionEip1193(s.createStream("metamask-provider"),t,n),t.url&&this.setupPublicConfig(s.createStream("publicConfig"))}setupUntrustedCommunicationCaip({connectionStream:e,sender:t,subjectType:r}){let n;n=r||(t.id&&t.id!==this.extension.runtime.id?x.SubjectType.Extension:x.SubjectType.Website);const s=(0,Se.createCaipStream)(e);this.setupProviderConnectionCaip(s,t,n)}setupTrustedCommunication(e,t){const r=(0,Ve.setupMultiplex)(e);this.setupControllerConnection(r.createStream("controller")),this.setupProviderConnectionEip1193(r.createStream("provider"),t,x.SubjectType.Internal)}setupPhishingCommunication({connectionStream:e}){const{usePhishDetect:t}=this.preferencesController.store.getState();if(!t)return;const r=(0,Ve.setupMultiplex)(e).createStream("metamask-phishing-safelist");r.on("data",(0,nt.default)({safelistPhishingDomain:this.safelistPhishingDomain.bind(this),backToSafetyPhishingWarning:this.backToSafetyPhishingWarning.bind(this)},r))}sendPhishingWarning(e,t){(0,Ve.setupMultiplex)(e).createStream("phishing").write({hostname:t})}setupControllerConnection(e){const t=this.getApi();this.activeControllerConnections+=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.on("data",(0,nt.default)(t,e));const r=t=>{(0,Ve.isStreamWritable)(e)&&e.write({jsonrpc:"2.0",method:"sendUpdate",params:[t]})};this.on("update",r);const n=()=>{(0,Ve.isStreamWritable)(e)&&e.write({jsonrpc:"2.0",method:"startUISync"})};this.startUISync?n():this.once("startUISync",n);const o=()=>{e.mmFinished||(this.activeControllerConnections-=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.mmFinished=!0,this.removeListener("update",r))};e.mmFinished=!1,(0,s.finished)(e,o),e.once("close",o),e.once("end",o)}setupProviderConnectionEip1193(e,t,r){let n,o;n=r===x.SubjectType.Internal?he.ORIGIN_METAMASK:r===x.SubjectType.Snap?t.snapId:new URL(t.url).origin,t.id&&t.id!==this.extension.runtime.id&&this.subjectMetadataController.addSubjectMetadata({origin:n,extensionId:t.id,subjectType:x.SubjectType.Extension}),t.tab&&t.tab.id&&(o=t.tab.id);const i=this.setupProviderEngineEip1193({origin:n,sender:t,subjectType:r,tabId:o}),a=(0,De.default)(),c=(0,l.createEngineStream)({engine:i}),u=this.addConnection(n,{engine:i});(0,s.pipeline)(e,a,c,e,(e=>{var t;i._middleware.forEach((e=>{e.destroy&&"function"==typeof e.destroy&&e.destroy()})),u&&this.removeConnection(n,u),!e||null!==(t=e.message)&&void 0!==t&&t.match("Premature close")||y.default.error(e)})),r!==x.SubjectType.Internal&&this._notifyChainChangeForConnection({engine:i},n)}setupProviderConnectionCaip(e,t,r){let n,o;n=r===x.SubjectType.Internal?he.ORIGIN_METAMASK:r===x.SubjectType.Snap?t.snapId:new URL(t.url).origin,t.id&&t.id!==this.extension.runtime.id&&this.subjectMetadataController.addSubjectMetadata({origin:n,extensionId:t.id,subjectType:x.SubjectType.Extension}),t.tab&&t.tab.id&&(o=t.tab.id);const i=this.setupProviderEngineCaip({origin:n,tabId:o}),a=(0,De.default)(),c=(0,l.createEngineStream)({engine:i}),u=this.addConnection(n,{engine:i});(0,s.pipeline)(e,a,c,e,(e=>{i._middleware.forEach((e=>{e.destroy&&"function"==typeof e.destroy&&e.destroy()})),u&&this.removeConnection(n,u),e&&y.default.error(e)})),r!==x.SubjectType.Internal&&this._notifyChainChangeForConnection({engine:i},n)}setupSnapProvider(e,t){this.setupUntrustedCommunicationEip1193({connectionStream:t,sender:{snapId:e},subjectType:x.SubjectType.Snap})}setupProviderEngineEip1193({origin:e,subjectType:t,sender:r,tabId:n}){const s=new c.JsonRpcEngine;s.push((0,$e.default)({origin:e})),s.push((0,B.createSelectedNetworkMiddleware)(this.controllerMessenger));const o=(0,z.createQueuedRequestMiddleware)({enqueueRequest:this.queuedRequestController.enqueueRequest.bind(this.queuedRequestController),useRequestQueue:this.preferencesController.getUseRequestQueue.bind(this.preferencesController),shouldEnqueueRequest:e=>("eth_requestAccounts"!==e.method||!this.permissionController.hasPermission(e.origin,lt.PermissionNames.eth_accounts))&&re.methodsWithConfirmation.includes(e.method)});s.push(o);const i=this.selectedNetworkController.getProviderAndBlockTracker(e),a=(0,p.default)(i),l=(0,m.default)(i);l.events.on("notification",(e=>s.emit("notification",e))),n&&s.push((0,qe.default)({tabId:n})),s.push((0,Le.default)({origin:e})),s.push(this.permissionLogController.createMiddleware()),e===Te.BaseUrl.Portfolio&&s.push((0,_t.createTxVerificationMiddleware)(this.networkController)),s.push((0,xe.createPPOMMiddleware)(this.ppomController,this.preferencesController,this.networkController,this.appStateController,this.updateSecurityAlertResponse.bind(this)));return s.push((0,ut.default)({trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getMetricsState:this.metaMetricsController.store.getState.bind(this.metaMetricsController.store),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),isConfirmationRedesignEnabled:()=>this.preferencesController.store.getState().preferences.redesignedConfirmationsEnabled,snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),appStateController:this.appStateController})),s.push((0,He.createUnsupportedMethodMiddleware)()),s.push((0,He.createLegacyMethodMiddleware)({getAccounts:this.getPermittedAccounts.bind(this,e)})),t!==x.SubjectType.Internal&&s.push(this.permissionController.createPermissionMiddleware({origin:e})),t===x.SubjectType.Website&&s.push((0,We.default)({location:r.url,registerOnboarding:this.onboardingController.registerOnboarding})),s.push((0,At.default)({messenger:this.controllerMessenger.getRestricted({name:"EvmMethodsToNonEvmAccountFilterMessenger",allowedActions:["AccountsController:getSelectedAccount"]})})),s.push((0,He.createMethodMiddleware)({origin:e,subjectType:t,addSubjectMetadata:this.subjectMetadataController.addSubjectMetadata.bind(this.subjectMetadataController),metamaskState:this.getState(),getProviderState:this.getProviderState.bind(this),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),handleWatchAssetRequest:this.handleWatchAssetRequest.bind(this),requestUserApproval:this.approvalController.addAndShowApprovalRequest.bind(this.approvalController),startApprovalFlow:this.approvalController.startFlow.bind(this.approvalController),endApprovalFlow:this.approvalController.endFlow.bind(this.approvalController),sendMetrics:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getAccounts:this.getPermittedAccounts.bind(this,e),getPermissionsForOrigin:this.permissionController.getPermissions.bind(this.permissionController,e),hasPermission:this.permissionController.hasPermission.bind(this.permissionController,e),requestAccountsPermission:this.permissionController.requestPermissions.bind(this.permissionController,{origin:e},{eth_accounts:{}}),requestPermittedChainsPermission:t=>this.permissionController.requestPermissions({origin:e},{[lt.PermissionNames.permittedChains]:{caveats:[lt.CaveatFactories[le.CaveatTypes.restrictNetworkSwitching](t)]}}),requestPermissionsForOrigin:this.permissionController.requestPermissions.bind(this.permissionController,{origin:e}),revokePermissionsForOrigin:t=>{try{this.permissionController.revokePermissions({[e]:t})}catch(e){console.log(e)}},getCaveat:({target:t,caveatType:r})=>{try{return this.permissionController.getCaveat(e,t,r)}catch(e){if(!(e instanceof x.PermissionDoesNotExistError))throw e}return undefined},getChainPermissionsFeatureFlag:()=>Boolean(""),getCurrentRpcUrl:()=>this.networkController.state.providerConfig.rpcUrl,upsertNetworkConfiguration:this.networkController.upsertNetworkConfiguration.bind(this.networkController),setActiveNetwork:async t=>{await this.networkController.setActiveNetwork(t),this.permissionController.hasPermission(e,lt.PermissionNames.eth_accounts)&&this.selectedNetworkController.setNetworkClientIdForDomain(e,t)},findNetworkConfigurationBy:this.findNetworkConfigurationBy.bind(this),getCurrentChainIdForDomain:e=>{const t=this.selectedNetworkController.getNetworkClientIdForDomain(e),{chainId:r}=this.networkController.getNetworkConfigurationByNetworkClientId(t);return r},getWeb3ShimUsageState:this.alertController.getWeb3ShimUsageState.bind(this.alertController),setWeb3ShimUsageRecorded:this.alertController.setWeb3ShimUsageRecorded.bind(this.alertController)})),s.push((0,$.createSnapsMethodMiddleware)(t===x.SubjectType.Snap,{getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getPermitted",e),requestPermissions:async t=>await this.permissionController.requestPermissions({origin:e},t),getPermissions:this.permissionController.getPermissions.bind(this.permissionController,e),getSnapFile:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getFile",e),installSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:install",e),invokeSnap:this.permissionController.executeRestrictedMethod.bind(this.permissionController,e,le.RestrictedMethods.wallet_snap),getIsLocked:()=>!this.appStateController.isUnlocked(),hasPermission:this.permissionController.hasPermission.bind(this.permissionController,e),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),getAllSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getAll"),handleSnapRpcRequest:t=>this.handleSnapRequest({...t,origin:e}),getAllowedKeyringMethods:(0,Ie.keyringSnapPermissionsBuilder)(this.subjectMetadataController,e),createInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:createInterface",e),getInterfaceState:(...t)=>this.controllerMessenger.call("SnapInterfaceController:getInterface",e,...t).state,updateInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:updateInterface",e)})),s.push(a),s.push(l.middleware),s.push(this.metamaskMiddleware),s.push((0,u.providerAsMiddleware)(i.provider)),s}setupProviderEngineCaip({origin:e,tabId:t}){const r=new c.JsonRpcEngine;return r.push(((r,n,s,o)=>(console.log("CAIP request received",{origin:e,tabId:t,request:r}),o(new Error("CAIP RPC Pipeline not yet implemented."))))),r}setupPublicConfig(e){const t=(0,a.storeAsStream)(this.publicConfigStore);(0,s.pipeline)(t,e,(e=>{var r;t.destroy(),!e||null!==(r=e.message)&&void 0!==r&&r.match("Premature close")||y.default.error(e)}))}addConnection(e,{engine:t}){if(e===he.ORIGIN_METAMASK)return null;this.connections[e]||(this.connections[e]={});const r=(0,T.default)();return this.connections[e][r]={engine:t},r}removeConnection(e,t){const r=this.connections[e];r&&(delete r[t],0===Object.keys(r).length&&delete this.connections[e])}removeAllConnections(e){const t=this.connections[e];t&&Object.keys(t).forEach((t=>{this.removeConnection(e,t)}))}notifyConnections(e,t){const r=this.connections[e];r&&Object.values(r).forEach((e=>{e.engine&&e.engine.emit("notification",t)}))}notifyAllConnections(e){const t="function"==typeof e?t=>e(t):()=>e;Object.keys(this.connections).forEach((e=>{Object.values(this.connections[e]).forEach((async r=>{try{this.notifyConnection(r,await t(e))}catch(e){console.error(e)}}))}))}notifyConnection(e,t){try{e.engine&&e.engine.emit("notification",t)}catch(e){console.error(e)}}async _onKeyringControllerUpdate(e){const{keyrings:t}=e,r=t.reduce(((e,{accounts:t})=>e.concat(t)),[]).filter(Mt.isEthAddress);r.length&&this.accountTracker.syncWithAddresses(r)}_onUnlock(){this.notifyAllConnections((async e=>({method:lt.NOTIFICATION_NAMES.unlockStateChanged,params:{isUnlocked:!0,accounts:await this.getPermittedAccounts(e)}}))),this.unMarkPasswordForgotten(),this.emit("unlock")}_onLock(){this.notifyAllConnections({method:lt.NOTIFICATION_NAMES.unlockStateChanged,params:{isUnlocked:!1}}),this.emit("lock")}_onStateUpdate(e){this.isClientOpenAndUnlocked=e.isUnlocked&&this._isClientOpen,this._notifyChainChange()}privateSendUpdate(){this.emit("update",this.getState())}isUnlocked(){return this.keyringController.state.isUnlocked}getExternalPendingTransactions(e){return this.smartTransactionsController.getTransactions({addressFrom:e,status:"pending"})}async getPendingNonce(e,t){const{nonceDetails:r,releaseLock:n}=await this.txController.getNonceLock(e,undefined),s=r.params.highestSuggested;return n(),s}async getNextNonce(e,t){const r=await this.txController.getNonceLock(e,undefined);return r.releaseLock(),r.nextNonce}throwTestError(e){setTimeout((()=>{const t=new Error(e);throw t.name="TestError",t}))}_addTransactionControllerListeners(){const e=this.getTransactionMetricsRequest();this.controllerMessenger.subscribe("TransactionController:postTransactionBalanceUpdated",Me.handlePostTransactionBalanceUpdate.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:unapprovedTransactionAdded",(t=>(0,Me.handleTransactionAdded)(e,{transactionMeta:t}))),this.controllerMessenger.subscribe("TransactionController:transactionApproved",Me.handleTransactionApproved.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionDropped",Me.handleTransactionDropped.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionConfirmed",Me.handleTransactionConfirmed.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionFailed",Me.handleTransactionFailed.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionNewSwap",(({transactionMeta:e})=>this.swapsController.setTradeTxId(e.id))),this.controllerMessenger.subscribe("TransactionController:transactionNewSwapApproval",(({transactionMeta:e})=>this.swapsController.setApproveTxId(e.id))),this.controllerMessenger.subscribe("TransactionController:transactionRejected",Me.handleTransactionRejected.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionSubmitted",Me.handleTransactionSubmitted.bind(null,e)),this.controllerMessenger.subscribe("TransactionController:transactionStatusUpdated",(({transactionMeta:e})=>{this._onFinishedTransaction(e)}))}getTransactionMetricsRequest(){return{...{createEventFragment:this.metaMetricsController.createEventFragment.bind(this.metaMetricsController),finalizeEventFragment:this.metaMetricsController.finalizeEventFragment.bind(this.metaMetricsController),getEventFragmentById:this.metaMetricsController.getEventFragmentById.bind(this.metaMetricsController),getParticipateInMetrics:()=>this.metaMetricsController.state.participateInMetaMetrics,trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),updateEventFragment:this.metaMetricsController.updateEventFragment.bind(this.metaMetricsController),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getSelectedAddress:()=>this.accountsController.getSelectedAccount().address,getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),getTransaction:e=>this.txController.state.transactions.find((t=>t.id===e)),getIsSmartTransaction:()=>(0,be.getIsSmartTransaction)(this._getMetaMaskState()),getSmartTransactionByMinedTxHash:e=>this.smartTransactionsController.getSmartTransactionByMinedTxHash(e),getRedesignedConfirmationsEnabled:()=>this.preferencesController.getRedesignedConfirmationsEnabled,getIsRedesignedConfirmationsDeveloperEnabled:()=>this.preferencesController.store.getState().preferences.isRedesignedConfirmationsDeveloperEnabled},snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),provider:this.provider}}toggleExternalServices(e){this.preferencesController.toggleExternalServices(e),this.tokenListController.updatePreventPollingOnNetworkRestart(!e),e?(this.tokenDetectionController.enable(),this.gasFeeController.enableNonRPCGasFeeApis()):(this.tokenDetectionController.disable(),this.gasFeeController.disableNonRPCGasFeeApis())}findNetworkConfigurationBy(e){const{networkConfigurations:t}=this.networkController.state;return Object.values(t).find((t=>Object.keys(e).some((r=>t[r]===e[r]))))||null}async setLedgerTransportPreference(e){const t=window.navigator.hid?ae.LedgerTransportTypes.webhid:ae.LedgerTransportTypes.u2f,r=e||await this.getKeyringForDevice(ae.HardwareDeviceNames.ledger);return null!=r&&r.updateTransportMethod?r.updateTransportMethod(t).catch((e=>{throw e})):undefined}recordFirstTimeInfo(e){if(!("firstTimeInfo"in e)){const t=this.platform.getVersion();e.firstTimeInfo={version:t,date:Date.now()}}}set isClientOpen(e){this._isClientOpen=e}onClientClosed(){try{this.gasFeeController.stopAllPolling(),this.currencyRateController.stopAllPolling(),this.appStateController.clearPollingTokens()}catch(e){console.error(e)}}onEnvironmentTypeClosed(e){const t=he.POLLING_TOKEN_ENVIRONMENT_TYPES[e];this.appStateController.store.getState()[t].forEach((e=>{this.gasFeeController.stopPollingByPollingToken(e),this.currencyRateController.stopPollingByPollingToken(e),this.appStateController.removePollingToken(e,t)}))}safelistPhishingDomain(e){return this.phishingController.bypass(e)}async backToSafetyPhishingWarning(){const e=this.platform.getExtensionURL();await this.platform.switchToAnotherURL(undefined,e)}setLocked(){return this.keyringController.setLocked()}async _onAccountChange(e){const t=(0,lt.getPermittedAccountsByOrigin)(this.permissionController.state);for(const[r,n]of t.entries())n.includes(e)&&this._notifyAccountsChange(r,n);await this.txController.updateIncomingTransactions()}async _notifyAccountsChange(e,t){this.isUnlocked()&&this.notifyConnections(e,{method:lt.NOTIFICATION_NAMES.accountsChanged,params:t.length<2?t:await this.getPermittedAccounts(e)}),this.permissionLogController.updateAccountsHistory(e,t)}async _notifyChainChange(){this.preferencesController.getUseRequestQueue()?this.notifyAllConnections((async e=>({method:lt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState(e)}))):this.notifyAllConnections({method:lt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState()})}async _notifyChainChangeForConnection(e,t){this.preferencesController.getUseRequestQueue()?this.notifyConnection(e,{method:lt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState(t)}):this.notifyConnection(e,{method:lt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState()})}async _onFinishedTransaction(e){[X.TransactionStatus.confirmed,X.TransactionStatus.failed].includes(e.status)&&(await this._createTransactionNotifcation(e),await this._updateNFTOwnership(e),this._trackTransactionFailure(e))}async _createTransactionNotifcation(e){const{chainId:t}=e;let r={};if(t){const{networkConfigurations:e}=this.networkController.state,n=Object.values(e).find((e=>e.chainId===t));r=(null==n?void 0:n.rpcPrefs)??{}}try{await this.platform.showTransactionNotification(e,r)}catch(e){y.default.error("Failed to create transaction notification",e)}}async _updateNFTOwnership(e){const{type:t,txParams:r,chainId:n,txReceipt:s}=e,o=this.accountsController.getSelectedAccount().address,{allNfts:i}=this.nftController.state,a=null==s?void 0:s.logs,c=t===X.TransactionType.contractInteraction&&a,l=(t===X.TransactionType.tokenMethodTransferFrom||t===X.TransactionType.tokenMethodSafeTransferFrom)&&r!==undefined;if(c||l)if(l){var u;const{data:e,to:t,from:s}=r,o=(0,ye.parseStandardTokenTransactionData)(e),a=(0,ge.getTokenIdParam)(o)??(0,Ce.getTokenValueParam)(o),c=null==i||null===(u=i[s])||void 0===u||null===(u=u[n])||void 0===u?void 0:u.find((({address:e,tokenId:r})=>(0,fe.isEqualCaseInsensitive)(e,t)&&r===a));c&&this.nftController.checkAndUpdateSingleNftOwnershipStatus(c,!1,{userAddress:s})}else{const e=a.map((e=>{const t=e.topics&&e.topics[0]===_e.TRANSFER_SINFLE_LOG_TOPIC_HASH,r=e.topics&&e.topics[0]===_e.TOKEN_TRANSFER_LOG_TOPIC_HASH;let n;return t&&(n=e.topics&&e.topics[3]&&e.topics[3].match(null==o?void 0:o.slice(2))),r&&(n=e.topics&&e.topics[2]&&e.topics[2].match(null==o?void 0:o.slice(2))),{isERC1155NftTransfer:t,isERC721NftTransfer:r,isTransferToSelectedAddress:n,...e}}));if(0!==e.length){const t=[];e.forEach((e=>{if(e.isTransferToSelectedAddress&&(e.isERC1155NftTransfer||e.isERC721NftTransfer)){let r;r=e.isERC1155NftTransfer?new Z.Interface(ee.abiERC1155):new Z.Interface(ee.abiERC721);try{const n=r.parseLog({data:e.data,topics:e.topics});t.push({contract:e.address,...n})}catch(e){}}}));const r=[],s=[];t.forEach((e=>{var t;const a=(0,ge.getTokenIdParam)(e),c=null==i||null===(t=i[o])||void 0===t||null===(t=t[n])||void 0===t?void 0:t.find((({address:t,tokenId:r})=>(0,fe.isEqualCaseInsensitive)(t,e.contract)&&r===a));c?r.push(c):s.push({tokenId:a,...e})}));const a=r.map((async e=>this.nftController.checkAndUpdateSingleNftOwnershipStatus(e,!1,{selectedAddress:o})));await Promise.allSettled(a);const c=s.map((async e=>this.nftController.addNft(e.contract,e.tokenId)));await Promise.allSettled(c)}}}_trackTransactionFailure(e){var t;const{txReceipt:r}=e,n=this.getState();r&&"0x0"===r.status&&this.metaMetricsController.trackEvent({event:"Tx Status Update: On-Chain Failure",category:pe.MetaMetricsEventCategory.Background,properties:{action:"Transactions",errorMessage:null===(t=e.simulationFails)||void 0===t?void 0:t.reason,numberOfTokens:n.tokens.length,numberOfAccounts:Object.keys(n.accounts).length}},{matomoEvent:!0})}_onUserOperationAdded(e){const t=this.txController.state.transactions.find((t=>t.id===e.id));t&&(t.type===X.TransactionType.swap?this.controllerMessenger.publish("TransactionController:transactionNewSwap",{transactionMeta:t}):t.type===X.TransactionType.swapApproval&&this.controllerMessenger.publish("TransactionController:transactionNewSwapApproval",{transactionMeta:t}))}_onUserOperationTransactionUpdated(e){const t={...e,txParams:{...e.txParams,from:this.accountsController.getSelectedAccount().address}};this.txController.state.transactions.some((e=>e.id===t.id))||this.txController.update((e=>{e.transactions.push(t)})),this.txController.updateTransaction(t,"Generated from user operation"),this.controllerMessenger.publish("TransactionController:transactionStatusUpdated",{transactionMeta:t})}_publishSmartTransactionHook(e){const t=this._getMetaMaskState(),r=(0,be.getIsSmartTransaction)(t);if(!r)return{transactionHash:undefined};const n=(0,be.getFeatureFlagsByChainId)(t);return(0,Pe.submitSmartTransactionHook)({transactionMeta:e,transactionController:this.txController,smartTransactionsController:this.smartTransactionsController,controllerMessenger:this.controllerMessenger,isSmartTransaction:r,featureFlags:n})}_getMetaMaskState(){return{metamask:this.getState()}}}async function Lt(e,t){var r;const{currentLocale:n}=e,{chainId:s}=this.networkController.state.providerConfig;await(0,ht.updateCurrentLocale)(n),null!==(r=e.incomingTransactionsPreferences)&&void 0!==r&&r[s]?this.txController.startIncomingTransactionPolling():this.txController.stopIncomingTransactionPolling(),Ot(this,Ut,Ht).call(this,e,t),this.controllerMessenger.publish("PreferencesController:stateChange",e,[])}function Ht(e,t){const r=Ot(this,Ft,$t).call(this,t),n=Ot(this,Ft,$t).call(this,e);r!==n&&(this.tokenListController.updatePreventPollingOnNetworkRestart(!n),n?(y.default.debug("Started token list controller polling"),this.tokenListController.start()):(y.default.debug("Stopped token list controller polling"),this.tokenListController.clearingTokenListData(),this.tokenListController.stop()))}function $t(e){const{useTokenDetection:t,useTransactionSimulations:r,preferences:n}=e??{},{petnamesEnabled:s}=n??{};return t||s||r}r.default=Dt}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/metamask-controller.js"}],[1360,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-bridge.js"}],[1361,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,o,i,a,c,l=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.LedgerIframeBridge=r.IFrameMessageAction=void 0;var u;!function(e){e.LedgerConnectionChange="ledger-connection-change",e.LedgerUnlock="ledger-unlock",e.LedgerMakeApp="ledger-make-app",e.LedgerUpdateTransport="ledger-update-transport",e.LedgerSignTransaction="ledger-sign-transaction",e.LedgerSignPersonalMessage="ledger-sign-personal-message",e.LedgerSignTypedData="ledger-sign-typed-data"}(u=r.IFrameMessageAction||(r.IFrameMessageAction={}));r.LedgerIframeBridge=class{constructor(){n.add(this),this.iframeLoaded=!1,this.isDeviceConnected=!1,this.currentMessageId=0,this.messageCallbacks={}}async init(e){l(this,n,"m",o).call(this,e),this.eventListener=l(this,n,"m",a).bind(this,e),window.addEventListener("message",this.eventListener)}async destroy(){this.eventListener&&window.removeEventListener("message",this.eventListener)}async attemptMakeApp(){return new Promise(((e,t)=>{l(this,n,"m",c).call(this,{action:u.LedgerMakeApp},(r=>{r.success?e(!0):t(r.error)}))}))}async updateTransportMethod(e){return new Promise(((t,r)=>{this.iframeLoaded?l(this,n,"m",c).call(this,{action:u.LedgerUpdateTransport,params:{transportType:e}},(({success:e})=>e?t(!0):r(new Error("Ledger transport could not be updated")))):this.delayedPromise={resolve:t,reject:r,transportType:e}}))}async getPublicKey(e){return l(this,n,"m",s).call(this,u.LedgerUnlock,e)}async deviceSignTransaction(e){return l(this,n,"m",s).call(this,u.LedgerSignTransaction,e)}async deviceSignMessage(e){return l(this,n,"m",s).call(this,u.LedgerSignPersonalMessage,e)}async deviceSignTypedData(e){return l(this,n,"m",s).call(this,u.LedgerSignTypedData,e)}},n=new WeakSet,s=async function(...[e,t]){return new Promise(((r,s)=>{l(this,n,"m",c).call(this,{action:e,params:t},(({success:e,payload:t})=>e?r(t):s(t.error)))}))},o=function(e){this.iframe=document.createElement("iframe"),this.iframe.src=e,this.iframe.allow="hid 'src'",this.iframe.onload=async()=>{if(this.iframeLoaded=!0,this.delayedPromise)try{const e=await this.updateTransportMethod(this.delayedPromise.transportType);this.delayedPromise.resolve(e)}catch(e){this.delayedPromise.reject(e)}finally{delete this.delayedPromise}},document.head.appendChild(this.iframe)},i=function(e){const t=e.split("/");return t.splice(-1,1),t.join("/")},a=function(e,t){if(t.origin===l(this,n,"m",i).call(this,e)&&t.data){const e=this.messageCallbacks[t.data.messageId];e?e(t.data):t.data.action===u.LedgerConnectionChange&&(this.isDeviceConnected=t.data.payload.connected)}},c=function(e,t){this.currentMessageId+=1;const r=Object.assign(Object.assign({},e),{messageId:this.currentMessageId,target:"LEDGER-IFRAME"});if(this.messageCallbacks[this.currentMessageId]=t,!this.iframeLoaded||!this.iframe||!this.iframe.contentWindow)throw new Error("The iframe is not loaded yet");this.iframe.contentWindow.postMessage(r,"*")}}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-iframe-bridge.js"}],[1362,{"@ethereumjs/rlp":444,"@ethereumjs/tx":449,"@ethereumjs/util":461,"@metamask/eth-sig-util":1365,buffer:3520,events:3814,hdkey:4112},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,o,i,a,c,l,u,d,h,p,m,g,f=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),y=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),w=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return y(t,e),t},C=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},k=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.LedgerKeyring=void 0;const v=e("@ethereumjs/rlp"),b=e("@ethereumjs/tx"),S=w(e("@ethereumjs/util")),T=e("@metamask/eth-sig-util"),_=e("buffer"),E=e("events"),A=k(e("hdkey")),M="m",P=`${M}/44'/60'/0'`,I="Ledger Hardware",R="https://metamask.github.io/eth-ledger-bridge-keyring";var N;!function(e){e.Ropsten="http://api-ropsten.etherscan.io",e.Kovan="http://api-kovan.etherscan.io",e.Rinkeby="https://api-rinkeby.etherscan.io",e.Mainnet="https://api.etherscan.io"}(N||(N={}));class j extends E.EventEmitter{constructor({bridge:e}){if(super(),n.add(this),this.type=I,this.page=0,this.perPage=5,this.unlockedAccount=0,this.accounts=[],this.accountDetails={},this.hdk=new A.default,this.hdPath=P,this.paths={},this.network=N.Mainnet,this.implementFullBIP44=!1,this.bridgeUrl=R,!e)throw new Error("Bridge is a required dependency for the keyring");this.bridge=e}async init(){return this.bridge.init(this.bridgeUrl)}async destroy(){return this.bridge.destroy()}async serialize(){return{hdPath:this.hdPath,accounts:this.accounts,accountDetails:this.accountDetails,bridgeUrl:this.bridgeUrl,implementFullBIP44:!1}}async deserialize(e={}){var t,r,o,i,a;return this.hdPath=null!==(t=e.hdPath)&&void 0!==t?t:P,this.bridgeUrl=null!==(r=e.bridgeUrl)&&void 0!==r?r:R,this.accounts=null!==(o=e.accounts)&&void 0!==o?o:[],this.accountDetails=null!==(i=e.accountDetails)&&void 0!==i?i:{},e.accountDetails||C(this,n,"m",s).call(this,e),this.implementFullBIP44=null!==(a=e.implementFullBIP44)&&void 0!==a&&a,this.accounts=this.accounts.filter((e=>Object.keys(this.accountDetails).includes(S.toChecksumAddress(e)))),Promise.resolve()}isUnlocked(){var e;return Boolean(null===(e=this.hdk)||void 0===e?void 0:e.publicKey)}isConnected(){return this.bridge.isDeviceConnected}setAccountToUnlock(e){this.unlockedAccount="number"==typeof e?e:parseInt(e,10)}setHdPath(e){this.hdPath!==e&&(this.hdk=new A.default),this.hdPath=e}async unlock(e,t=!0){if(this.isUnlocked()&&!e)return"already unlocked";const r=e?C(this,n,"m",p).call(this,e):this.hdPath;let s;try{s=await this.bridge.getPublicKey({hdPath:r})}catch(e){throw e instanceof Error?e:new Error("Unlock your Ledger device and open the ETH app")}return t&&s.chainCode&&(this.hdk.publicKey=_.Buffer.from(s.publicKey,"hex"),this.hdk.chainCode=_.Buffer.from(s.chainCode,"hex")),s.address}async addAccounts(e=1){return new Promise(((t,r)=>{this.unlock().then((async r=>{const s=this.unlockedAccount,o=s+e;for(let e=s;e<o;e++){const t=C(this,n,"m",d).call(this,e);let r;r=C(this,n,"m",h).call(this)?await this.unlock(t):C(this,n,"m",l).call(this,M,e),this.accountDetails[S.toChecksumAddress(r)]={bip44:C(this,n,"m",h).call(this),hdPath:t},this.accounts.includes(r)||(this.accounts=[...this.accounts,r]),this.page=0}t(this.accounts.slice())})).catch(r)}))}async getFirstPage(){return this.page=0,C(this,n,"m",i).call(this,1)}async getNextPage(){return C(this,n,"m",i).call(this,1)}async getPreviousPage(){return C(this,n,"m",i).call(this,-1)}async getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase())),delete this.accountDetails[S.toChecksumAddress(e)]}async attemptMakeApp(){return this.bridge.attemptMakeApp()}async updateTransportMethod(e){return this.bridge.updateTransportMethod(e)}async signTransaction(e,t){let r;if(function(e){return"getChainId"in e&&"function"==typeof e.getChainId}(t))return t.v=S.bufferToHex(t.getChainId()),t.r="0x00",t.s="0x00",r=t.serialize().toString("hex"),C(this,n,"m",o).call(this,e,r,(e=>(t.v=_.Buffer.from(e.v,"hex"),t.r=_.Buffer.from(e.r,"hex"),t.s=_.Buffer.from(e.s,"hex"),t)));const s=t.getMessageToSign(!1);return r=_.Buffer.isBuffer(s)?s.toString("hex"):_.Buffer.from(v.RLP.encode(s)).toString("hex"),C(this,n,"m",o).call(this,e,r,(e=>{const r=t.toJSON();return r.type=t.type,r.v=S.addHexPrefix(e.v),r.r=S.addHexPrefix(e.r),r.s=S.addHexPrefix(e.s),b.TransactionFactory.fromTxData(r,{common:t.common,freeze:Object.isFrozen(t)})}))}async signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,t){const r=await this.unlockAccountByAddress(e);if(!r)throw new Error("Ledger: Unknown error while signing message");let n;try{n=await this.bridge.deviceSignMessage({hdPath:r,message:S.stripHexPrefix(t)})}catch(e){throw e instanceof Error?e:new Error("Ledger: Unknown error while signing message")}let s=parseInt(String(n.v),10).toString(16);s.length<2&&(s=`0${s}`);const o=`0x${n.r}${n.s}${s}`,i=(0,T.recoverPersonalSignature)({data:t,signature:o});if(S.toChecksumAddress(i)!==S.toChecksumAddress(e))throw new Error("Ledger: The signature doesnt match the right address");return o}async unlockAccountByAddress(e){const t=S.toChecksumAddress(e),r=this.accountDetails[t];if(!r)throw new Error(`Ledger: Account for address '${t}' not found`);const{hdPath:n}=r;if((await this.unlock(n,!1)).toLowerCase()!==e.toLowerCase())throw new Error(`Ledger: Account ${e} does not belong to the connected device`);return n}async signTypedData(e,t,r={}){if(!("V4"===r.version))throw new Error("Ledger: Only version 4 of typed data signing is supported");const{domain:n,types:s,primaryType:o,message:i}=T.TypedDataUtils.sanitizeData(t),a=T.TypedDataUtils.hashStruct("EIP712Domain",n,s,T.SignTypedDataVersion.V4).toString("hex"),c=T.TypedDataUtils.hashStruct(o.toString(),i,s,T.SignTypedDataVersion.V4).toString("hex"),l=await this.unlockAccountByAddress(e);if(!l)throw new Error("Ledger: Unknown error while signing message");let u;try{u=await this.bridge.deviceSignTypedData({hdPath:l,domainSeparatorHex:a,hashStructMessageHex:c})}catch(e){throw e instanceof Error?e:new Error("Ledger: Unknown error while signing message")}let d=parseInt(String(u.v),10).toString(16);d.length<2&&(d=`0${d}`);const h=`0x${u.r}${u.s}${d}`,p=(0,T.recoverTypedSignature)({data:t,signature:h,version:T.SignTypedDataVersion.V4});if(S.toChecksumAddress(p)!==S.toChecksumAddress(e))throw new Error("Ledger: The signature doesnt match the right address");return h}exportAccount(){throw new Error("Not supported on this device")}forgetDevice(){this.accounts=[],this.page=0,this.unlockedAccount=0,this.paths={},this.accountDetails={},this.hdk=new A.default}}r.LedgerKeyring=j,n=new WeakSet,s=function(e){if(C(this,n,"m",h).call(this)&&e.accountIndexes)for(const[t,r]of Object.entries(e.accountIndexes))this.accountDetails[t]={bip44:!0,hdPath:C(this,n,"m",d).call(this,r)};C(this,n,"m",h).call(this)||this.accounts.filter((e=>!Object.keys(this.accountDetails).includes(S.toChecksumAddress(e)))).forEach((e=>{try{this.accountDetails[S.toChecksumAddress(e)]={bip44:!1,hdPath:C(this,n,"m",u).call(this,e)}}catch(t){console.log(`failed to migrate account ${e}`)}}))},o=async function(e,t,r){const n=await this.unlockAccountByAddress(e);if(!n)throw new Error("Ledger: Unknown error while signing transaction");let s;try{s=await this.bridge.deviceSignTransaction({tx:t,hdPath:n})}catch(e){throw e instanceof Error?e:new Error("Ledger: Unknown error while signing transaction")}const o=r(s);if(o.verifySignature())return o;throw new Error("Ledger: The transaction signature is not valid")},i=async function(e){this.page+=e,this.page<=0&&(this.page=1);const t=(this.page-1)*this.perPage,r=t+this.perPage;let s;return await this.unlock(),s=C(this,n,"m",h).call(this)?await C(this,n,"m",a).call(this,t,r):C(this,n,"m",c).call(this,t,r),s},a=async function(e,t){const r=[];for(let s=e;s<t;s++){const e=C(this,n,"m",d).call(this,s),t=await this.unlock(e),o=!this.implementFullBIP44||await C(this,n,"m",m).call(this,t);if(r.push({address:t,balance:null,index:s}),!o)break}return r},c=function(e,t){const r=[];for(let s=e;s<t;s++){const e=C(this,n,"m",l).call(this,M,s);r.push({address:e,balance:null,index:s}),this.paths[S.toChecksumAddress(e)]=s}return r},l=function(e,t){const r=this.hdk.derive(`${e}/${t}`),n=S.publicToAddress(r.publicKey,!0).toString("hex");return S.toChecksumAddress(`0x${n}`)},u=function(e){const t=S.toChecksumAddress(e);let r=this.paths[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===C(this,n,"m",l).call(this,M,e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return C(this,n,"m",d).call(this,r)},d=function(e){return C(this,n,"m",h).call(this)?`m/44'/60'/${e}'/0/0`:`${this.hdPath}/${e}`},h=function(){return"m/44'/60'/0'/0/0"===this.hdPath},p=function(e){return e.toString().replace("m/","")},m=async function(e){const t=C(this,n,"m",g).call(this),r=await window.fetch(`${t}/api?module=account&action=txlist&address=${e}&tag=latest&page=1&offset=1`),s=await r.json();return"0"!==s.status&&s.result.length>0},g=function(){return this.network},j.type=I}}},{package:"@metamask/eth-ledger-bridge-keyring",file:"node_modules/@metamask/eth-ledger-bridge-keyring/dist/ledger-keyring.js"}],[137,{lodash:4322},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:2,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=2;try{"etherscan"===t.data.config.provider.type&&(t.data.config.provider.type="rpc",t.data.config.provider.rpcTarget="https://rpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/002.js"}],[138,{lodash:4322},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:3,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=3;try{"https://rawtestrpc.metamask.io/"===t.data.config.provider.rpcTarget&&(t.data.config.provider.rpcTarget="https://testrpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/003.js"}],[139,{lodash:4322},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:4,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=4;try{if("rpc"!==t.data.config.provider.type)return Promise.resolve(t);switch(t.data.config.provider.rpcTarget){case"https://testrpc.metamask.io/":t.data.config.provider={type:"testnet"};break;case"https://rpc.metamask.io/":t.data.config.provider={type:"mainnet"}}}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/004.js"}],[1392,{"./util":1400},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CaseInsensitiveMap=void 0;const n=e("./util");class s extends Map{static fromObject(e){return new s(Object.entries(e))}toObject(){return Object.fromEntries(this.entries())}get(e){return super.get(e.toLowerCase())}getOrThrow(e,t="Key"){return this.get(e)??(0,n.throwError)(`${t} '${e}' not found`)}has(e){return super.has(e.toLowerCase())}set(e,t){return super.set(e.toLowerCase(),t)}delete(e){return super.delete(e.toLowerCase())}}r.CaseInsensitiveMap=s}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/CaseInsensitiveMap.js"}],[1393,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.DeferredPromise=void 0;r.DeferredPromise=class{constructor(){if(this.resolve=undefined,this.reject=undefined,this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),!this.resolve||!this.reject)throw new Error("Promise constructor failed")}}}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/DeferredPromise.js"}],[1394,{"@metamask/keyring-api":1566},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,o,i,a,c=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},l=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.KeyringSnapControllerClient=void 0;const u=e("@metamask/keyring-api");class d{constructor(e,t,r,a){n.set(this,void 0),s.set(this,void 0),o.set(this,void 0),i.set(this,void 0),c(this,o,e,"f"),c(this,n,t,"f"),c(this,s,r,"f"),c(this,i,a,"f")}async send(e){return l(this,o,"f").handleRequest({snapId:l(this,n,"f"),origin:l(this,s,"f"),handler:l(this,i,"f"),request:e})}}n=new WeakMap,s=new WeakMap,o=new WeakMap,i=new WeakMap;class h extends u.KeyringClient{constructor({controller:e,snapId:t="undefined",origin:r="metamask",handler:n="onKeyringRequest"}){super(new d(e,t,r,n)),a.set(this,void 0),c(this,a,e,"f")}withSnapId(e){return new h({controller:l(this,a,"f"),snapId:e})}getController(){return l(this,a,"f")}}r.KeyringSnapControllerClient=h,a=new WeakMap}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/KeyringSnapControllerClient.js"}],[1395,{"./CaseInsensitiveMap":1392},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},o=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.SnapIdMap=r.InvalidSnapIdError=void 0;const i=e("./CaseInsensitiveMap");class a extends Error{constructor(e,t){super(`Snap "${e}" is not allowed to set "${t}"`),this.name="InvalidSnapIdError",this.snapId=e,this.key=t}}r.InvalidSnapIdError=a;class c{constructor(e){n.set(this,void 0),s(this,n,new i.CaseInsensitiveMap(e),"f")}toObject(){return o(this,n,"f").toObject()}static fromObject(e){return new c(Object.entries(e))}get(e,t){const r=o(this,n,"f").get(t);return r?.snapId===e?r:undefined}has(e,t){return this.get(e,t)!==undefined}delete(e,t){return this.has(e,t)&&o(this,n,"f").delete(t)}set(e,t){if(o(this,n,"f").has(e)&&!this.has(t.snapId,e))throw new a(t.snapId,e);return o(this,n,"f").set(e,t),this}values(){return o(this,n,"f").values()}get size(){return o(this,n,"f").size}}r.SnapIdMap=c,n=new WeakMap}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/SnapIdMap.js"}],[1396,{"./DeferredPromise":1393,"./KeyringSnapControllerClient":1394,"./SnapIdMap":1395,"./logger":1398,"./types":1399,"./util":1400,"@ethereumjs/tx":449,"@metamask/eth-sig-util":1365,"@metamask/keyring-api":1566,"@metamask/utils":2739,events:3814,superstruct:4828,uuid:1401},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,o,i,a,c,l,u,d,h,p,m,g,f,y,w,C,k,v,b,S=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},T=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.SnapKeyring=r.SNAP_KEYRING_TYPE=void 0;const _=e("@ethereumjs/tx"),E=e("@metamask/eth-sig-util"),A=e("@metamask/keyring-api"),M=e("@metamask/utils"),P=e("events"),I=e("superstruct"),R=e("uuid"),N=e("./DeferredPromise"),j=e("./KeyringSnapControllerClient"),x=e("./logger"),O=e("./SnapIdMap"),B=e("./types"),U=e("./util");r.SNAP_KEYRING_TYPE="Snap Keyring";class F extends P.EventEmitter{constructor(e,t){super(),n.add(this),s.set(this,void 0),o.set(this,void 0),i.set(this,void 0),a.set(this,void 0),this.type=F.type,S(this,s,new j.KeyringSnapControllerClient({controller:e}),"f"),S(this,i,new O.SnapIdMap,"f"),S(this,o,new O.SnapIdMap,"f"),S(this,a,t,"f")}async handleKeyringSnapMessage(e,t){switch((0,I.assert)(t,B.SnapMessageStruct),t.method){case A.KeyringEvent.AccountCreated:return T(this,n,"m",c).call(this,e,t);case A.KeyringEvent.AccountUpdated:return T(this,n,"m",l).call(this,e,t);case A.KeyringEvent.AccountDeleted:return T(this,n,"m",u).call(this,e,t);case A.KeyringEvent.RequestApproved:return T(this,n,"m",d).call(this,e,t);case A.KeyringEvent.RequestRejected:return T(this,n,"m",h).call(this,e,t);default:throw new Error(`Method not supported: ${t.method}`)}}async serialize(){return{accounts:T(this,o,"f").toObject()}}async deserialize(e){e!==undefined&&S(this,o,O.SnapIdMap.fromObject(e.accounts),"f")}async getAccounts(){return(0,U.unique)([...T(this,o,"f").values()].map((({account:e})=>e.address.toLowerCase())))}async getAccountsBySnapId(e){return(0,U.unique)([...T(this,o,"f").values()].filter((({snapId:t})=>t===e)).map((({account:e})=>e.address.toLowerCase())))}async signTransaction(e,t,r={}){const s=t.common.chainId(),o=(0,U.toJson)({...t.toJSON(),from:e,type:`0x${t.type.toString(16)}`,chainId:(0,M.bigIntToHex)(s)}),i=await T(this,n,"m",p).call(this,{address:e,method:A.EthMethod.SignTransaction,params:[o],chainId:(0,M.toCaipChainId)(M.KnownCaipNamespace.Eip155,`${s}`)}),a=(0,I.mask)(i,(0,I.object)({r:(0,I.string)(),s:(0,I.string)(),v:(0,I.string)()}));return _.TransactionFactory.fromTxData({...o,r:a.r,s:a.s,v:a.v})}async signTypedData(e,t,r={version:E.SignTypedDataVersion.V1}){const s={[E.SignTypedDataVersion.V1]:A.EthMethod.SignTypedDataV1,[E.SignTypedDataVersion.V3]:A.EthMethod.SignTypedDataV3,[E.SignTypedDataVersion.V4]:A.EthMethod.SignTypedDataV4}[r.version]||A.EthMethod.SignTypedDataV1,o=t.domain?.chainId;return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:s,params:(0,U.toJson)([e,t]),...o===undefined?{}:{chainId:(0,M.toCaipChainId)(M.KnownCaipNamespace.Eip155,`${o}`)}}),A.EthBytesStruct)}async signMessage(e,t){return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:A.EthMethod.Sign,params:(0,U.toJson)([e,t])}),A.EthBytesStruct)}async signPersonalMessage(e,t){return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:A.EthMethod.PersonalSign,params:(0,U.toJson)([t,e])}),A.EthBytesStruct)}async prepareUserOperation(e,t,r){return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:A.EthMethod.PrepareUserOperation,params:(0,U.toJson)(t),expectSync:!0,chainId:(0,M.toCaipChainId)(M.KnownCaipNamespace.Eip155,r.chainId)}),A.EthBaseUserOperationStruct)}async patchUserOperation(e,t,r){return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:A.EthMethod.PatchUserOperation,params:(0,U.toJson)([t]),expectSync:!0,chainId:(0,M.toCaipChainId)(M.KnownCaipNamespace.Eip155,r.chainId)}),A.EthUserOperationPatchStruct)}async signUserOperation(e,t,r){return(0,U.strictMask)(await T(this,n,"m",p).call(this,{address:e,method:A.EthMethod.SignUserOperation,params:(0,U.toJson)([t]),chainId:(0,M.toCaipChainId)(M.KnownCaipNamespace.Eip155,r.chainId)}),A.EthBytesStruct)}exportAccount(e){throw new Error("Exporting accounts from snaps is not supported.")}async removeAccount(e){const{account:t,snapId:r}=T(this,n,"m",k).call(this,e);T(this,o,"f").delete(r,t.id);try{await T(this,s,"f").withSnapId(r).deleteAccount(t.id)}catch(t){console.error(`Account '${e}' may not have been removed from snap '${r}':`,t)}}getAccountByAddress(e){return this.listAccounts().find((({address:t})=>(0,U.equalsIgnoreCase)(t,e)))}listAccounts(){return[...T(this,o,"f").values()].map((({account:e,snapId:t})=>{const r=T(this,n,"m",v).call(this,t);return{...e,address:e.address.toLowerCase(),metadata:{name:"",importTime:0,keyring:{type:this.type},...r!==undefined&&{snap:r}}}}))}}r.SnapKeyring=F,s=new WeakMap,o=new WeakMap,i=new WeakMap,a=new WeakMap,n=new WeakSet,c=async function(e,t){(0,I.assert)(t,A.AccountCreatedEventStruct);const{account:r,accountNameSuggestion:n,displayConfirmation:s}=t.params;if(await T(this,a,"f").addressExists(r.address.toLowerCase()))throw new Error(`Account address '${r.address}' already exists`);if(T(this,o,"f").has(e,r.id))throw new Error(`Account '${r.id}' already exists`);return await T(this,a,"f").addAccount(r.address.toLowerCase(),e,(async t=>{t&&(T(this,o,"f").set(r.id,{account:r,snapId:e}),await T(this,a,"f").saveState())}),n,s),null},l=async function(e,t){(0,I.assert)(t,A.AccountUpdatedEventStruct);const{account:r}=t.params,{account:n}=T(this,o,"f").get(e,r.id)??(0,U.throwError)(`Account '${r.id}' not found`);if(!(0,U.equalsIgnoreCase)(n.address,r.address))throw new Error(`Cannot change address of account '${r.id}'`);return T(this,o,"f").set(r.id,{account:r,snapId:e}),await T(this,a,"f").saveState(),null},u=async function(e,t){(0,I.assert)(t,A.AccountDeletedEventStruct);const{id:r}=t.params,n=T(this,o,"f").get(e,r);if(n===undefined)return null;const{account:{address:s}}=n;return await T(this,a,"f").removeAccount(s.toLowerCase(),e,(async e=>{e&&await T(this,a,"f").saveState()})),null},d=async function(e,t){(0,I.assert)(t,A.RequestApprovedEventStruct);const{id:r,result:n}=t.params,{promise:s}=T(this,i,"f").get(e,r)??(0,U.throwError)(`Request '${r}' not found`);return T(this,i,"f").delete(e,r),s.resolve(n),null},h=async function(e,t){(0,I.assert)(t,A.RequestRejectedEventStruct);const{id:r}=t.params,{promise:n}=T(this,i,"f").get(e,r)??(0,U.throwError)(`Request '${r}' not found`);return T(this,i,"f").delete(e,r),n.reject(new Error("Request rejected by user or snap.")),null},p=async function({address:e,method:t,params:r,chainId:s="",expectSync:o=!1}){const{account:i,snapId:a}=T(this,n,"m",k).call(this,e);if(!T(this,n,"m",m).call(this,i,t))throw new Error(`Method '${t}' not supported for account ${i.address}`);const c=(0,R.v4)(),l=T(this,n,"m",g).call(this,c,a),u=await T(this,n,"m",f).call(this,{snapId:a,requestId:c,account:i,method:t,params:r,chainId:s});if(o&&u.pending)throw new Error(`Request '${c}' to snap '${a}' is pending and expectSync is true.`);return u.pending?((u.redirect?.message||u.redirect?.url)&&await T(this,n,"m",w).call(this,u.redirect,a),l.promise):T(this,n,"m",y).call(this,u,c,a)},m=function(e,t){return e.methods.includes(t)},g=function(e,t){const r=new N.DeferredPromise;return T(this,i,"f").set(e,{promise:r,snapId:t}),r},f=async function({snapId:e,requestId:t,account:r,method:n,params:o,chainId:a}){try{const i={id:t,scope:a,account:r.id,request:{method:n,...o!==undefined&&{params:o}}};return(0,x.projectLogger)("Submit Snap request: ",i),await T(this,s,"f").withSnapId(e).submitRequest(i)}catch(r){throw(0,x.projectLogger)("Snap Request failed: ",{requestId:t}),T(this,i,"f").delete(e,t),r}},y=function(e,t,r){return T(this,i,"f").delete(r,t),e.result},w=async function(e,t){const{message:r="",url:s=""}=e;s&&T(this,n,"m",C).call(this,s,t),await T(this,a,"f").redirectUser(t,s,r)},C=function(e,t){const{origin:r}=new URL(e),o=T(this,s,"f").getController().get(t);if(!o)throw new Error(`Snap '${t}' not found.`);if(!T(this,n,"m",b).call(this,o).includes(r))throw new Error(`Redirect URL domain '${r}' is not an allowed origin by snap '${t}'`)},k=function(e){return[...T(this,o,"f").values()].find((({account:t})=>(0,U.equalsIgnoreCase)(t.address,e)))??(0,U.throwError)(`Account '${e}' not found`)},v=function(e){const t=T(this,s,"f").getController().get(e);return t?{id:e,name:t.manifest.proposedName,enabled:t.enabled}:undefined},b=function(e){return e.manifest.initialPermissions["endowment:keyring"]?.allowedOrigins??[]},F.type=r.SNAP_KEYRING_TYPE}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/SnapKeyring.js"}],[1397,{"./KeyringSnapControllerClient":1394,"./SnapKeyring":1396,"./types":1399},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./types"),r),s(e("./SnapKeyring"),r),s(e("./KeyringSnapControllerClient"),r)}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/index.js"}],[1398,{"@metamask/utils":2739},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.projectLogger=void 0;const n=e("@metamask/utils");Object.defineProperty(r,"createModuleLogger",{enumerable:!0,get:function(){return n.createModuleLogger}}),r.projectLogger=(0,n.createProjectLogger)("eth-snap-keyring")}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/logger.js"}],[1399,{"@metamask/utils":2739,superstruct:4828},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SnapMessageStruct=void 0;const n=e("@metamask/utils"),s=e("superstruct");r.SnapMessageStruct=(0,s.object)({method:(0,s.string)(),params:(0,s.optional)((0,s.union)([(0,s.array)(n.JsonStruct),(0,s.record)((0,s.string)(),n.JsonStruct)]))})}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/types.js"}],[14,{"@metamask/obs-store":1782},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BridgeFeatureFlagsKey=void 0;var n=e("@metamask/obs-store");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o={bridgeState:{bridgeFeatureFlags:{[(r.BridgeFeatureFlagsKey=function(e){return e.EXTENSION_SUPPORT="extensionSupport",e}({})).EXTENSION_SUPPORT]:!1}}};r.default=class{constructor(){s(this,"store",new n.ObservableStore(o)),s(this,"resetState",(()=>{this.store.updateState({bridgeState:{...o.bridgeState}})})),s(this,"setBridgeFeatureFlags",(e=>{const{bridgeState:t}=this.store.getState();this.store.updateState({bridgeState:{...t,bridgeFeatureFlags:e}})}))}}}}},{package:"$root$",file:"app/scripts/controllers/bridge.ts"}],[140,{lodash:4322},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:5,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=5;try{const e=function(e){const{config:t}=e,r={...e,KeyringController:{vault:e.vault,selectedAccount:t.selectedAccount,walletNicknames:e.walletNicknames}};return delete r.vault,delete r.walletNicknames,delete r.config.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #5${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/005.js"}],[1400,{superstruct:4828},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.equalsIgnoreCase=r.throwError=r.ensureDefined=r.toJson=r.unique=r.strictMask=void 0;const n=e("superstruct");r.strictMask=function(e,t,r){return(0,n.assert)(e,t,r),e},r.unique=function(e){return[...new Set(e)]},r.toJson=function(e){return JSON.parse(JSON.stringify(e))},r.ensureDefined=function(e){if(e===undefined)throw new Error("Argument is undefined")},r.throwError=function(e){throw new Error(e)},r.equalsIgnoreCase=function(e,t){return e.toLowerCase()===t.toLowerCase()}}}},{package:"@metamask/eth-snap-keyring",file:"node_modules/@metamask/eth-snap-keyring/dist/util.js"}],[1401,{"./nil.js":1404,"./parse.js":1405,"./stringify.js":1409,"./v1.js":1410,"./v3.js":1411,"./v4.js":1413,"./v5.js":1414,"./validate.js":1415,"./version.js":1416},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return c.default}});var n=h(e("./v1.js")),s=h(e("./v3.js")),o=h(e("./v4.js")),i=h(e("./v5.js")),a=h(e("./nil.js")),c=h(e("./version.js")),l=h(e("./validate.js")),u=h(e("./stringify.js")),d=h(e("./parse.js"));function h(e){return e&&e.__esModule?e:{default:e}}}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/index.js"}],[1402,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){return 14+(e+64>>>9<<4)+1}function s(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function o(e,t,r,n,o,i){return s((a=s(s(t,e),s(n,i)))<<(c=o)|a>>>32-c,r);var a,c}function i(e,t,r,n,s,i,a){return o(t&r|~t&n,e,t,s,i,a)}function a(e,t,r,n,s,i,a){return o(t&n|r&~n,e,t,s,i,a)}function c(e,t,r,n,s,i,a){return o(t^r^n,e,t,s,i,a)}function l(e,t,r,n,s,i,a){return o(r^(t|~n),e,t,s,i,a)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length,n="0123456789abcdef";for(let s=0;s<r;s+=8){const r=e[s>>5]>>>s%32&255,o=parseInt(n.charAt(r>>>4&15)+n.charAt(15&r),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let r=1732584193,o=-271733879,u=-1732584194,d=271733878;for(let t=0;t<e.length;t+=16){const n=r,h=o,p=u,m=d;r=i(r,o,u,d,e[t],7,-680876936),d=i(d,r,o,u,e[t+1],12,-389564586),u=i(u,d,r,o,e[t+2],17,606105819),o=i(o,u,d,r,e[t+3],22,-1044525330),r=i(r,o,u,d,e[t+4],7,-176418897),d=i(d,r,o,u,e[t+5],12,1200080426),u=i(u,d,r,o,e[t+6],17,-1473231341),o=i(o,u,d,r,e[t+7],22,-45705983),r=i(r,o,u,d,e[t+8],7,1770035416),d=i(d,r,o,u,e[t+9],12,-1958414417),u=i(u,d,r,o,e[t+10],17,-42063),o=i(o,u,d,r,e[t+11],22,-1990404162),r=i(r,o,u,d,e[t+12],7,1804603682),d=i(d,r,o,u,e[t+13],12,-40341101),u=i(u,d,r,o,e[t+14],17,-1502002290),o=i(o,u,d,r,e[t+15],22,1236535329),r=a(r,o,u,d,e[t+1],5,-165796510),d=a(d,r,o,u,e[t+6],9,-1069501632),u=a(u,d,r,o,e[t+11],14,643717713),o=a(o,u,d,r,e[t],20,-373897302),r=a(r,o,u,d,e[t+5],5,-701558691),d=a(d,r,o,u,e[t+10],9,38016083),u=a(u,d,r,o,e[t+15],14,-660478335),o=a(o,u,d,r,e[t+4],20,-405537848),r=a(r,o,u,d,e[t+9],5,568446438),d=a(d,r,o,u,e[t+14],9,-1019803690),u=a(u,d,r,o,e[t+3],14,-187363961),o=a(o,u,d,r,e[t+8],20,1163531501),r=a(r,o,u,d,e[t+13],5,-1444681467),d=a(d,r,o,u,e[t+2],9,-51403784),u=a(u,d,r,o,e[t+7],14,1735328473),o=a(o,u,d,r,e[t+12],20,-1926607734),r=c(r,o,u,d,e[t+5],4,-378558),d=c(d,r,o,u,e[t+8],11,-2022574463),u=c(u,d,r,o,e[t+11],16,1839030562),o=c(o,u,d,r,e[t+14],23,-35309556),r=c(r,o,u,d,e[t+1],4,-1530992060),d=c(d,r,o,u,e[t+4],11,1272893353),u=c(u,d,r,o,e[t+7],16,-155497632),o=c(o,u,d,r,e[t+10],23,-1094730640),r=c(r,o,u,d,e[t+13],4,681279174),d=c(d,r,o,u,e[t],11,-358537222),u=c(u,d,r,o,e[t+3],16,-722521979),o=c(o,u,d,r,e[t+6],23,76029189),r=c(r,o,u,d,e[t+9],4,-640364487),d=c(d,r,o,u,e[t+12],11,-421815835),u=c(u,d,r,o,e[t+15],16,530742520),o=c(o,u,d,r,e[t+2],23,-995338651),r=l(r,o,u,d,e[t],6,-198630844),d=l(d,r,o,u,e[t+7],10,1126891415),u=l(u,d,r,o,e[t+14],15,-1416354905),o=l(o,u,d,r,e[t+5],21,-57434055),r=l(r,o,u,d,e[t+12],6,1700485571),d=l(d,r,o,u,e[t+3],10,-1894986606),u=l(u,d,r,o,e[t+10],15,-1051523),o=l(o,u,d,r,e[t+1],21,-2054922799),r=l(r,o,u,d,e[t+8],6,1873313359),d=l(d,r,o,u,e[t+15],10,-30611744),u=l(u,d,r,o,e[t+6],15,-1560198380),o=l(o,u,d,r,e[t+13],21,1309151649),r=l(r,o,u,d,e[t+4],6,-145523070),d=l(d,r,o,u,e[t+11],10,-1120210379),u=l(u,d,r,o,e[t+2],15,718787259),o=l(o,u,d,r,e[t+9],21,-343485551),r=s(r,n),o=s(o,h),u=s(u,p),d=s(d,m)}return[r,o,u,d]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(n(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};r.default=u}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/md5-browser.js"}],[1403,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};r.default=n}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/native-browser.js"}],[1404,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default="00000000-0000-0000-0000-000000000000"}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/nil.js"}],[1405,{"./validate.js":1415},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var o=function(e){if(!(0,s.default)(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};r.default=o}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/parse.js"}],[1406,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/regex.js"}],[1407,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){let n;Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(s)};const s=new Uint8Array(16)}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/rng-browser.js"}],[1408,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function s(e,t){return e<<t|e>>>32-t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const o=e.length/4+2,i=Math.ceil(o/16),a=new Array(i);for(let t=0;t<i;++t){const r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];a[t]=r}a[i-1][14]=8*(e.length-1)/Math.pow(2,32),a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<i;++e){const o=new Uint32Array(80);for(let t=0;t<16;++t)o[t]=a[e][t];for(let e=16;e<80;++e)o[e]=s(o[e-3]^o[e-8]^o[e-14]^o[e-16],1);let i=r[0],c=r[1],l=r[2],u=r[3],d=r[4];for(let e=0;e<80;++e){const r=Math.floor(e/20),a=s(i,5)+n(r,c,l,u)+d+t[r]+o[e]>>>0;d=u,u=l,l=s(c,30)>>>0,c=i,i=a}r[0]=r[0]+i>>>0,r[1]=r[1]+c>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+d>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};r.default=o}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/sha1-browser.js"}],[1409,{"./validate.js":1415},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.unsafeStringify=i;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};const o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));function i(e,t=0){return o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]}var a=function(e,t=0){const r=i(e,t);if(!(0,s.default)(r))throw TypeError("Stringified UUID is invalid");return r};r.default=a}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/stringify.js"}],[141,{lodash:4322},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:6,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=6;try{const e=function(e){const t=e.KeyringController,r={...e,PreferencesController:{selectedAddress:t.selectedAccount}};return delete r.KeyringController.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #6${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/006.js"}],[1410,{"./rng.js":1407,"./stringify.js":1409},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./rng.js"))&&n.__esModule?n:{default:n},o=e("./stringify.js");let i,a,c=0,l=0;var u=function(e,t,r){let n=t&&r||0;const u=t||new Array(16);let d=(e=e||{}).node||i,h=e.clockseq!==undefined?e.clockseq:a;if(null==d||null==h){const t=e.random||(e.rng||s.default)();null==d&&(d=i=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==h&&(h=a=16383&(t[6]<<8|t[7]))}let p=e.msecs!==undefined?e.msecs:Date.now(),m=e.nsecs!==undefined?e.nsecs:l+1;const g=p-c+(m-l)/1e4;if(g<0&&e.clockseq===undefined&&(h=h+1&16383),(g<0||p>c)&&e.nsecs===undefined&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=p,l=m,a=h,p+=122192928e5;const f=(1e4*(268435455&p)+m)%4294967296;u[n++]=f>>>24&255,u[n++]=f>>>16&255,u[n++]=f>>>8&255,u[n++]=255&f;const y=p/4294967296*1e4&268435455;u[n++]=y>>>8&255,u[n++]=255&y,u[n++]=y>>>24&15|16,u[n++]=y>>>16&255,u[n++]=h>>>8|128,u[n++]=255&h;for(let e=0;e<6;++e)u[n+e]=d[e];return t||(0,o.unsafeStringify)(u)};r.default=u}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v1.js"}],[1411,{"./md5.js":1402,"./v35.js":1412},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./v35.js")),s=o(e("./md5.js"));function o(e){return e&&e.__esModule?e:{default:e}}var i=(0,n.default)("v3",48,s.default);r.default=i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v3.js"}],[1412,{"./parse.js":1405,"./stringify.js":1409},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.URL=r.DNS=void 0,r.default=function(e,t,r){function n(e,n,i,a){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=(0,o.default)(n)),16!==(null===(c=n)||void 0===c?void 0:c.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+e.length);if(l.set(n),l.set(e,n.length),l=r(l),l[6]=15&l[6]|t,l[8]=63&l[8]|128,i){a=a||0;for(let e=0;e<16;++e)i[a+e]=l[e];return i}return(0,s.unsafeStringify)(l)}try{n.name=e}catch(e){}return n.DNS=i,n.URL=a,n};var n,s=e("./stringify.js"),o=(n=e("./parse.js"))&&n.__esModule?n:{default:n};const i="6ba7b810-9dad-11d1-80b4-00c04fd430c8";r.DNS=i;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";r.URL=a}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v35.js"}],[1413,{"./native.js":1403,"./rng.js":1407,"./stringify.js":1409},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./native.js")),s=i(e("./rng.js")),o=e("./stringify.js");function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e,t,r){if(n.default.randomUUID&&!t&&!e)return n.default.randomUUID();const i=(e=e||{}).random||(e.rng||s.default)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=i[e];return t}return(0,o.unsafeStringify)(i)};r.default=a}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v4.js"}],[1414,{"./sha1.js":1408,"./v35.js":1412},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./v35.js")),s=o(e("./sha1.js"));function o(e){return e&&e.__esModule?e:{default:e}}var i=(0,n.default)("v5",80,s.default);r.default=i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v5.js"}],[1415,{"./regex.js":1406},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./regex.js"))&&n.__esModule?n:{default:n};var o=function(e){return"string"==typeof e&&s.default.test(e)};r.default=o}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/validate.js"}],[1416,{"./validate.js":1415},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var o=function(e){if(!(0,s.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)};r.default=o}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/version.js"}],[142,{lodash:4322},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:7,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=7;try{const e=function(e){const t={...e,TransactionManager:{transactions:e.transactions||[],gasMultiplier:e.gasMultiplier||1}};return delete t.transactions,delete t.gasMultiplier,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #7${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/007.js"}],[1421,{"./trezor-bridge":1422,"./trezor-connect-bridge":1423,"./trezor-keyring":1424},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./trezor-keyring"),r),s(e("./trezor-bridge"),r),s(e("./trezor-connect-bridge"),r)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/index.js"}],[1422,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-bridge.js"}],[1423,{"@trezor/connect-web":3024},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.TrezorConnectBridge=void 0;const i=o(e("@trezor/connect-web"));r.TrezorConnectBridge=class{constructor(){this.trezorConnectInitiated=!1}async init(e){i.default.on(i.DEVICE_EVENT,(e=>{var t;e.type===i.DEVICE.CONNECT&&(this.model=null===(t=e.payload.features)||void 0===t?void 0:t.model)})),this.trezorConnectInitiated||(await i.default.init(e),this.trezorConnectInitiated=!0)}dispose(){return i.default.dispose(),Promise.resolve()}getPublicKey(e){return i.default.getPublicKey(e)}ethereumSignTransaction(e){return i.default.ethereumSignTransaction(e)}ethereumSignMessage(e){return i.default.ethereumSignMessage(e)}ethereumSignTypedData(e){return i.default.ethereumSignTypedData(e)}}}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-connect-bridge.js"}]],[],{});